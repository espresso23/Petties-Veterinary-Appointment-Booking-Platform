# PETTIES V0.0.1 - FEATURES & HAPPY FLOWS

---

## ðŸŽ¯ 5 ROLES & CORE FEATURES

### ðŸ• **ROLE 1: PET_OWNER (Customer Ä‘á»“ng thá»i lÃ  chá»§ thÃº cÆ°ng) MOBILE ONLY**
1. ÄÄƒng kÃ½ / ÄÄƒng nháº­p âœ…
2. Quáº£n lÃ½ há»“ sÆ¡ cÃ¡ nhÃ¢n âœ…
3. Táº¡o/sá»­a há»“ sÆ¡ thÃº cÆ°ng âœ…
4. TÃ¬m kiáº¿m phÃ²ng khÃ¡m âœ…
5. TÃ¬m kiáº¿m nhÃ¢n viÃªn
6. Äáº·t lá»‹ch khÃ¡m táº¡i phÃ²ng (Clinic Visit) âœ…
7. Äáº·t lá»‹ch khÃ¡m táº¡i nhÃ  (Home Visit) âœ…
8. Xem lá»‹ch booking cá»§a tÃ´i âœ…
9. Xem chi tiáº¿t booking âœ…
10. Há»§y booking ðŸ”„ (BE done)
11. Thanh toÃ¡n online. ðŸ”„ (In Progress)
12. Xem há»“ sÆ¡ y táº¿ thÃº cÆ°ng (EMR) âœ…
13. Xem sá»• tiÃªm chá»§ng âœ…
14. ÄÃ¡nh giÃ¡ & review nhÃ¢n viÃªn
15. Chat vá»›i AI Chatbot (Pet Care Assistant) âœ…
16. SOS - Cáº¥p cá»©u kháº©n cáº¥p
17. **AI Vision: PhÃ¢n tÃ­ch hÃ¬nh áº£nh sá»©c khá»e thÃº cÆ°ng** âœ…
18. **Há»§y yÃªu cáº§u thay Ä‘á»•i Email** âœ…
19. Video Consultation (TÆ° váº¥n video tá»« xa)
20. Xem Ä‘Æ¡n thuá»‘c trong há»“ sÆ¡ bá»‡nh Ã¡n (EMR) âœ…
21. Nháº­n thÃ´ng bÃ¡o & nháº¯c nhá»Ÿ (Push/Email/SMS) âœ…
22. LÆ°u áº£nh, giá»‘ng, Ä‘á»™ tuá»•i, Ä‘áº·c Ä‘iá»ƒm thÃº cÆ°ng âœ…
23. **[SOS] Xem báº£n Ä‘á»“ realtime vá»‹ trÃ­ nhÃ¢n viÃªn**
24. **[SOS] Tracking Ä‘Æ°á»ng di chuyá»ƒn cá»§a nhÃ¢n viÃªn** (Ä‘á»‹nh tuyáº¿n cá»©u há»™)
25. **[SOS] Nháº­n thÃ´ng bÃ¡o khi nhÃ¢n viÃªn sáº¯p Ä‘áº¿n / Ä‘Ã£ Ä‘áº¿n nÆ¡i**

---

### ðŸ‘¨â€âš•ï¸ **ROLE 2: STAFF (NhÃ¢n viÃªn - nhÃ¢n viÃªn thÃº y, groomer) MOBILE + WEB**
1. ÄÄƒng nháº­p tá»« account Ä‘Æ°á»£c cáº¥p âœ…
2. Xem há»“ sÆ¡ cá»§a tÃ´i âœ…
3. Xem lá»‹ch lÃ m viá»‡c cá»§a tÃ´i âœ…
4. Xem booking Ä‘Æ°á»£c gÃ¡n âœ…
5. Check-in bá»‡nh nhÃ¢n âœ…
6. **HoÃ n thÃ nh khÃ¡m (Treatment Finished)**: NhÃ¢n viÃªn xÃ¡c nháº­n Ä‘Ã£ khÃ¡m xong, gá»­i yÃªu cáº§u thanh toÃ¡n tá»›i Manager. âœ…
7. Xem há»“ sÆ¡ y táº¿ thÃº cÆ°ng âœ…
8. Xem sá»• tiÃªm chá»§ng cá»§a pet âœ…
9. **Tra cá»©u bá»‡nh nhÃ¢n cÅ©** (Patient Lookup): TÃ¬m kiáº¿m vÃ  xem há»“ sÆ¡ bá»‡nh nhÃ¢n cÅ© cá»§a phÃ²ng khÃ¡m âœ…
10. Ghi chÃº há»“ sÆ¡ bá»‡nh Ã¡n (táº¡o EMR) - **[Báº¯t buá»™c gáº¯n vá»›i Booking]** âœ…
11. Cáº­p nháº­t sá»• tiÃªm chá»§ng - **[Báº¯t buá»™c gáº¯n vá»›i Booking]** âœ…
12. **[SOS] Báº¯t Ä‘áº§u di chuyá»ƒn cá»©u há»™ (Start Emergency Travel)**
13. **[SOS] Tá»± Ä‘á»™ng cáº­p nháº­t vá»‹ trÃ­ GPS realtime** Ä‘á»ƒ ngÆ°á»i dÃ¹ng theo dÃµi
14. **[SOS] ThÃ´ng bÃ¡o Ä‘áº¿n nÆ¡i** â†’ ÄÃ¡nh dáº¥u Ä‘Ã£ tiáº¿p cáº­n ca cáº¥p cá»©u
15. **Dashboard Tá»•ng quan lá»‹ch háº¹n (Summary Dashboard)** âœ…

---

### ðŸ‘¨â€ðŸ’¼ **ROLE 3: CLINIC_MANAGER (Quáº£n lÃ½ phÃ²ng khÃ¡m) WEB-ONLY**
1. ÄÄƒng nháº­p âœ…
2. Xem danh sÃ¡ch nhÃ¢n viÃªn âœ…
3. ThÃªm nhÃ¢n viÃªn thá»§ cÃ´ng âœ…
4. XÃ³a/bá» liÃªn káº¿t nhÃ¢n viÃªn âœ…
5. Import lá»‹ch nhÃ¢n viÃªn thá»§ cÃ´ng âœ…
6. Xem booking má»›i âœ…
7. GÃ¡n nhÃ¢n viÃªn cho booking âœ…
8. GÃ¡n láº¡i booking (náº¿u nhÃ¢n viÃªn tá»« chá»‘i) âœ…
9. GÃ¡n dá»‹ch vá»¥ náº¿u user chÆ°a chá»n Ä‘Æ°á»£c
10. **Nháº­n tiá»n & Checkout (Payment & Completion)**: Nháº­n thanh toÃ¡n tá»« khÃ¡ch vÃ  thá»±c hiá»‡n thao tÃ¡c Checkout Ä‘á»ƒ Ä‘Ã³ng Ä‘Æ¡n hÃ ng.
11. Quáº£n lÃ½ há»§y & hoÃ n tiá»n
12. Xem dashboard hÃ´m nay âœ…
13. Quáº£n lÃ½ ca lÃ m viá»‡c nhÃ¢n viÃªn âœ…
14. **Quáº£n lÃ½ Há»“ sÆ¡ Bá»‡nh nhÃ¢n (Patient Management)**: âœ…
    - Xem danh sÃ¡ch bá»‡nh nhÃ¢n tá»«ng khÃ¡m táº¡i phÃ²ng khÃ¡m
    - Xem chi tiáº¿t Lá»‹ch sá»­ EMR vÃ  Sá»• tiÃªm chá»§ng cá»§a bá»‡nh nhÃ¢n (Read-Only)
15. **Block/Unblock Slot thá»§ cÃ´ng (Manual Slot Control)** âœ…
16. **XÃ³a ca trá»±c hÃ ng loáº¡t (Bulk Shift Delete)** âœ…
17. **Kiá»ƒm tra tÃ­nh kháº£ dá»¥ng cá»§a nhÃ¢n viÃªn (Check Staff Availability)** âœ…
18. **GÃ¡n láº¡i nhÃ¢n viÃªn cho dá»‹ch vá»¥ (Reassign Staff)** âœ…

---

### ðŸ¥ **ROLE 4: CLINIC_OWNER (Chá»§ phÃ²ng khÃ¡m) WEB-ONLY**
1. ÄÄƒng nháº­p âœ…
2. Quáº£n lÃ½ thÃ´ng tin phÃ²ng khÃ¡m âœ…
3. **Quáº£n lÃ½ Danh má»¥c Dá»‹ch vá»¥ (Master Services):** âœ…
    - Táº¡o danh má»¥c dá»‹ch vá»¥ tiÃªu chuáº©n (TÃªn, Category, MÃ´ táº£, Icon, GiÃ¡ máº·c Ä‘á»‹nh).
    - Cáº¥u hÃ¬nh giÃ¡ sáºµn Ä‘á»ƒ gÃ¡n nhanh cho cÃ¡c phÃ²ng khÃ¡m.
4. **Quáº£n lÃ½ Dá»‹ch vá»¥ táº¡i PhÃ²ng khÃ¡m (Clinic Services):** âœ…
    - **Thá»«a hÆ°á»Ÿng (Inherit):** Ãp dá»¥ng tá»« Master Services vá»›i giÃ¡ Ä‘Ã£ cáº¥u hÃ¬nh sáºµn (cÃ³ thá»ƒ ghi Ä‘Ã¨/override giÃ¡ riÃªng náº¿u muá»‘n).
    - **Tá»± táº¡o (Custom):** Táº¡o cÃ¡c dá»‹ch vá»¥ riÃªng biá»‡t chá»‰ cÃ³ táº¡i phÃ²ng khÃ¡m Ä‘Ã³.
    - Cáº¥u hÃ¬nh giÃ¡ chi tiáº¿t (Base price, Price per KM) vÃ  tráº¡ng thÃ¡i (Active/Inactive) cho tá»«ng dá»‹ch vá»¥ cá»¥ thá»ƒ.
5. Xem Dashboard PhÃ²ng KhÃ¡m âœ…
6. Theo dÃµi doanh thu âœ…


---

### ðŸ‘¨â€ðŸ’» **ROLE 5: ADMIN (Admin ná»n táº£ng) WEB ONLY**

#### **Platform Management (Quáº£n lÃ½ Ná»n táº£ng)**
1. ÄÄƒng nháº­p âœ…
2. Xem danh sÃ¡ch cÃ¡c clinic pending chá» duyá»‡t âœ…
3. PhÃª duyá»‡t clinic âœ…
4. Tá»« chá»‘i clinic 
5. Xem thá»‘ng kÃª ná»n táº£ng, doanh thu âœ…
6. Thá»‘ng kÃª ngÆ°á»i dÃ¹ng vÃ  giao dá»‹ch âœ…

#### **AI Agent Configuration (Single Agent + ReAct)**
7. **Agent Configuration**
    - Báº­t/táº¯t Agent (Enable/Disable)
    - Chá»‰nh sá»­a System Prompt (vá»›i version control)
    - Äiá»u chá»‰nh Model Hyperparameters (Temperature, Max Tokens, Top-P)
    - Chá»n LLM Model (gemini-2.0-flash, llama-3.3-70b, claude-3.5-sonnet)

8. **Tool Management (@mcp.tool)**
    - Xem danh sÃ¡ch Tools Ä‘Æ°á»£c code sáºµn
    - Báº­t/táº¯t tá»«ng Tool riÃªng láº»
    - Xem Request/Response Schema cho má»—i tool

9. **Knowledge Base Management (RAG)**
    - Upload tÃ i liá»‡u (PDF, DOCX, TXT, MD)
    - Theo dÃµi tráº¡ng thÃ¡i indexing (chunking & vectorization)
    - Test RAG retrieval vá»›i query examples
    - Xem vector count vÃ  storage usage

10. **Agent Testing & Debugging**
    - Interactive Chat Simulator Ä‘á»ƒ test agent
    - Xem ReAct Flow (Thought â†’ Action â†’ Observation)
    - Xem Tool Calls vÃ  Results
    - Citation View (RAG sources)
    - Feedback system (Good/Bad responses)


14. **System & Security Configuration**
    - Dynamic API Key Management (OpenRouter, Cohere, Qdrant, Tavily)
    - LLM Provider Configuration (OpenRouter Cloud API)
    - Model Selection (gemini-2.0-flash, llama-3.3-70b, claude-3.5-sonnet)
    - Embedding Provider (Cohere embed-multilingual-v3)
    - Test connections cho cÃ¡c Cloud services
    - Save & Reload Context (khÃ´ng cáº§n restart server)

---

## ðŸ¤– AI & AGENT FEATURES (Petties AI Layer)

> **Architecture:** Single Agent + ReAct Pattern + MCP Tools
> 
> **Note:** MVP sá»­ dá»¥ng **Single Agent** (khÃ´ng pháº£i Multi-Agent) vá»›i nhiá»u skills/tools, cÃ³ thá»ƒ config bá»Ÿi Admin.

### AI Chatbot - Pet Care Assistant
- ðŸ¤– Chat vá»›i AI Chatbot thÃ´ng minh âœ…
- ðŸ¤– TÆ° váº¥n chÄƒm sÃ³c thÃº cÆ°ng âœ…
- ðŸ¤– Há»— trá»£ tÃ¬m kiáº¿m triá»‡u chá»©ng (Symptom Search) âœ…
- ðŸ¤– **AI Vision Analysis - PhÃ¢n tÃ­ch hÃ¬nh áº£nh sá»©c khá»e thÃº cÆ°ng** âœ…
- ðŸ¤– RAG Engine - Tra cá»©u kiáº¿n thá»©c y táº¿ thÃº y (LlamaIndex + Qdrant) âœ…
- ðŸ¤– Booking via Chat - Äáº·t lá»‹ch qua há»™i thoáº¡i âœ…
- ðŸ¤– Citation & Attribution - TrÃ­ch dáº«n nguá»“n
- ðŸ¤– Web Search - TÃ¬m kiáº¿m realtime ðŸ”„
- ðŸ¤– EMR Integration - Xem bá»‡nh Ã¡n Ä‘iá»‡n tá»­ âœ… (FE/BE)
- ðŸ¤– SOS Tracking - Theo dÃµi vá»‹ trÃ­ cá»©u há»™ âœ… (FE/BE)
- ðŸ¤– Dynamic Pricing âœ… (BE)
- ðŸ¤– Manual Scheduling âœ… (FE/BE)
- ðŸ¤– Admin AI Config Board âœ… (FE/BE)
- ðŸ¤– Knowledge Base Management âœ… (FE/BE)
- ðŸ¤– Tool Registry âœ… (FE/BE)
- ðŸ¤– Agent Playground âœ… (FE/BE)

### Single Agent Architecture (ReAct Pattern)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PETTIES AI AGENT (ReAct)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ðŸ§  LLM Core (OpenRouter / Cohere)                                  â”‚
â”‚  â”œâ”€â”€ ReAct Pattern: Thought â†’ Action â†’ Observation â†’ Loop          â”‚
â”‚  â”œâ”€â”€ Chain-of-Thought Reasoning                                     â”‚
â”‚  â””â”€â”€ System Prompt (Admin Configurable)                             â”‚
â”‚                                                                     â”‚
â”‚  ðŸ”§ Skills/Tools (FastMCP @mcp.tool)                                â”‚
â”‚  â”œâ”€â”€ @mcp.tool: pet_care_qa       â†’ RAG-based Q&A                  â”‚
â”‚  â”œâ”€â”€ @mcp.tool: symptom_search    â†’ Symptom â†’ Disease lookup       â”‚
â”‚  â”œâ”€â”€ @mcp.tool: analyze_pet_image â†’ PhÃ¢n tÃ­ch hÃ¬nh áº£nh (Vision)     â”‚
â”‚  â”œâ”€â”€ @mcp.tool: search_clinics    â†’ Find nearby clinics            â”‚
â”‚  â”œâ”€â”€ @mcp.tool: check_slots       â†’ Check available slots          â”‚
â”‚  â””â”€â”€ @mcp.tool: create_booking    â†’ Create booking via chat        â”‚
â”‚                                                                     â”‚
â”‚  ðŸ“š RAG Engine (LlamaIndex + Qdrant)                                â”‚
â”‚  â”œâ”€â”€ LlamaIndex: Document processing, chunking, retrieval          â”‚
â”‚  â”œâ”€â”€ Qdrant Cloud: Vector storage vá»›i Binary Quantization          â”‚
â”‚  â””â”€â”€ Cohere Embeddings (embed-multilingual-v3)                      â”‚
â”‚                                                                     â”‚
â”‚  âš™ï¸ Admin Config                                                    â”‚
â”‚  â”œâ”€â”€ Enable/Disable Agent                                           â”‚
â”‚  â”œâ”€â”€ System Prompt (editable)                                       â”‚
â”‚  â”œâ”€â”€ Parameters: Temperature, Max Tokens, Top-P                     â”‚
â”‚  â”œâ”€â”€ Tool Management: Enable/Disable individual tools              â”‚
â”‚  â””â”€â”€ Knowledge Base: Upload/Remove documents                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ReAct Pattern (Reason + Act)

- ðŸ§  **Thought**: Agent suy luáº­n vá» cÃ¢u há»i/yÃªu cáº§u cá»§a user
- ðŸ”§ **Action**: Gá»i tool phÃ¹ há»£p (RAG search, symptom lookup, booking, etc.)
- ðŸ‘ï¸ **Observation**: Nháº­n káº¿t quáº£ tá»« tool
- ðŸ”„ **Loop**: Láº·p láº¡i cho Ä‘áº¿n khi cÃ³ Ä‘á»§ thÃ´ng tin Ä‘á»ƒ tráº£ lá»i
- âœ… **Answer**: Tá»•ng há»£p vÃ  tráº£ lá»i user

### AI Tools (FastMCP Protocol)
- ðŸ”§ `pet_care_qa` - Há»i Ä‘Ã¡p vá» chÄƒm sÃ³c thÃº cÆ°ng (RAG-based)
- ðŸ”§ `symptom_search` - TÃ¬m bá»‡nh dá»±a trÃªn triá»‡u chá»©ng
- ðŸ”§ `analyze_pet_image` - PhÃ¢n tÃ­ch hÃ¬nh áº£nh sá»©c khá»e pet (Vision)
- ðŸ”§ `search_clinics` - TÃ¬m phÃ²ng khÃ¡m gáº§n Ä‘Ã¢y
- ðŸ”§ `check_slots` - Kiá»ƒm tra slot trá»‘ng
- ðŸ”§ `create_booking` - Táº¡o lá»‹ch háº¹n qua chat

### Admin Agent Configuration (Simple UI)
- âš™ï¸ **Agent Status** - Báº­t/Táº¯t Agent
- ðŸ“ **System Prompt** - Chá»‰nh sá»­a prompt hÆ°á»›ng dáº«n Agent
- ðŸŽ›ï¸ **Model Parameters** - Temperature, Max Tokens, Top-P, Model selection
- ðŸ”§ **Tool Management** - Báº­t/Táº¯t tá»«ng tool riÃªng láº»
- ðŸ“š **Knowledge Base** - Upload/Remove documents cho RAG

### RAG Engine (LlamaIndex + Qdrant)
- ðŸ“„ **Document Ingestion** - Upload PDF, DOCX, TXT, MD
- âœ‚ï¸ **Chunking** - Tá»± Ä‘á»™ng chia nhá» documents
- ðŸ”¢ **Embedding** - Cohere embed-multilingual-v3
- ðŸ” **Vector Search** - Qdrant Cloud vá»›i Binary Quantization
- ðŸ“– **Retrieval** - Top-K similarity search

---

## ðŸ“± ADVANCED FEATURES

### ðŸš¨ SOS - Cáº¥p Cá»©u Kháº©n Cáº¥p
- XÃ¡c Ä‘á»‹nh phÃ²ng khÃ¡m thÃº y (Clinic) kháº©n cáº¥p gáº§n nháº¥t
- LiÃªn há»‡ tá»©c thÃ¬ cho tÆ° váº¥n
- Äáº·t lá»‹ch kháº©n cáº¥p

### ðŸ“¹ Video Consultation (TÆ° Váº¥n Video)
- Gá»i video trá»±c tiáº¿p vá»›i nhÃ¢n viÃªn
- Cháº©n Ä‘oÃ¡n tá»« xa

### Electronic Medical Records (EMR)
- Há»‡ thá»‘ng Há»“ sÆ¡ Bá»‡nh Ã¡n Äiá»‡n tá»­
- LÆ°u trá»¯ táº­p trung lá»‹ch sá»­ bá»‡nh táº­t
- **ÄÆ¡n thuá»‘c (Prescription)** Ä‘Æ°á»£c ghi trá»±c tiáº¿p vÃ o EMR
- Shared EMR - Táº¥t cáº£ phÃ²ng khÃ¡m xem Ä‘Æ°á»£c lá»‹ch sá»­ y táº¿
- Truy cáº­p báº¥t ká»³ lÃºc nÃ o, báº¥t ká»³ nÆ¡i Ä‘Ã¢u

> **ðŸ“Œ Scope:** Petties lÃ  **ná»n táº£ng booking**, KHÃ”NG bao gá»“m quáº£n lÃ½ kho thuá»‘c hay quáº£n lÃ½ nhÃ¢n sá»± chuyÃªn sÃ¢u.

### ðŸ’‰ Vaccination Tracker (Sá»• TiÃªm Chá»§ng)
- Lá»‹ch sá»­ tiÃªm chá»§ng Ä‘áº§y Ä‘á»§
- Shared across clinics - Chia sáº» giá»¯a cÃ¡c phÃ²ng khÃ¡m
- Nháº¯c nhá»Ÿ lá»‹ch tiÃªm Ä‘á»‹nh ká»³

- **Real-time Desktop (SSE):** ThÃ´ng bÃ¡o tá»©c thá»i khi cÃ³ lá»‹ch má»›i, duyá»‡t clinic, hoáº·c cáº­p nháº­t ca lÃ m viá»‡c. âœ…
- **Sidebar Badge Counter:** Tá»± Ä‘á»™ng Ä‘áº¿m sá»‘ thÃ´ng bÃ¡o chá» xá»­ lÃ½/chÆ°a Ä‘á»c. âœ…
- Push notification (Mobile/Firebase)

### ðŸ’° Dynamic Pricing (Äá»‹nh GiÃ¡ Äá»™ng)
- Base price + fees
- TÃ­nh giÃ¡ dá»±a trÃªn khoáº£ng cÃ¡ch (Home Visit)
- PhÃ­ dá»‹ch vá»¥ linh hoáº¡t

### ðŸŒ Multi-language Support
- Há»— trá»£ Ä‘a ngÃ´n ngá»¯
- Timezone support - MÃºi giá»

### ðŸ‘¨â€âš•ï¸ Staff/Manager Account Creation Flow (Quick Add) âœ… (Updated - Use Google OAuth)
**MÃ´ táº£:** Quy trÃ¬nh Ä‘á»ƒ CLINIC_OWNER/MANAGER thÃªm nhanh nhÃ¢n sá»± vÃ o há»‡ thá»‘ng thÃ´ng qua Email. NhÃ¢n viÃªn sáº½ Ä‘Äƒng nháº­p báº±ng tÃ i khoáº£n Google, thÃ´ng tin cÃ¡ nhÃ¢n sáº½ tá»± Ä‘á»™ng Ä‘á»“ng bá»™.

#### Screen Flows:
1. Owner/Manager truy cáº­p mÃ n hÃ¬nh "Quáº£n lÃ½ nhÃ¢n sá»±" (Staff Management).
2. Chá»n "ThÃªm nhÃ¢n viÃªn" (Quick Add).
3. Nháº­p cÃ¡c thÃ´ng tin tá»‘i giáº£n:
    - Email (Báº¯t buá»™c, dÃ¹ng Ä‘á»ƒ liÃªn káº¿t tÃ i khoáº£n Google)
    - Vai trÃ² (Clinic Manager hoáº·c Staff)
    - ChuyÃªn mÃ´n (Chá»‰ Ã¡p dá»¥ng cho Staff)
4. Há»‡ thá»‘ng:
    - Kiá»ƒm tra Email Ä‘Ã£ thuá»™c phÃ²ng khÃ¡m khÃ¡c chÆ°a.
    - Táº¡o báº£n ghi nhÃ¢n sá»± táº¡m thá»i gáº¯n vá»›i Email.
5. NhÃ¢n viÃªn sá»­ dá»¥ng tÃ i khoáº£n Google tÆ°Æ¡ng á»©ng vá»›i Email Ä‘Ã£ má»i Ä‘á»ƒ Ä‘Äƒng nháº­p.
6. Há»‡ thá»‘ng:
    - Tá»± Ä‘á»™ng láº¥y `fullName` vÃ  `avatar` tá»« Google profile trong láº§n Ä‘Äƒng nháº­p Ä‘áº§u tiÃªn.
    - HoÃ n táº¥t kÃ­ch hoáº¡t tÃ i khoáº£n nhÃ¢n sá»±.

#### Form thÃªm nhanh (Quick Add Form):
| Field | Required | Description |
|-------|----------|-------------|
| Email | âœ… | Email dÃ¹ng Ä‘á»ƒ Ä‘Äƒng nháº­p Google OAuth |
| Vai trÃ² | âœ… | Chá»n Clinic Manager hoáº·c Staff |
| ChuyÃªn mÃ´n | ðŸ”„ | Ãp dá»¥ng cho Staff Ä‘á»ƒ gÃ¡n booking phÃ¹ há»£p |

#### Account States:
| Status | MÃ´ táº£ | ÄÄƒng nháº­p? |
|--------|-------|------------|
| `ACTIVE` | Hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng | âœ… |
| `DEACTIVATED` | Nghá»‰ viá»‡c / Bá»‹ vÃ´ hiá»‡u hÃ³a | âŒ |

**LÆ°u Ã½:** Tá»« phiÃªn báº£n má»›i, Role `STAFF` Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»•i thÃ nh `STAFF` Ä‘á»ƒ bao quÃ¡t cáº£ nhÃ¢n viÃªn thÃº y (VET_GENERAL, VET_SURGERY, etc.) vÃ  nhÃ¢n viÃªn grooming (GROOMER). ChuyÃªn mÃ´n Ä‘Æ°á»£c phÃ¢n biá»‡t qua trÆ°á»ng `StaffSpecialty`.

---

### ðŸ‘¨â€ðŸ’¼ Quáº£n lÃ½ Lá»‹ch lÃ m viá»‡c (Manual Scheduling Flow)
**MÃ´ táº£:** Quy trÃ¬nh CLINIC_MANAGER táº¡o lá»‹ch lÃ m viá»‡c cho nhÃ¢n viÃªn vÃ  há»‡ thá»‘ng tá»± Ä‘á»™ng sinh Slot.

#### Quy trÃ¬nh chi tiáº¿t:
1. **Manager chá»n NhÃ¢n viÃªn & NgÃ y**: Chá»n nhÃ¢n viÃªn tá»« danh sÃ¡ch vÃ  chá»n ngÃ y trÃªn Calendar.
2. **Nháº­p thá»i gian**:
    - Giá» báº¯t Ä‘áº§u (Start Time): vÃ­ dá»¥ 08:00
    - Giá» káº¿t thÃºc (End Time): vÃ­ dá»¥ 17:00
    - Thá»i gian nghá»‰ (Break Start/End): vÃ­ dá»¥ 12:00 - 13:00 (Há»‡ thá»‘ng sáº½ khÃ´ng táº¡o Slot trong lÃºc nÃ y).
3. **Há»‡ thá»‘ng xá»­ lÃ½ (Background)**:
    - Kiá»ƒm tra Overlap: NhÃ¢n viÃªn Ä‘Ã£ cÃ³ lá»‹ch táº¡i chi nhÃ¡nh nÃ y hoáº·c chi nhÃ¡nh khÃ¡c chÆ°a.
    - Chia nhá» thá»i gian thÃ nh cÃ¡c Slot 30 phÃºt.
    - LÆ°u vÃ o DB: 1 báº£n ghi `VetShift` vÃ  danh sÃ¡ch cÃ¡c `Slot`.
4. **Káº¿t quáº£**: Lá»‹ch vÃ  cÃ¡c Ã´ trá»‘ng hiá»‡n lÃªn Dashboard Ä‘á»ƒ Pet Owner Ä‘áº·t lá»‹ch.


## ðŸ”‘ KEY FEATURES SUMMARY (MVP 1-Month Scope)

### âœ… CORE FEATURES (In Scope)
âœ… **Clinic-based vets** (NO freelancers)  
âœ… **Shared EMR** (All clinics see medical history)  
âœ… **Shared vaccination records** (Across clinics)  
âœ… **Dynamic pricing** (Base + Weight-based + Distance fees)  
âœ… **Hybrid Service Model** (Master Services + Custom Services)  
âœ… **Slot management** (Auto reduce/restore)  
âœ… **Manual scheduling** (Manager táº¡o lá»‹ch thá»§ cÃ´ng)  
âœ… **Multiple appointment types** (IN_CLINIC, HOME_VISIT)  
âœ… **Quy trÃ¬nh Booking (Booking workflow)**: (PENDING â†’ CONFIRMED â†’ ASSIGNED â†’ ON_THE_WAY â†’ ARRIVED â†’ CHECK_IN â†’ IN_PROGRESS â†’ **PAID** â†’ **CHECK_OUT / COMPLETED**)
  
âœ… **Rating system** (Pet owner Ä‘Ã¡nh giÃ¡ Clinic/Staff)  
âœ… **SOS Geo-Tracking** (GPS realtime tracking cho cáº¥p cá»©u)
âœ… **AI Chatbot** (Single Agent + ReAct Pattern + MCP Tools)  
âœ… **EMR vá»›i Ä‘Æ¡n thuá»‘c** (Prescription trong há»“ sÆ¡ bá»‡nh Ã¡n)  
âœ… **Push Notifications** (Firebase)  
âœ… **Admin Agent Config** (Prompt, Parameters, Tools, Knowledge Base)  
âœ… **Knowledge Base RAG** (LlamaIndex + Qdrant Cloud)  

### âŒ DEFERRED (Phase 2)
âŒ ~~Home Visit Geo-Routing~~ (ÄÆ¡n giáº£n hÃ³a cho MVP, chá»‰ dÃ¹ng cho SOS)
âŒ ~~Video Consultation~~ (Deferred - WebRTC phá»©c táº¡p)  
âŒ ~~Excel Import~~ (Deferred - Manual Ä‘á»§ cho MVP)  
âŒ ~~Multi-Agent Architecture~~ (Simplified to Single Agent)  
âŒ ~~Email/SMS Notifications~~ (Push Ä‘á»§ cho MVP)  

---

## ðŸ› ï¸ TECH STACK (Reference)

| Layer | Technologies |
|-------|-------------|
| **Web Frontend** | React 19+ Vite, TypeScript, Tailwind CSS, Zustand |
| **Mobile** | Flutter 3.5, iOS & Android |
| **Backend** | Java 21, Spring Boot 3.4.x, Spring Security (JWT) |
| **AI Layer** | Python 3.12, FastAPI, Single Agent (ReAct), FastMCP, LlamaIndex |
| **Databases** | PostgreSQL, MongoDB, Redis, Qdrant Cloud (Vector) |
| **Infrastructure** | Docker, Cloudinary, GitHub Actions |
| **Payment** | Stripe | 
| **Notifications** | Firebase (Push) |

---

**Version: 1.7.0 - PETTIES MVP SCOPE (VETâ†’STAFF MIGRATION COMPLETE)**
**Status: âœ… READY FOR DEV**
**Total Features: 109 Use Cases (Full Coverage)**
**Last Updated: January 29, 2026**

---

## ðŸ“Š MIGRATION STATUS: VET â†’ STAFF âœ… HOÃ€N THÃ€NH

> **Note:** Thuáº­t ngá»¯ `Vet` Ä‘Ã£ Ä‘Æ°á»£c migrate sang `Staff` Ä‘á»ƒ phÃ¹ há»£p vá»›i mÃ´ hÃ¬nh nhÃ¢n viÃªn Ä‘a dáº¡ng (BÃ¡c sÄ© thÃº y, Groomer, v.v.)

| ThÃ nh pháº§n | Tráº¡ng thÃ¡i |
|------------|------------|
| Database (Flyway) | âœ… 3 migrations |
| Backend (Spring Boot) | âœ… 98% |
| Frontend (React) | âœ… 100% |
| Mobile (Flutter) | âœ… 100% |
| Unit Tests | âœ… 62/62 passed |

**Chi tiáº¿t:** Xem `docs-references/development/dev/VET_TO_STAFF_MIGRATION_GUIDE.md`
