2025-12-25T10:38:32.988+07:00  INFO 27360 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Starting AuthControllerUnitTest using Java 21.0.9 with PID 27360 (started by TAN in d:\SEP490\petties\backend-spring\petties)
2025-12-25T10:38:32.990+07:00 DEBUG 27360 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T10:38:32.991+07:00  INFO 27360 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-25T10:38:33.013+07:00 DEBUG 27360 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@26dcd8c0
2025-12-25T10:38:35.819+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 14 mappings in 'requestMappingHandlerMapping'
2025-12-25T10:38:36.020+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T10:38:36.214+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T10:38:36.285+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T10:38:36.399+07:00  WARN 27360 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T10:38:36.400+07:00 DEBUG 27360 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T10:38:36.566+07:00 DEBUG 27360 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T10:38:36.639+07:00  INFO 27360 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T10:38:36.639+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T10:38:36.641+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 2 ms
2025-12-25T10:38:36.674+07:00  INFO 27360 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Started AuthControllerUnitTest in 4.159 seconds (process running for 5.615)
2025-12-25T10:38:36.803+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:36.856+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@7ae6927]
2025-12-25T10:38:36.966+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:36.990+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:36.995+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:36.968590900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.011+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [NotBlank.sendOtpRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password]]; default message [Mật khẩu không được để trống]] ]
2025-12-25T10:38:37.078+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T10:38:37.081+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@bd09a26]
2025-12-25T10:38:37.087+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.088+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.088+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.087553600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.090+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [1234567]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-25T10:38:37.117+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:37.119+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@65fa4a07]
2025-12-25T10:38:37.134+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:37.135+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.136+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.135046700, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-25T10:38:37.136+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-25T10:38:37.158+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T10:38:37.160+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@6d4c7248]
2025-12-25T10:38:37.170+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.170+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@66779435]
2025-12-25T10:38:37.232+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T10:38:37.234+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@644f6e89]
2025-12-25T10:38:37.238+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.238+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@77ad2767]
2025-12-25T10:38:37.250+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T10:38:37.251+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@7e84a52b]
2025-12-25T10:38:37.254+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.254+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.255+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.254398700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.256+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value [null]; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-25T10:38:37.270+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:37.271+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@c6a3f47]
2025-12-25T10:38:37.272+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.272+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.274+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.272609, status=400, error=Validation Failed, message=Mật (truncated)...]
2025-12-25T10:38:37.275+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [NotBlank.resetPasswordRequest.newPassword,NotBlank.newPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword]]; default message [Mật khẩu mới không được để trống]] ]
2025-12-25T10:38:37.285+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:37.287+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7267006e]
2025-12-25T10:38:37.288+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.290+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.290+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.290110900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.302+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [NotBlank.resetPasswordRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@303db609,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-25T10:38:37.313+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T10:38:37.314+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@5773f83d]
2025-12-25T10:38:37.317+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:37.317+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.317+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.317440500, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-25T10:38:37.317+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-25T10:38:37.329+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-25T10:38:37.344+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.345+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@2259d54f]
2025-12-25T10:38:37.360+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-25T10:38:37.361+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:37.362+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.362+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.362327, status=400, error=Bad Request, message=Please wa (truncated)...]
2025-12-25T10:38:37.362+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-25T10:38:37.374+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:37.375+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@435a2c7d]
2025-12-25T10:38:37.378+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.379+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.MessageResponse@57806346]
2025-12-25T10:38:37.390+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T10:38:37.390+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@3741071d]
2025-12-25T10:38:37.393+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.393+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.394+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.393977200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.394+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value []; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-25T10:38:37.405+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:37.406+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@28d7bd6b]
2025-12-25T10:38:37.407+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.409+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.409+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.407759200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.409+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value []; codes [NotBlank.resetPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-25T10:38:37.421+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T10:38:37.422+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@4b4228cf]
2025-12-25T10:38:37.422+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:37.424+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.424+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.422866200, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-25T10:38:37.425+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-25T10:38:37.436+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T10:38:37.437+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@af007d6]
2025-12-25T10:38:37.438+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.438+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@a20898c]
2025-12-25T10:38:37.450+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:37.450+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@32c8d67]
2025-12-25T10:38:37.451+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.452+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.452+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.451802200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.452+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value [Pass1]; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-25T10:38:37.499+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:37.499+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7164e28a]
2025-12-25T10:38:37.502+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.518+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.519+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.518349900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.520+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.resetPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@51efdb72,.*]; default message [Email không đúng định dạng]] ]
2025-12-25T10:38:37.563+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:37.564+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@59d09ff3]
2025-12-25T10:38:37.566+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.567+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.567+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.567435400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.568+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value []; codes [NotBlank.sendOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-25T10:38:37.584+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:37.585+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@4d9cf71d]
2025-12-25T10:38:37.599+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:37.600+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.601+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.600399700, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T10:38:37.601+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email already exists]
2025-12-25T10:38:37.611+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:37.612+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@b6b746b]
2025-12-25T10:38:37.613+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.614+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@55d8f6bb]
2025-12-25T10:38:37.646+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-25T10:38:37.648+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:37.648+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.649+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.648649200, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-25T10:38:37.649+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending password reset found]
2025-12-25T10:38:37.659+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:37.661+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@6e22d6bf]
2025-12-25T10:38:37.663+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.663+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.663+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.663061800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.664+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'username': rejected value [ab]; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] ]
2025-12-25T10:38:37.675+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-25T10:38:37.677+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:37.678+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.678+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.677072800, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-25T10:38:37.678+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-25T10:38:37.687+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T10:38:37.689+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@f8fe81e]
2025-12-25T10:38:37.691+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:37.691+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /auth/google: Invalid Google ID token
2025-12-25T10:38:37.695+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.695+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.694558800, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-25T10:38:37.695+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid Google ID token]
2025-12-25T10:38:37.708+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-25T10:38:37.709+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@2ba0b95f]
2025-12-25T10:38:37.714+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:37.714+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.714+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.714505500, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T10:38:37.714+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email not found]
2025-12-25T10:38:37.727+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-25T10:38:37.728+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@78e7b83]
2025-12-25T10:38:37.729+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.729+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.729+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.729039700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.730+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.forgotPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@51efdb72,.*]; default message [Email không đúng định dạng]] ]
2025-12-25T10:38:37.737+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:37.738+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@1c528f2f]
2025-12-25T10:38:37.739+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.740+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.741+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.740851300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.741+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value [abc123]; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@303db609,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-25T10:38:37.750+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T10:38:37.751+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@35451ba6]
2025-12-25T10:38:37.752+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.753+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.754+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.753225400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.755+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [12345]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-25T10:38:37.765+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:37.765+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@2fc0ad21]
2025-12-25T10:38:37.769+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.769+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.770+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.769813200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.770+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [NotBlank.sendOtpRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username]]; default message [Tên đăng nhập không được để trống]] ]
2025-12-25T10:38:37.779+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-25T10:38:37.782+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:37.782+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.783+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.782862400, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-25T10:38:37.783+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending registration found]
2025-12-25T10:38:37.794+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T10:38:37.796+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@3e24bab6]
2025-12-25T10:38:37.797+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.798+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.799+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.797131900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.799+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value []; codes [NotBlank.verifyOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-25T10:38:37.811+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T10:38:37.811+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@391e2a]
2025-12-25T10:38:37.813+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.814+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.814+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.813458600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.816+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'idToken': rejected value []; codes [NotBlank.googleSignInRequest.idToken,NotBlank.idToken,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.idToken,idToken]; arguments []; default message [idToken]]; default message [ID token is required]] ]
2025-12-25T10:38:37.825+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:37.826+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@6a8bcb64]
2025-12-25T10:38:37.827+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.827+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.828+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.827819, status=400, error=Validation Failed, message=Xác (truncated)...]
2025-12-25T10:38:37.828+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'confirmPassword': rejected value []; codes [NotBlank.resetPasswordRequest.confirmPassword,NotBlank.confirmPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.confirmPassword,confirmPassword]; arguments []; default message [confirmPassword]]; default message [Xác nhận mật khẩu không được để trống]] ]
2025-12-25T10:38:37.838+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:37.839+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@78b2d29e]
2025-12-25T10:38:37.840+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.840+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.841+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.840986600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.843+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'fullName': rejected value []; codes [NotBlank.sendOtpRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-25T10:38:37.852+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-25T10:38:37.852+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@25b402ea]
2025-12-25T10:38:37.853+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.853+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@2fccd98f]
2025-12-25T10:38:37.862+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:37.863+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@575fe6da]
2025-12-25T10:38:37.864+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.865+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.866+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.865236600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.866+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'password': rejected value [12345]; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] ]
2025-12-25T10:38:37.877+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T10:38:37.878+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@b814e23]
2025-12-25T10:38:37.879+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.879+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.879+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.879360200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.880+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value [null]; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-25T10:38:37.888+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T10:38:37.888+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@7c4a5ef2]
2025-12-25T10:38:37.889+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.891+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.891+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.889995400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.892+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest) with 2 errors: [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [NotBlank.verifyOtpRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-25T10:38:37.901+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T10:38:37.903+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@38e052b2]
2025-12-25T10:38:37.905+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.905+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@7fa68ff4]
2025-12-25T10:38:37.914+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T10:38:37.916+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@2f64f99f]
2025-12-25T10:38:37.916+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.916+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.917+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.916757900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.918+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value []; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-25T10:38:37.926+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T10:38:37.927+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@4e210016]
2025-12-25T10:38:37.928+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.928+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@2fc40856]
2025-12-25T10:38:37.937+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T10:38:37.939+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@57ed8f95]
2025-12-25T10:38:37.941+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.941+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@1c25deb0]
2025-12-25T10:38:37.951+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T10:38:37.952+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@6fe337a5]
2025-12-25T10:38:37.953+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.954+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@7d60bd5a]
2025-12-25T10:38:37.963+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-25T10:38:37.964+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@1d2d793d]
2025-12-25T10:38:37.966+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.966+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.966+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.966565300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:37.967+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value []; codes [NotBlank.forgotPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-25T10:38:37.975+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T10:38:37.977+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@156eeff1]
2025-12-25T10:38:37.978+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:37.978+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /auth/login: Invalid username or password
2025-12-25T10:38:37.979+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.979+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.979246700, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-25T10:38:37.979+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid username or password]
2025-12-25T10:38:37.988+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-25T10:38:37.990+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:37.990+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@618e7761]
2025-12-25T10:38:37.997+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T10:38:37.998+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@30ca66c5]
2025-12-25T10:38:37.999+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:37.999+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.000+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:37.999283100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:38.000+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'platform': rejected value []; codes [NotBlank.googleSignInRequest.platform,NotBlank.platform,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.platform,platform]; arguments []; default message [platform]]; default message [Platform is required]] ]
2025-12-25T10:38:38.009+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:38.010+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@10bcbbce]
2025-12-25T10:38:38.012+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:38.012+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.013+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:38.012615300, status=400, error=Bad Request, message=Passwo (truncated)...]
2025-12-25T10:38:38.013+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Passwords do not match]
2025-12-25T10:38:38.022+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:38.022+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@31f9f9b3]
2025-12-25T10:38:38.025+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:38.025+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.025+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:38.025737100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:38.025+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'role': rejected value [null]; codes [NotNull.sendOtpRequest.role,NotNull.role,NotNull.com.petties.petties.model.enums.Role,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.role,role]; arguments []; default message [role]]; default message [Vai trò không được để trống]] ]
2025-12-25T10:38:38.035+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T10:38:38.036+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@41948c13]
2025-12-25T10:38:38.037+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:38.038+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.038+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:38.038163300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:38.039+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.sendOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@51efdb72,.*]; default message [Email không hợp lệ]] ]
2025-12-25T10:38:38.051+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T10:38:38.052+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@533e8807]
2025-12-25T10:38:38.053+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:38.054+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.055+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:38.053710100, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-25T10:38:38.055+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-25T10:38:38.064+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T10:38:38.065+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@5a45c218]
2025-12-25T10:38:38.066+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:38.067+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.067+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:38.066930600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:38.068+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.verifyOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@51efdb72,.*]; default message [Email không hợp lệ]] ]
2025-12-25T10:38:38.084+07:00  INFO 27360 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.ClinicControllerUnitTest]: ClinicControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-25T10:38:38.105+07:00  INFO 27360 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.ClinicControllerUnitTest
2025-12-25T10:38:38.111+07:00  INFO 27360 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-25T10:38:38.148+07:00  INFO 27360 --- [petties] [main] c.p.p.c.ClinicControllerUnitTest         : Starting ClinicControllerUnitTest using Java 21.0.9 with PID 27360 (started by TAN in d:\SEP490\petties\backend-spring\petties)
2025-12-25T10:38:38.148+07:00 DEBUG 27360 --- [petties] [main] c.p.p.c.ClinicControllerUnitTest         : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T10:38:38.148+07:00  INFO 27360 --- [petties] [main] c.p.p.c.ClinicControllerUnitTest         : The following 1 profile is active: "dev"
2025-12-25T10:38:38.151+07:00 DEBUG 27360 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@4ed5492c
2025-12-25T10:38:38.634+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 18 mappings in 'requestMappingHandlerMapping'
2025-12-25T10:38:38.681+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T10:38:38.693+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T10:38:38.699+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T10:38:38.725+07:00  WARN 27360 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T10:38:38.725+07:00 DEBUG 27360 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T10:38:38.742+07:00 DEBUG 27360 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T10:38:38.753+07:00  INFO 27360 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T10:38:38.754+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T10:38:38.755+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-25T10:38:38.766+07:00  INFO 27360 --- [petties] [main] c.p.p.c.ClinicControllerUnitTest         : Started ClinicControllerUnitTest in 0.655 seconds (process running for 7.707)
2025-12-25T10:38:38.789+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#uploadClinicImage(UUID, MultipartFile, String, Integer, Boolean)
2025-12-25T10:38:38.794+07:00  INFO 27360 --- [petties] [main] c.p.petties.controller.ClinicController  : Uploading image for clinic: 6bc2a703-f254-4dfa-ad2d-f7b391213cda, file size: 10, content type: image/jpeg
2025-12-25T10:38:38.795+07:00  INFO 27360 --- [petties] [main] c.p.petties.controller.ClinicController  : File uploaded to Cloudinary: http://cloudinary.com/image.jpg
2025-12-25T10:38:38.796+07:00  INFO 27360 --- [petties] [main] c.p.petties.controller.ClinicController  : Clinic image saved successfully for clinic: 6bc2a703-f254-4dfa-ad2d-f7b391213cda
2025-12-25T10:38:38.813+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.814+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@793248d]
2025-12-25T10:38:38.863+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getAllClinics(ClinicStatus, String, int, int, String, Direction)
2025-12-25T10:38:38.874+07:00  WARN 27360 --- [petties] [main] ration$PageModule$WarningLoggingModifier : Serializing PageImpl instances as-is is not supported, meaning that there is no guarantee about the stability of the resulting JSON structure!
	For a stable JSON structure, please use Spring Data's PagedModel (globally via @EnableSpringDataWebSupport(pageSerializationMode = VIA_DTO))
	or Spring HATEOAS and Spring Data's PagedResourcesAssembler as documented in https://docs.spring.io/spring-data/commons/reference/repositories/core-extensions.html#core.web.pageables.

2025-12-25T10:38:38.877+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.879+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing com.petties.petties.dto.clinic.ClinicResponse instances]
2025-12-25T10:38:38.897+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#uploadClinicLogo(UUID, MultipartFile)
2025-12-25T10:38:38.898+07:00  INFO 27360 --- [petties] [main] c.p.petties.controller.ClinicController  : Uploading logo for clinic: f2be9051-a0be-4ba0-89e1-97b5c076b0e4, file size: 9, content type: image/jpeg
2025-12-25T10:38:38.899+07:00  INFO 27360 --- [petties] [main] c.p.petties.controller.ClinicController  : Logo uploaded to Cloudinary: url
2025-12-25T10:38:38.899+07:00  INFO 27360 --- [petties] [main] c.p.petties.controller.ClinicController  : Clinic logo saved successfully for clinic: f2be9051-a0be-4ba0-89e1-97b5c076b0e4
2025-12-25T10:38:38.899+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.899+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@737ae41a]
2025-12-25T10:38:38.906+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#findNearbyClinics(BigDecimal, BigDecimal, double, int, int)
2025-12-25T10:38:38.913+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.914+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing com.petties.petties.dto.clinic.ClinicResponse instances]
2025-12-25T10:38:38.925+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#createClinic(ClinicRequest)
2025-12-25T10:38:38.932+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinic.ClinicRequest@206de1f]
2025-12-25T10:38:38.943+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.944+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@7a41f4a7]
2025-12-25T10:38:38.952+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getClinicById(UUID)
2025-12-25T10:38:38.952+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.952+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@4cff38ff]
2025-12-25T10:38:38.959+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getAllClinics(ClinicStatus, String, int, int, String, Direction)
2025-12-25T10:38:38.961+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.961+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing UNKNOWN instances]
2025-12-25T10:38:38.969+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#searchClinics(String, int, int)
2025-12-25T10:38:38.972+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.972+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing com.petties.petties.dto.clinic.ClinicResponse instances]
2025-12-25T10:38:38.981+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#createClinic(ClinicRequest)
2025-12-25T10:38:38.981+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinic.ClinicRequest@70fcd3e5]
2025-12-25T10:38:38.984+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:38.989+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:38.991+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:38.984422700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:38.992+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.clinic.ClinicResponse> com.petties.petties.controller.ClinicController.createClinic(com.petties.petties.dto.clinic.ClinicRequest): [Field error in object 'clinicRequest' on field 'name': rejected value []; codes [NotBlank.clinicRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicRequest.name,name]; arguments []; default message [name]]; default message [Tên phòng khám không được để trống]] ]
2025-12-25T10:38:39.002+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#approveClinic(UUID)
2025-12-25T10:38:39.003+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.004+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@7be3a837]
2025-12-25T10:38:39.013+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getClinicById(UUID)
2025-12-25T10:38:39.015+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-25T10:38:39.015+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.015+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:39.015066600, status=404, error=Not Found, message=Clinic n (truncated)...]
2025-12-25T10:38:39.015+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Clinic not found]
2025-12-25T10:38:39.022+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#updateClinic(UUID, ClinicRequest)
2025-12-25T10:38:39.024+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinic.ClinicRequest@363ee411]
2025-12-25T10:38:39.025+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T10:38:39.025+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/6772a596-8a18-4ead-abd1-3fa717b64cf4: You can only update your own clinic
2025-12-25T10:38:39.027+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.027+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:39.027162400, status=403, error=Forbidden, message=You can  (truncated)...]
2025-12-25T10:38:39.028+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: You can only update your own clinic]
2025-12-25T10:38:39.041+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getAllClinics(ClinicStatus, String, int, int, String, Direction)
2025-12-25T10:38:39.046+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.046+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing com.petties.petties.dto.clinic.ClinicResponse instances]
2025-12-25T10:38:39.062+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#rejectClinic(UUID, Map)
2025-12-25T10:38:39.064+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [{reason=Invalid information}]
2025-12-25T10:38:39.066+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.067+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@565983f3]
2025-12-25T10:38:39.075+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#deleteClinic(UUID)
2025-12-25T10:38:39.079+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.079+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Clinic deleted successfully}]
2025-12-25T10:38:39.088+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#updateClinic(UUID, ClinicRequest)
2025-12-25T10:38:39.089+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinic.ClinicRequest@4010f232]
2025-12-25T10:38:39.091+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.091+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@24be6e34]
2025-12-25T10:38:39.104+07:00  INFO 27360 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.ClinicServiceControllerUnitTest]: ClinicServiceControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-25T10:38:39.128+07:00  INFO 27360 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.ClinicServiceControllerUnitTest
2025-12-25T10:38:39.135+07:00  INFO 27360 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-25T10:38:39.174+07:00  INFO 27360 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Starting ClinicServiceControllerUnitTest using Java 21.0.9 with PID 27360 (started by TAN in d:\SEP490\petties\backend-spring\petties)
2025-12-25T10:38:39.174+07:00 DEBUG 27360 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T10:38:39.174+07:00  INFO 27360 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-25T10:38:39.177+07:00 DEBUG 27360 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@4986b0ea
2025-12-25T10:38:39.538+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-25T10:38:39.572+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T10:38:39.578+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T10:38:39.582+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T10:38:39.602+07:00  WARN 27360 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T10:38:39.602+07:00 DEBUG 27360 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T10:38:39.609+07:00 DEBUG 27360 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T10:38:39.616+07:00  INFO 27360 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T10:38:39.617+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T10:38:39.617+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-12-25T10:38:39.622+07:00  INFO 27360 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Started ClinicServiceControllerUnitTest in 0.488 seconds (process running for 8.564)
2025-12-25T10:38:39.633+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#deleteService(UUID)
2025-12-25T10:38:39.636+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.636+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-25T10:38:39.655+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-25T10:38:39.661+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@4ab1693b]
2025-12-25T10:38:39.675+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.675+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@4c140b12]
2025-12-25T10:38:39.685+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-25T10:38:39.686+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.687+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@329b4b8b]
2025-12-25T10:38:39.697+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-25T10:38:39.701+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@52bcd7c9]
2025-12-25T10:38:39.707+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.708+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@6dccdc50]
2025-12-25T10:38:39.715+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getAllServices()
2025-12-25T10:38:39.717+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.717+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[com.petties.petties.dto.clinicService.ClinicServiceResponse@4d2bcca8]]
2025-12-25T10:38:39.727+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-25T10:38:39.730+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-25T10:38:39.733+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.734+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:39.730887500, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-25T10:38:39.734+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-25T10:38:39.741+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-25T10:38:39.742+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@760f4310]
2025-12-25T10:38:39.744+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:39.744+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.744+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:39.744969, status=400, error=Validation Failed, message=Số  (truncated)...]
2025-12-25T10:38:39.746+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.clinicService.ClinicServiceResponse> com.petties.petties.controller.ClinicServiceController.createService(com.petties.petties.dto.clinicService.ClinicServiceRequest) with 3 errors: [Field error in object 'clinicServiceRequest' on field 'slotsRequired': rejected value [null]; codes [NotNull.clinicServiceRequest.slotsRequired,NotNull.slotsRequired,NotNull.java.lang.Integer,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.slotsRequired,slotsRequired]; arguments []; default message [slotsRequired]]; default message [Số slot yêu cầu không được để trống]] [Field error in object 'clinicServiceRequest' on field 'name': rejected value [null]; codes [NotBlank.clinicServiceRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.name,name]; arguments []; default message [name]]; default message [Tên dịch vụ không được để trống]] [Field error in object 'clinicServiceRequest' on field 'basePrice': rejected value [null]; codes [NotNull.clinicServiceRequest.basePrice,NotNull.basePrice,NotNull.java.math.BigDecimal,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.basePrice,basePrice]; arguments []; default message [basePrice]]; default message [Giá cơ bản không được để trống]] ]
2025-12-25T10:38:39.763+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-25T10:38:39.764+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:39.765+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@7806db3f]
2025-12-25T10:38:39.776+07:00  INFO 27360 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.ClinicStaffControllerUnitTest]: ClinicStaffControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-25T10:38:39.797+07:00  INFO 27360 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.ClinicStaffControllerUnitTest
2025-12-25T10:38:39.801+07:00  INFO 27360 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-25T10:38:39.836+07:00  INFO 27360 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 27360 (started by TAN in d:\SEP490\petties\backend-spring\petties)
2025-12-25T10:38:39.836+07:00 DEBUG 27360 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T10:38:39.836+07:00  INFO 27360 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-25T10:38:39.837+07:00 DEBUG 27360 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@72499396
2025-12-25T10:38:40.142+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 7 mappings in 'requestMappingHandlerMapping'
2025-12-25T10:38:40.168+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T10:38:40.174+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T10:38:40.178+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T10:38:40.194+07:00  WARN 27360 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T10:38:40.194+07:00 DEBUG 27360 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T10:38:40.202+07:00 DEBUG 27360 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T10:38:40.217+07:00  INFO 27360 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T10:38:40.217+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T10:38:40.218+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-12-25T10:38:40.222+07:00  INFO 27360 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 0.421 seconds (process running for 9.163)
2025-12-25T10:38:40.230+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T10:38:40.235+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=, phone=0912345678, role=VET)]
2025-12-25T10:38:40.249+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.253+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.254+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.249760, status=400, error=Validation Failed, message=Họ  (truncated)...]
2025-12-25T10:38:40.256+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'fullName': rejected value []; codes [NotBlank.quickAddStaffRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-25T10:38:40.265+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T10:38:40.267+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Duplicate User, phone=0987654321, role=VET)]
2025-12-25T10:38:40.268+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceAlreadyExists(ResourceAlreadyExistsException, HttpServletRequest)
2025-12-25T10:38:40.268+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.268+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.268093300, status=409, error=Conflict, message=Số điện t (truncated)...]
2025-12-25T10:38:40.269+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceAlreadyExistsException: Số điện thoại này đã được đăng ký tài khoản]
2025-12-25T10:38:40.275+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-25T10:38:40.279+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.282+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=039a53e1-8494-49c8-ae71-46d52e3756ca, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-25T10:38:40.295+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T10:38:40.296+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Fake Admin, phone=0912345678, role=ADMIN)]
2025-12-25T10:38:40.297+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T10:38:40.298+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/0afaae9d-fb42-45a9-af23-f255011f7bba/staff/quick-add: Không thể tạo tài khoản ADMIN qua chức năng này
2025-12-25T10:38:40.299+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.299+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.299139500, status=403, error=Forbidden, message=Không th (truncated)...]
2025-12-25T10:38:40.299+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Không thể tạo tài khoản ADMIN qua chức năng này]
2025-12-25T10:38:40.306+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T10:38:40.312+07:00 DEBUG 27360 --- [petties] [main] o.s.web.method.HandlerMethod             : Could not resolve parameter [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]
2025-12-25T10:38:40.320+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleHttpMessageNotReadable(HttpMessageNotReadableException, HttpServletRequest)
2025-12-25T10:38:40.320+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.320+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.320520500, status=400, error=Bad Request, message=Dữ liệ (truncated)...]
2025-12-25T10:38:40.321+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]]
2025-12-25T10:38:40.327+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-25T10:38:40.328+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-25T10:38:40.330+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-25T10:38:40.339+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T10:38:40.339+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Tester, phone=123, role=VET)]
2025-12-25T10:38:40.339+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.339+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.340+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.339866100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:40.341+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'phone': rejected value [123]; codes [Pattern.quickAddStaffRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@303db609,^[0-9]{10,11}$]; default message [Số điện thoại không hợp lệ]] ]
2025-12-25T10:38:40.348+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-25T10:38:40.349+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-25T10:38:40.349+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-25T10:38:40.375+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-25T10:38:40.375+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-25T10:38:40.377+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.377+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.375922600, status=404, error=Not Found, message=User not (truncated)...]
2025-12-25T10:38:40.377+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: User not found]
2025-12-25T10:38:40.383+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T10:38:40.384+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-25T10:38:40.384+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-25T10:38:40.384+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-25T10:38:40.391+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignVet(UUID, String)
2025-12-25T10:38:40.392+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T10:38:40.392+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/8ba963d4-34bc-401e-953a-f7ee614a3e83/staff/vet/vet@test.com: Bạn không có quyền quản lý phòng khám này
2025-12-25T10:38:40.392+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.392+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.392585300, status=403, error=Forbidden, message=Bạn khôn (truncated)...]
2025-12-25T10:38:40.393+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Bạn không có quyền quản lý phòng khám này]
2025-12-25T10:38:40.400+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T10:38:40.400+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-25T10:38:40.401+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T10:38:40.402+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/43dd24d1-613f-4097-82e6-10674349ac69/staff/quick-add: Quản lý phòng khám chỉ có quyền thêm Bác sĩ
2025-12-25T10:38:40.402+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.402+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.402172300, status=403, error=Forbidden, message=Quản lý  (truncated)...]
2025-12-25T10:38:40.402+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Quản lý phòng khám chỉ có quyền thêm Bác sĩ]
2025-12-25T10:38:40.412+07:00  INFO 27360 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.UserControllerUnitTest]: UserControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-25T10:38:40.429+07:00  INFO 27360 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.UserControllerUnitTest
2025-12-25T10:38:40.433+07:00  INFO 27360 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-25T10:38:40.466+07:00  INFO 27360 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Starting UserControllerUnitTest using Java 21.0.9 with PID 27360 (started by TAN in d:\SEP490\petties\backend-spring\petties)
2025-12-25T10:38:40.466+07:00 DEBUG 27360 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T10:38:40.466+07:00  INFO 27360 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-25T10:38:40.468+07:00 DEBUG 27360 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@439c706
2025-12-25T10:38:40.717+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-25T10:38:40.743+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T10:38:40.748+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T10:38:40.753+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T10:38:40.770+07:00  WARN 27360 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T10:38:40.770+07:00 DEBUG 27360 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T10:38:40.782+07:00 DEBUG 27360 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T10:38:40.789+07:00  INFO 27360 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T10:38:40.789+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T10:38:40.789+07:00  INFO 27360 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-12-25T10:38:40.796+07:00  INFO 27360 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Started UserControllerUnitTest in 0.363 seconds (process running for 9.737)
2025-12-25T10:38:40.805+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:40.808+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=12345)]
2025-12-25T10:38:40.813+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.817+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.817+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.813835200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:40.817+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [12345]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@303db609,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-25T10:38:40.833+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-25T10:38:40.835+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@4cb42a5a]
2025-12-25T10:38:40.837+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.837+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.838+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.837635100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:40.838+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'phone': rejected value [not-a-number]; codes [Pattern.updateProfileRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@303db609,^0\d{9,10}$]; default message [Số điện thoại không hợp lệ (10-11 số, bắt đầu bằng 0)]] ]
2025-12-25T10:38:40.843+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-25T10:38:40.843+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@2899745e]
2025-12-25T10:38:40.844+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.844+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.844+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.844553700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:40.846+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'fullName': rejected value []; codes [Size.updateProfileRequest.fullName,Size.fullName,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.fullName,fullName]; arguments []; default message [fullName],100,2]; default message [Họ tên phải từ 2-100 ký tự]] ]
2025-12-25T10:38:40.852+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-25T10:38:40.855+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.855+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@2c07277f]
2025-12-25T10:38:40.862+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-25T10:38:40.864+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.864+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@2c8174ce]
2025-12-25T10:38:40.870+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T10:38:40.870+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:40.870+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/email/resend-otp: User not authenticated
2025-12-25T10:38:40.870+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.870+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.870890300, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T10:38:40.872+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T10:38:40.878+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-25T10:38:40.880+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:40.881+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile: User not authenticated
2025-12-25T10:38:40.881+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.881+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.881122100, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T10:38:40.881+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T10:38:40.891+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T10:38:40.893+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=)]
2025-12-25T10:38:40.897+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.897+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.897+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.897314100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:40.897+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-25T10:38:40.902+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:40.903+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=1234567)]
2025-12-25T10:38:40.904+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.904+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.904+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.904868300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:40.905+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [1234567]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@303db609,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-25T10:38:40.912+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-25T10:38:40.913+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@43ee585f]
2025-12-25T10:38:40.918+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:40.919+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.919+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.919492300, status=400, error=Bad Request, message=Mật kh (truncated)...]
2025-12-25T10:38:40.919+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Mật khẩu hiện tại không chính xác]
2025-12-25T10:38:40.924+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T10:38:40.925+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=not-an-email)]
2025-12-25T10:38:40.925+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.925+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.925+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.925846100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:40.925+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@51efdb72,.*]; default message [Email khong hop le]] ]
2025-12-25T10:38:40.933+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-25T10:38:40.934+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@155788a7]
2025-12-25T10:38:40.936+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.936+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Doi mat khau thanh cong}]
2025-12-25T10:38:40.943+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-25T10:38:40.944+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.944+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@7798de95]
2025-12-25T10:38:40.950+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:40.951+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=)]
2025-12-25T10:38:40.952+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.952+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.952+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.952360900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:40.952+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest) with 2 errors: [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [NotBlank.emailChangeVerifyRequest.otp,NotBlank.otp,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp]]; default message [Ma OTP khong duoc de trong]] [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@303db609,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-25T10:38:40.957+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-25T10:38:40.958+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:40.958+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.958+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.958995900, status=400, error=Bad Request, message=File i (truncated)...]
2025-12-25T10:38:40.960+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: File is empty]
2025-12-25T10:38:40.966+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:40.966+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=not-an-email, otp=123456)]
2025-12-25T10:38:40.967+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:40.967+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.967+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.967743600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:40.967+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeVerifyRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@51efdb72,.*]; default message [Email khong hop le]] ]
2025-12-25T10:38:40.974+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-25T10:38:40.975+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@6a17ab87]
2025-12-25T10:38:40.975+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:40.975+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile: User not authenticated
2025-12-25T10:38:40.977+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.977+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.977000600, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T10:38:40.977+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T10:38:40.983+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T10:38:40.983+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-25T10:38:40.986+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.986+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=OTP da duoc gui den email moi}]
2025-12-25T10:38:40.993+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-25T10:38:40.994+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:40.995+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/avatar: User not authenticated
2025-12-25T10:38:40.995+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:40.995+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:40.995283600, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T10:38:40.995+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T10:38:41.002+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T10:38:41.003+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.003+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.003+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.003353800, status=400, error=Bad Request, message=Khong  (truncated)...]
2025-12-25T10:38:41.004+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Khong co yeu cau thay doi email. Vui long tao yeu cau moi.]
2025-12-25T10:38:41.013+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T10:38:41.013+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=test@example.com)]
2025-12-25T10:38:41.015+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.015+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.015+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.015428500, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T10:38:41.015+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi phai khac email hien tai]
2025-12-25T10:38:41.022+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T10:38:41.023+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-25T10:38:41.024+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:41.024+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/email/request-change: User not authenticated
2025-12-25T10:38:41.024+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.024+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.024069500, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T10:38:41.024+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T10:38:41.031+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-25T10:38:41.032+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@2a0154f7]
2025-12-25T10:38:41.032+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.032+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@237e61ac]
2025-12-25T10:38:41.039+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T10:38:41.039+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-25T10:38:41.041+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.041+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.042+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.041944200, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-25T10:38:41.042+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 45 giay truoc khi gui lai ma OTP]
2025-12-25T10:38:41.047+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:41.048+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-25T10:38:41.050+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.050+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.050+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.050323400, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-25T10:38:41.051+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong chinh xac hoac da het han]
2025-12-25T10:38:41.056+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T10:38:41.057+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.058+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Ma OTP moi da duoc gui den email moi}]
2025-12-25T10:38:41.063+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:41.064+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-25T10:38:41.065+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.065+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.065+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.065314100, status=400, error=Bad Request, message=Ban da (truncated)...]
2025-12-25T10:38:41.065+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ban da nhap sai ma OTP qua nhieu lan. Vui long yeu cau gui ma OTP moi.]
2025-12-25T10:38:41.073+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:41.073+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=, otp=123456)]
2025-12-25T10:38:41.075+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:41.075+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.075+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.075268100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:41.076+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeVerifyRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-25T10:38:41.083+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:41.084+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=different@example.com, otp=123456)]
2025-12-25T10:38:41.084+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.084+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.084+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.084694, status=400, error=Bad Request, message=Email moi (truncated)...]
2025-12-25T10:38:41.086+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi khong khop voi yeu cau truoc do]
2025-12-25T10:38:41.093+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T10:38:41.093+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=existing@example.com)]
2025-12-25T10:38:41.094+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.094+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.094+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.094565500, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T10:38:41.094+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-25T10:38:41.101+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:41.101+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-25T10:38:41.102+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.103+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@7c5ae5c3]
2025-12-25T10:38:41.110+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:41.110+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-25T10:38:41.111+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.111+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.111+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.111544200, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-25T10:38:41.112+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong dung. Ban con 4 lan thu.]
2025-12-25T10:38:41.118+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-25T10:38:41.120+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:41.120+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/avatar: User not authenticated
2025-12-25T10:38:41.120+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.120+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.120318500, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T10:38:41.120+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T10:38:41.127+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T10:38:41.129+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.129+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.129+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.129565, status=400, error=Bad Request, message=Vui long  (truncated)...]
2025-12-25T10:38:41.129+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 30 giay truoc khi gui lai ma OTP]
2025-12-25T10:38:41.137+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:41.138+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=abc123)]
2025-12-25T10:38:41.138+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T10:38:41.140+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.140+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.140069700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T10:38:41.140+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [abc123]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@303db609,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-25T10:38:41.146+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-25T10:38:41.146+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@2910c3ae]
2025-12-25T10:38:41.148+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:41.148+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/password: User not authenticated
2025-12-25T10:38:41.148+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.148+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.148281700, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T10:38:41.148+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T10:38:41.154+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-25T10:38:41.155+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.155+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.155+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.155963400, status=400, error=Bad Request, message=User n (truncated)...]
2025-12-25T10:38:41.155+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: User not found]
2025-12-25T10:38:41.162+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T10:38:41.163+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T10:38:41.163+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.163+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.163364500, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T10:38:41.163+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-25T10:38:41.170+07:00 DEBUG 27360 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T10:38:41.170+07:00 DEBUG 27360 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-25T10:38:41.171+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T10:38:41.171+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/email/verify-change: User not authenticated
2025-12-25T10:38:41.171+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T10:38:41.172+07:00 DEBUG 27360 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T10:38:41.171516600, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T10:38:41.172+07:00 DEBUG 27360 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T10:38:41.765+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Authentication failed at /api/v1/test: Full authentication required
2025-12-25T10:38:41.768+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Authentication failed at /api/v1/test: null
2025-12-25T10:38:41.779+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /api/v1/test: Chua xac thuc
2025-12-25T10:38:41.805+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Access Denied to /api/v1/test: Access is denied
2025-12-25T10:38:41.807+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Access Denied to /api/v1/test: Access denied
2025-12-25T10:38:41.812+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test: Forbidden
2025-12-25T10:38:41.815+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test: 
2025-12-25T10:38:41.821+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test: null
2025-12-25T10:38:41.829+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test:    
2025-12-25T10:38:41.834+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test: Ban khong co quyen xem tai nguyen nay
2025-12-25T10:38:41.842+07:00 ERROR 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unexpected error occurred at /api/v1/test: 

java.lang.RuntimeException: Some unexpected error
	at com.petties.petties.exception.GlobalExceptionHandlerTest$GenericExceptionTests.handleGenericException_ShouldReturn500Status(GlobalExceptionHandlerTest.java:125) ~[test-classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767) ~[junit-platform-commons-1.11.3.jar:1.11.3]
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56) ~[surefire-junit-platform-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184) ~[surefire-junit-platform-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148) ~[surefire-junit-platform-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122) ~[surefire-junit-platform-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.5.2.jar:3.5.2]

2025-12-25T10:38:41.850+07:00 ERROR 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unexpected error occurred at /api/v1/test: 

java.lang.Exception: Unexpected error
	at com.petties.petties.exception.GlobalExceptionHandlerTest$GenericExceptionTests.handleGenericException_ShouldReturnVietnameseMessage(GlobalExceptionHandlerTest.java:108) ~[test-classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767) ~[junit-platform-commons-1.11.3.jar:1.11.3]
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56) ~[surefire-junit-platform-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:184) ~[surefire-junit-platform-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:148) ~[surefire-junit-platform-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:122) ~[surefire-junit-platform-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.5.2.jar:3.5.2]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.5.2.jar:3.5.2]

2025-12-25T10:38:41.857+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Bad credentials attempt at /api/v1/test
2025-12-25T10:38:41.861+07:00  WARN 27360 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Bad credentials attempt at /api/v1/test
2025-12-25T10:38:41.909+07:00 DEBUG 27360 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@26dcd8c0, started on Thu Dec 25 10:38:33 ICT 2025
2025-12-25T10:38:41.914+07:00 DEBUG 27360 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@4ed5492c, started on Thu Dec 25 10:38:38 ICT 2025
2025-12-25T10:38:41.916+07:00 DEBUG 27360 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@4986b0ea, started on Thu Dec 25 10:38:39 ICT 2025
2025-12-25T10:38:41.924+07:00 DEBUG 27360 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@72499396, started on Thu Dec 25 10:38:39 ICT 2025
2025-12-25T10:38:41.925+07:00 DEBUG 27360 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@439c706, started on Thu Dec 25 10:38:40 ICT 2025
2025-12-25T11:34:12.434+07:00  INFO 20792 --- [petties] [main] c.p.p.c.ClinicControllerUnitTest         : Starting ClinicControllerUnitTest using Java 21.0.9 with PID 20792 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-25T11:34:12.437+07:00 DEBUG 20792 --- [petties] [main] c.p.p.c.ClinicControllerUnitTest         : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T11:34:12.438+07:00  INFO 20792 --- [petties] [main] c.p.p.c.ClinicControllerUnitTest         : The following 1 profile is active: "dev"
2025-12-25T11:34:12.462+07:00 DEBUG 20792 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@63429932
2025-12-25T11:34:15.649+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 18 mappings in 'requestMappingHandlerMapping'
2025-12-25T11:34:15.907+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T11:34:16.121+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T11:34:16.264+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T11:34:16.405+07:00  WARN 20792 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T11:34:16.405+07:00 DEBUG 20792 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T11:34:16.584+07:00 DEBUG 20792 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T11:34:16.666+07:00  INFO 20792 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T11:34:16.667+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T11:34:16.670+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 3 ms
2025-12-25T11:34:16.725+07:00  INFO 20792 --- [petties] [main] c.p.p.c.ClinicControllerUnitTest         : Started ClinicControllerUnitTest in 4.881 seconds (process running for 6.539)
2025-12-25T11:34:16.932+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#uploadClinicImage(UUID, MultipartFile, String, Integer, Boolean)
2025-12-25T11:34:16.991+07:00  INFO 20792 --- [petties] [main] c.p.petties.controller.ClinicController  : Uploading image for clinic: efbaeddd-c43d-4fc0-8448-e689cc2cc4f6, file size: 10, content type: image/jpeg
2025-12-25T11:34:17.000+07:00  INFO 20792 --- [petties] [main] c.p.petties.controller.ClinicController  : File uploaded to Cloudinary: http://cloudinary.com/image.jpg
2025-12-25T11:34:17.002+07:00  INFO 20792 --- [petties] [main] c.p.petties.controller.ClinicController  : Clinic image saved successfully for clinic: efbaeddd-c43d-4fc0-8448-e689cc2cc4f6
2025-12-25T11:34:17.092+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.094+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@61d150af]
2025-12-25T11:34:17.231+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getAllClinics(ClinicStatus, String, int, int, String, Direction)
2025-12-25T11:34:17.243+07:00  WARN 20792 --- [petties] [main] ration$PageModule$WarningLoggingModifier : Serializing PageImpl instances as-is is not supported, meaning that there is no guarantee about the stability of the resulting JSON structure!
	For a stable JSON structure, please use Spring Data's PagedModel (globally via @EnableSpringDataWebSupport(pageSerializationMode = VIA_DTO))
	or Spring HATEOAS and Spring Data's PagedResourcesAssembler as documented in https://docs.spring.io/spring-data/commons/reference/repositories/core-extensions.html#core.web.pageables.

2025-12-25T11:34:17.246+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.248+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing com.petties.petties.dto.clinic.ClinicResponse instances]
2025-12-25T11:34:17.275+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#uploadClinicLogo(UUID, MultipartFile)
2025-12-25T11:34:17.276+07:00  INFO 20792 --- [petties] [main] c.p.petties.controller.ClinicController  : Uploading logo for clinic: a1fa2041-ca31-4822-bc9f-434ae829d4a5, file size: 9, content type: image/jpeg
2025-12-25T11:34:17.278+07:00  INFO 20792 --- [petties] [main] c.p.petties.controller.ClinicController  : Logo uploaded to Cloudinary: url
2025-12-25T11:34:17.279+07:00  INFO 20792 --- [petties] [main] c.p.petties.controller.ClinicController  : Clinic logo saved successfully for clinic: a1fa2041-ca31-4822-bc9f-434ae829d4a5
2025-12-25T11:34:17.279+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.279+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@333efb51]
2025-12-25T11:34:17.294+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#findNearbyClinics(BigDecimal, BigDecimal, double, int, int)
2025-12-25T11:34:17.306+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.307+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing com.petties.petties.dto.clinic.ClinicResponse instances]
2025-12-25T11:34:17.340+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#createClinic(ClinicRequest)
2025-12-25T11:34:17.386+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinic.ClinicRequest@7253c53]
2025-12-25T11:34:17.500+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.500+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@48697181]
2025-12-25T11:34:17.511+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getClinicById(UUID)
2025-12-25T11:34:17.513+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.513+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@35fac3ba]
2025-12-25T11:34:17.526+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getAllClinics(ClinicStatus, String, int, int, String, Direction)
2025-12-25T11:34:17.530+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.531+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing UNKNOWN instances]
2025-12-25T11:34:17.542+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#searchClinics(String, int, int)
2025-12-25T11:34:17.547+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.547+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing com.petties.petties.dto.clinic.ClinicResponse instances]
2025-12-25T11:34:17.562+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#createClinic(ClinicRequest)
2025-12-25T11:34:17.563+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinic.ClinicRequest@7d0333c8]
2025-12-25T11:34:17.582+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:17.616+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.623+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:17.587564900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:17.635+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.clinic.ClinicResponse> com.petties.petties.controller.ClinicController.createClinic(com.petties.petties.dto.clinic.ClinicRequest): [Field error in object 'clinicRequest' on field 'name': rejected value []; codes [NotBlank.clinicRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicRequest.name,name]; arguments []; default message [name]]; default message [Tên phòng khám không được để trống]] ]
2025-12-25T11:34:17.646+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#approveClinic(UUID)
2025-12-25T11:34:17.649+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.649+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@3c9cfcde]
2025-12-25T11:34:17.672+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getClinicById(UUID)
2025-12-25T11:34:17.674+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-25T11:34:17.675+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.676+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:17.675402400, status=404, error=Not Found, message=Clinic n (truncated)...]
2025-12-25T11:34:17.677+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Clinic not found]
2025-12-25T11:34:17.687+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#updateClinic(UUID, ClinicRequest)
2025-12-25T11:34:17.690+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinic.ClinicRequest@3e4636c3]
2025-12-25T11:34:17.692+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T11:34:17.693+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/9df7f86b-c84a-45b0-b2cc-8f2ec8c4b922: You can only update your own clinic
2025-12-25T11:34:17.693+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.693+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:17.693494400, status=403, error=Forbidden, message=You can  (truncated)...]
2025-12-25T11:34:17.695+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: You can only update your own clinic]
2025-12-25T11:34:17.706+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#getAllClinics(ClinicStatus, String, int, int, String, Direction)
2025-12-25T11:34:17.708+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.708+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [Page 1 of 1 containing com.petties.petties.dto.clinic.ClinicResponse instances]
2025-12-25T11:34:17.725+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#rejectClinic(UUID, Map)
2025-12-25T11:34:17.728+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [{reason=Invalid information}]
2025-12-25T11:34:17.730+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.731+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@43cc7951]
2025-12-25T11:34:17.747+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#deleteClinic(UUID)
2025-12-25T11:34:17.750+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.751+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Clinic deleted successfully}]
2025-12-25T11:34:17.760+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicController#updateClinic(UUID, ClinicRequest)
2025-12-25T11:34:17.762+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinic.ClinicRequest@3911fec8]
2025-12-25T11:34:17.764+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:17.764+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinic.ClinicResponse@1e38e8b6]
2025-12-25T11:34:17.794+07:00  INFO 20792 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.AuthControllerUnitTest]: AuthControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-25T11:34:17.819+07:00  INFO 20792 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.AuthControllerUnitTest
2025-12-25T11:34:17.828+07:00  INFO 20792 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-25T11:34:17.881+07:00  INFO 20792 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Starting AuthControllerUnitTest using Java 21.0.9 with PID 20792 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-25T11:34:17.881+07:00 DEBUG 20792 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T11:34:17.882+07:00  INFO 20792 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-25T11:34:17.888+07:00 DEBUG 20792 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@7e741d6b
2025-12-25T11:34:18.409+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 14 mappings in 'requestMappingHandlerMapping'
2025-12-25T11:34:18.493+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T11:34:18.506+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T11:34:18.518+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T11:34:18.558+07:00  WARN 20792 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T11:34:18.559+07:00 DEBUG 20792 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T11:34:18.589+07:00 DEBUG 20792 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T11:34:18.607+07:00  INFO 20792 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T11:34:18.607+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T11:34:18.608+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-25T11:34:18.621+07:00  INFO 20792 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Started AuthControllerUnitTest in 0.794 seconds (process running for 8.434)
2025-12-25T11:34:18.638+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:18.649+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@70c99e13]
2025-12-25T11:34:18.706+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:18.714+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.715+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.706641200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:18.718+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [NotBlank.sendOtpRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password]]; default message [Mật khẩu không được để trống]] [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] ]
2025-12-25T11:34:18.742+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T11:34:18.746+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@4eb3b690]
2025-12-25T11:34:18.751+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:18.753+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.753+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.752466400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:18.755+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [1234567]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-25T11:34:18.772+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:18.778+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@1454339d]
2025-12-25T11:34:18.792+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:18.793+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.793+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.792670600, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-25T11:34:18.795+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-25T11:34:18.809+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T11:34:18.811+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@1be3e952]
2025-12-25T11:34:18.819+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.819+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@4d73d3d1]
2025-12-25T11:34:18.832+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T11:34:18.833+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@3c39c739]
2025-12-25T11:34:18.838+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.838+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@8cd2bb5]
2025-12-25T11:34:18.857+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T11:34:18.858+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@238d27ef]
2025-12-25T11:34:18.860+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:18.860+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.860+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.860328800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:18.861+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value [null]; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-25T11:34:18.873+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:18.875+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@57859e2c]
2025-12-25T11:34:18.878+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:18.880+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.880+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.880331200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:18.882+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [NotBlank.resetPasswordRequest.newPassword,NotBlank.newPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword]]; default message [Mật khẩu mới không được để trống]] [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-25T11:34:18.890+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:18.892+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@3545c913]
2025-12-25T11:34:18.894+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:18.896+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.896+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.895996100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:18.899+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [NotBlank.resetPasswordRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@2ced7cf,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-25T11:34:18.907+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T11:34:18.909+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@2f408960]
2025-12-25T11:34:18.912+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:18.913+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.913+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.912029600, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-25T11:34:18.914+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-25T11:34:18.924+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-25T11:34:18.927+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.927+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@439b0198]
2025-12-25T11:34:18.940+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-25T11:34:18.942+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:18.942+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.942+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.942257100, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-25T11:34:18.943+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-25T11:34:18.953+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:18.954+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@61d4155b]
2025-12-25T11:34:18.956+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.957+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.MessageResponse@48590849]
2025-12-25T11:34:18.969+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T11:34:18.970+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@938e54a]
2025-12-25T11:34:18.971+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:18.972+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.972+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.971442600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:18.972+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value []; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-25T11:34:18.982+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:18.983+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@5006a697]
2025-12-25T11:34:18.985+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:18.985+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.986+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.985140, status=400, error=Validation Failed, message=Ema (truncated)...]
2025-12-25T11:34:18.986+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value []; codes [NotBlank.resetPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-25T11:34:18.993+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T11:34:18.995+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@aaf4375]
2025-12-25T11:34:18.998+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:18.998+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:18.999+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:18.998326500, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-25T11:34:18.999+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-25T11:34:19.011+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T11:34:19.013+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@62f3ad90]
2025-12-25T11:34:19.015+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.016+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@18d63996]
2025-12-25T11:34:19.025+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:19.026+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@1c000c2f]
2025-12-25T11:34:19.029+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.030+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.030+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.029077300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.031+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value [Pass1]; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-25T11:34:19.039+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:19.041+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@308e465b]
2025-12-25T11:34:19.044+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.046+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.047+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.046121900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.048+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.resetPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@2b0d818d,.*]; default message [Email không đúng định dạng]] ]
2025-12-25T11:34:19.058+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:19.059+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@4f3b11e6]
2025-12-25T11:34:19.061+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.062+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.062+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.062130300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.062+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value []; codes [NotBlank.sendOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-25T11:34:19.073+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:19.074+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@cef23a8]
2025-12-25T11:34:19.076+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:19.076+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.077+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.076210900, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T11:34:19.077+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email already exists]
2025-12-25T11:34:19.088+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:19.089+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@a1689e8]
2025-12-25T11:34:19.090+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.090+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@4bb644dc]
2025-12-25T11:34:19.102+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-25T11:34:19.103+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:19.103+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.103+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.103791800, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-25T11:34:19.105+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending password reset found]
2025-12-25T11:34:19.113+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:19.114+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@78a7fccd]
2025-12-25T11:34:19.117+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.117+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.118+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.117317800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.118+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'username': rejected value [ab]; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] ]
2025-12-25T11:34:19.125+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-25T11:34:19.128+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:19.129+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.129+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.128345600, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-25T11:34:19.129+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-25T11:34:19.137+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T11:34:19.138+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@5b01b3f8]
2025-12-25T11:34:19.141+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:19.142+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /auth/google: Invalid Google ID token
2025-12-25T11:34:19.143+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.143+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.142008900, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-25T11:34:19.143+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid Google ID token]
2025-12-25T11:34:19.156+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-25T11:34:19.157+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@5ee76cf2]
2025-12-25T11:34:19.161+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:19.162+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.163+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.162239400, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T11:34:19.163+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email not found]
2025-12-25T11:34:19.170+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-25T11:34:19.170+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@682482ee]
2025-12-25T11:34:19.172+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.172+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.173+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.172976, status=400, error=Validation Failed, message=Ema (truncated)...]
2025-12-25T11:34:19.177+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.forgotPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@2b0d818d,.*]; default message [Email không đúng định dạng]] ]
2025-12-25T11:34:19.196+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:19.199+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@1f3f0d25]
2025-12-25T11:34:19.200+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.200+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.202+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.200674600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.203+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value [abc123]; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@2ced7cf,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-25T11:34:19.212+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T11:34:19.213+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@32029cd]
2025-12-25T11:34:19.215+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.216+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.217+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.216873800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.219+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [12345]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-25T11:34:19.226+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:19.228+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@24d7c365]
2025-12-25T11:34:19.229+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.229+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.229+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.229437300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.230+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [NotBlank.sendOtpRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username]]; default message [Tên đăng nhập không được để trống]] [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] ]
2025-12-25T11:34:19.255+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-25T11:34:19.257+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:19.257+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.258+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.257071200, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-25T11:34:19.260+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending registration found]
2025-12-25T11:34:19.267+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T11:34:19.268+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@434a2a10]
2025-12-25T11:34:19.269+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.270+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.271+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.269880500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.271+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value []; codes [NotBlank.verifyOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-25T11:34:19.279+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T11:34:19.280+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@5de14222]
2025-12-25T11:34:19.283+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.283+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.284+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.283666700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.284+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'idToken': rejected value []; codes [NotBlank.googleSignInRequest.idToken,NotBlank.idToken,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.idToken,idToken]; arguments []; default message [idToken]]; default message [ID token is required]] ]
2025-12-25T11:34:19.298+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:19.299+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@134ec0f3]
2025-12-25T11:34:19.301+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.302+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.302+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.302146400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.304+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'confirmPassword': rejected value []; codes [NotBlank.resetPasswordRequest.confirmPassword,NotBlank.confirmPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.confirmPassword,confirmPassword]; arguments []; default message [confirmPassword]]; default message [Xác nhận mật khẩu không được để trống]] ]
2025-12-25T11:34:19.314+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:19.315+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@58a0f75b]
2025-12-25T11:34:19.317+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.317+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.317+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.317884400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.319+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'fullName': rejected value []; codes [NotBlank.sendOtpRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-25T11:34:19.326+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-25T11:34:19.327+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@1e1d813a]
2025-12-25T11:34:19.328+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.329+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@1964ef9]
2025-12-25T11:34:19.336+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:19.337+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@7925e772]
2025-12-25T11:34:19.338+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.339+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.339+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.339198500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.340+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'password': rejected value [12345]; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] ]
2025-12-25T11:34:19.350+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T11:34:19.352+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@44c54463]
2025-12-25T11:34:19.353+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.353+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.353+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.353238400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.354+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value [null]; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-25T11:34:19.367+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T11:34:19.373+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@1f596988]
2025-12-25T11:34:19.394+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.395+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.396+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.395091900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.399+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest) with 2 errors: [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [NotBlank.verifyOtpRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] ]
2025-12-25T11:34:19.410+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T11:34:19.411+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@30ce78e3]
2025-12-25T11:34:19.413+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.414+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@41041c31]
2025-12-25T11:34:19.422+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T11:34:19.424+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@8bd9d08]
2025-12-25T11:34:19.425+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.426+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.427+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.425861500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.428+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value []; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-25T11:34:19.437+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T11:34:19.437+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@6c120b00]
2025-12-25T11:34:19.440+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.440+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@d8a2b1b]
2025-12-25T11:34:19.453+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T11:34:19.453+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@1390a43a]
2025-12-25T11:34:19.456+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.456+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@7bf2e475]
2025-12-25T11:34:19.465+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T11:34:19.465+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@4f2b1a2f]
2025-12-25T11:34:19.467+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.467+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@6c2a33af]
2025-12-25T11:34:19.473+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-25T11:34:19.474+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@6e5df971]
2025-12-25T11:34:19.475+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.477+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.477+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.476560300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.478+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value []; codes [NotBlank.forgotPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-25T11:34:19.486+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-25T11:34:19.487+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@46f041cb]
2025-12-25T11:34:19.490+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:19.490+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /auth/login: Invalid username or password
2025-12-25T11:34:19.490+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.490+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.490592800, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-25T11:34:19.490+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid username or password]
2025-12-25T11:34:19.497+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-25T11:34:19.498+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.499+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@642b71d6]
2025-12-25T11:34:19.507+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-25T11:34:19.508+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@258291de]
2025-12-25T11:34:19.509+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.509+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.509+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.509091300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.510+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'platform': rejected value []; codes [NotBlank.googleSignInRequest.platform,NotBlank.platform,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.platform,platform]; arguments []; default message [platform]]; default message [Platform is required]] ]
2025-12-25T11:34:19.515+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:19.517+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@5625e7e1]
2025-12-25T11:34:19.518+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:19.518+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.518+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.518071200, status=400, error=Bad Request, message=Passwo (truncated)...]
2025-12-25T11:34:19.519+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Passwords do not match]
2025-12-25T11:34:19.524+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:19.525+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@23307c6c]
2025-12-25T11:34:19.527+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.527+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.527+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.527255500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.528+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'role': rejected value [null]; codes [NotNull.sendOtpRequest.role,NotNull.role,NotNull.com.petties.petties.model.enums.Role,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.role,role]; arguments []; default message [role]]; default message [Vai trò không được để trống]] ]
2025-12-25T11:34:19.534+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-25T11:34:19.534+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@33cec966]
2025-12-25T11:34:19.536+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.537+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.537+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.537667600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.538+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.sendOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@2b0d818d,.*]; default message [Email không hợp lệ]] ]
2025-12-25T11:34:19.544+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-25T11:34:19.544+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@2330c995]
2025-12-25T11:34:19.546+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:19.547+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.547+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.547866600, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-25T11:34:19.548+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-25T11:34:19.554+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-25T11:34:19.554+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@20dc763b]
2025-12-25T11:34:19.555+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:19.555+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:19.555+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:19.555308800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:19.558+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.verifyOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@2b0d818d,.*]; default message [Email không hợp lệ]] ]
2025-12-25T11:34:19.573+07:00  INFO 20792 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.UserControllerUnitTest]: UserControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-25T11:34:19.590+07:00  INFO 20792 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.UserControllerUnitTest
2025-12-25T11:34:19.596+07:00  INFO 20792 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-25T11:34:19.636+07:00  INFO 20792 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Starting UserControllerUnitTest using Java 21.0.9 with PID 20792 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-25T11:34:19.636+07:00 DEBUG 20792 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T11:34:19.636+07:00  INFO 20792 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-25T11:34:19.640+07:00 DEBUG 20792 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@27d44578
2025-12-25T11:34:20.253+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-25T11:34:20.346+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T11:34:20.360+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T11:34:20.370+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T11:34:20.419+07:00  WARN 20792 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T11:34:20.419+07:00 DEBUG 20792 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T11:34:20.438+07:00 DEBUG 20792 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T11:34:20.453+07:00  INFO 20792 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T11:34:20.453+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T11:34:20.457+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 4 ms
2025-12-25T11:34:20.478+07:00  INFO 20792 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Started UserControllerUnitTest in 0.882 seconds (process running for 10.292)
2025-12-25T11:34:20.497+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.500+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=12345)]
2025-12-25T11:34:20.522+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.527+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.527+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.522522200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:20.528+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [12345]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2ced7cf,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-25T11:34:20.540+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-25T11:34:20.542+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@3f8c4bcf]
2025-12-25T11:34:20.546+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.547+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.547+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.546541400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:20.548+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'phone': rejected value [not-a-number]; codes [Pattern.updateProfileRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@2ced7cf,^0\d{9,10}$]; default message [Số điện thoại không hợp lệ (10-11 số, bắt đầu bằng 0)]] ]
2025-12-25T11:34:20.553+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-25T11:34:20.553+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@5529fd4e]
2025-12-25T11:34:20.555+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.556+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.556+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.555859800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:20.557+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'fullName': rejected value []; codes [Size.updateProfileRequest.fullName,Size.fullName,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.fullName,fullName]; arguments []; default message [fullName],100,2]; default message [Họ tên phải từ 2-100 ký tự]] ]
2025-12-25T11:34:20.567+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-25T11:34:20.582+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.583+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@3181fbe7]
2025-12-25T11:34:20.592+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-25T11:34:20.594+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.594+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@4cce889e]
2025-12-25T11:34:20.603+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T11:34:20.604+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:20.604+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/email/resend-otp: User not authenticated
2025-12-25T11:34:20.604+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.604+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.604904900, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T11:34:20.605+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T11:34:20.616+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-25T11:34:20.616+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:20.616+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile: User not authenticated
2025-12-25T11:34:20.617+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.617+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.617968, status=401, error=Unauthorized, message=User not (truncated)...]
2025-12-25T11:34:20.617+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T11:34:20.626+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T11:34:20.630+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=)]
2025-12-25T11:34:20.635+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.636+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.636+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.635944300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:20.637+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-25T11:34:20.644+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.645+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=1234567)]
2025-12-25T11:34:20.646+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.646+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.648+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.646681, status=400, error=Validation Failed, message=Ma  (truncated)...]
2025-12-25T11:34:20.649+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [1234567]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2ced7cf,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-25T11:34:20.660+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-25T11:34:20.662+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@475753dd]
2025-12-25T11:34:20.666+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.668+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.668+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.667708400, status=400, error=Bad Request, message=Mật kh (truncated)...]
2025-12-25T11:34:20.668+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Mật khẩu hiện tại không chính xác]
2025-12-25T11:34:20.679+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T11:34:20.680+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=not-an-email)]
2025-12-25T11:34:20.681+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.682+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.682+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.682826300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:20.683+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@2b0d818d,.*]; default message [Email khong hop le]] ]
2025-12-25T11:34:20.691+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-25T11:34:20.693+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@30b2d267]
2025-12-25T11:34:20.695+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.696+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Doi mat khau thanh cong}]
2025-12-25T11:34:20.706+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-25T11:34:20.708+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.708+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@624baf71]
2025-12-25T11:34:20.716+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.716+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=)]
2025-12-25T11:34:20.719+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.719+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.720+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.719498700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:20.720+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest) with 2 errors: [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [NotBlank.emailChangeVerifyRequest.otp,NotBlank.otp,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp]]; default message [Ma OTP khong duoc de trong]] [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2ced7cf,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-25T11:34:20.729+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-25T11:34:20.733+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.733+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.733+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.733364, status=400, error=Bad Request, message=File is e (truncated)...]
2025-12-25T11:34:20.734+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: File is empty]
2025-12-25T11:34:20.739+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.741+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=not-an-email, otp=123456)]
2025-12-25T11:34:20.742+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.742+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.742+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.742974600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:20.742+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeVerifyRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@2b0d818d,.*]; default message [Email khong hop le]] ]
2025-12-25T11:34:20.750+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-25T11:34:20.751+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@17a756db]
2025-12-25T11:34:20.753+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:20.753+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile: User not authenticated
2025-12-25T11:34:20.754+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.754+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.753502600, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T11:34:20.754+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T11:34:20.762+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T11:34:20.763+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-25T11:34:20.764+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.765+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=OTP da duoc gui den email moi}]
2025-12-25T11:34:20.774+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-25T11:34:20.775+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:20.775+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/avatar: User not authenticated
2025-12-25T11:34:20.775+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.775+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.775756700, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T11:34:20.777+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T11:34:20.784+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T11:34:20.785+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.785+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.785+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.785938600, status=400, error=Bad Request, message=Khong  (truncated)...]
2025-12-25T11:34:20.787+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Khong co yeu cau thay doi email. Vui long tao yeu cau moi.]
2025-12-25T11:34:20.796+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T11:34:20.797+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=test@example.com)]
2025-12-25T11:34:20.799+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.800+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.800+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.799756400, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T11:34:20.800+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi phai khac email hien tai]
2025-12-25T11:34:20.809+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T11:34:20.810+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-25T11:34:20.813+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:20.814+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/email/request-change: User not authenticated
2025-12-25T11:34:20.815+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.816+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.814524100, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T11:34:20.817+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T11:34:20.827+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-25T11:34:20.827+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@7e474bd]
2025-12-25T11:34:20.829+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.829+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@324ee3ca]
2025-12-25T11:34:20.837+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T11:34:20.838+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-25T11:34:20.839+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.839+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.840+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.839422800, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-25T11:34:20.840+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 45 giay truoc khi gui lai ma OTP]
2025-12-25T11:34:20.846+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.847+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-25T11:34:20.850+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.851+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.851+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.851113300, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-25T11:34:20.851+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong chinh xac hoac da het han]
2025-12-25T11:34:20.860+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T11:34:20.860+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.861+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Ma OTP moi da duoc gui den email moi}]
2025-12-25T11:34:20.868+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.869+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-25T11:34:20.871+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.871+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.872+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.871667600, status=400, error=Bad Request, message=Ban da (truncated)...]
2025-12-25T11:34:20.872+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ban da nhap sai ma OTP qua nhieu lan. Vui long yeu cau gui ma OTP moi.]
2025-12-25T11:34:20.878+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.880+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=, otp=123456)]
2025-12-25T11:34:20.881+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.881+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.881+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.881010300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:20.882+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeVerifyRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-25T11:34:20.889+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.890+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=different@example.com, otp=123456)]
2025-12-25T11:34:20.891+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.892+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.892+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.892216700, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T11:34:20.892+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi khong khop voi yeu cau truoc do]
2025-12-25T11:34:20.901+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-25T11:34:20.902+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=existing@example.com)]
2025-12-25T11:34:20.904+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.905+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.905+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.905544900, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T11:34:20.905+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-25T11:34:20.915+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.915+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-25T11:34:20.917+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.918+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@6d92bfaf]
2025-12-25T11:34:20.925+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.925+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-25T11:34:20.927+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.928+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.928+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.928305500, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-25T11:34:20.929+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong dung. Ban con 4 lan thu.]
2025-12-25T11:34:20.936+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-25T11:34:20.937+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:20.938+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/avatar: User not authenticated
2025-12-25T11:34:20.938+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.938+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.938056100, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T11:34:20.938+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T11:34:20.946+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T11:34:20.947+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.947+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.947+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.947205500, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-25T11:34:20.947+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 30 giay truoc khi gui lai ma OTP]
2025-12-25T11:34:20.953+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.955+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=abc123)]
2025-12-25T11:34:20.955+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:20.956+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.956+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.956803600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:20.958+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [abc123]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2ced7cf,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-25T11:34:20.964+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-25T11:34:20.964+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@276e5add]
2025-12-25T11:34:20.966+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:20.966+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/password: User not authenticated
2025-12-25T11:34:20.967+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.967+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.967466300, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T11:34:20.968+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T11:34:20.974+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-25T11:34:20.975+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.976+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.977+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.976918800, status=400, error=Bad Request, message=User n (truncated)...]
2025-12-25T11:34:20.977+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: User not found]
2025-12-25T11:34:20.984+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-25T11:34:20.985+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-25T11:34:20.985+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.985+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.985700200, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-25T11:34:20.986+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-25T11:34:20.993+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-25T11:34:20.994+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-25T11:34:20.995+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-25T11:34:20.996+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /users/profile/email/verify-change: User not authenticated
2025-12-25T11:34:20.996+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:20.996+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:20.996532100, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-25T11:34:20.997+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-25T11:34:21.012+07:00  INFO 20792 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.ClinicServiceControllerUnitTest]: ClinicServiceControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-25T11:34:21.031+07:00  INFO 20792 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.ClinicServiceControllerUnitTest
2025-12-25T11:34:21.037+07:00  INFO 20792 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-25T11:34:21.077+07:00  INFO 20792 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Starting ClinicServiceControllerUnitTest using Java 21.0.9 with PID 20792 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-25T11:34:21.078+07:00 DEBUG 20792 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T11:34:21.078+07:00  INFO 20792 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-25T11:34:21.083+07:00 DEBUG 20792 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@2ed9e59b
2025-12-25T11:34:21.425+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-25T11:34:21.459+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T11:34:21.465+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T11:34:21.472+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T11:34:21.512+07:00  WARN 20792 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T11:34:21.512+07:00 DEBUG 20792 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T11:34:21.526+07:00 DEBUG 20792 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T11:34:21.536+07:00  INFO 20792 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T11:34:21.536+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T11:34:21.536+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-12-25T11:34:21.544+07:00  INFO 20792 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Started ClinicServiceControllerUnitTest in 0.507 seconds (process running for 11.358)
2025-12-25T11:34:21.555+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#deleteService(UUID)
2025-12-25T11:34:21.556+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:21.558+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-25T11:34:21.579+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-25T11:34:21.588+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@57e6f449]
2025-12-25T11:34:21.602+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:21.602+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@7e32442d]
2025-12-25T11:34:21.614+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-25T11:34:21.615+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:21.616+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@45da40ad]
2025-12-25T11:34:21.624+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-25T11:34:21.627+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@54b3407b]
2025-12-25T11:34:21.632+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:21.633+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@4efb7c99]
2025-12-25T11:34:21.640+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getAllServices()
2025-12-25T11:34:21.642+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:21.643+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[com.petties.petties.dto.clinicService.ClinicServiceResponse@434c179e]]
2025-12-25T11:34:21.653+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-25T11:34:21.655+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-25T11:34:21.658+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:21.660+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:21.655336300, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-25T11:34:21.660+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-25T11:34:21.664+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-25T11:34:21.666+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@45c8db36]
2025-12-25T11:34:21.668+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:21.668+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:21.668+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:21.668398600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:21.671+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.clinicService.ClinicServiceResponse> com.petties.petties.controller.ClinicServiceController.createService(com.petties.petties.dto.clinicService.ClinicServiceRequest) with 3 errors: [Field error in object 'clinicServiceRequest' on field 'slotsRequired': rejected value [null]; codes [NotNull.clinicServiceRequest.slotsRequired,NotNull.slotsRequired,NotNull.java.lang.Integer,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.slotsRequired,slotsRequired]; arguments []; default message [slotsRequired]]; default message [Số slot yêu cầu không được để trống]] [Field error in object 'clinicServiceRequest' on field 'name': rejected value [null]; codes [NotBlank.clinicServiceRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.name,name]; arguments []; default message [name]]; default message [Tên dịch vụ không được để trống]] [Field error in object 'clinicServiceRequest' on field 'basePrice': rejected value [null]; codes [NotNull.clinicServiceRequest.basePrice,NotNull.basePrice,NotNull.java.math.BigDecimal,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.basePrice,basePrice]; arguments []; default message [basePrice]]; default message [Giá cơ bản không được để trống]] ]
2025-12-25T11:34:21.682+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-25T11:34:21.685+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:21.687+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@16124894]
2025-12-25T11:34:21.699+07:00  INFO 20792 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.ClinicStaffControllerUnitTest]: ClinicStaffControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-25T11:34:21.728+07:00  INFO 20792 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.ClinicStaffControllerUnitTest
2025-12-25T11:34:21.732+07:00  INFO 20792 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-25T11:34:21.767+07:00  INFO 20792 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 20792 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-25T11:34:21.767+07:00 DEBUG 20792 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T11:34:21.767+07:00  INFO 20792 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-25T11:34:21.771+07:00 DEBUG 20792 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@18e4bbec
2025-12-25T11:34:22.075+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 7 mappings in 'requestMappingHandlerMapping'
2025-12-25T11:34:22.160+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T11:34:22.166+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T11:34:22.174+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T11:34:22.192+07:00  WARN 20792 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T11:34:22.192+07:00 DEBUG 20792 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T11:34:22.207+07:00 DEBUG 20792 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T11:34:22.221+07:00  INFO 20792 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T11:34:22.221+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T11:34:22.222+07:00  INFO 20792 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-25T11:34:22.233+07:00  INFO 20792 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 0.5 seconds (process running for 12.046)
2025-12-25T11:34:22.245+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T11:34:22.250+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=, phone=0912345678, role=VET)]
2025-12-25T11:34:22.257+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:22.262+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:22.262+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:22.257424600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:22.264+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'fullName': rejected value []; codes [NotBlank.quickAddStaffRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-25T11:34:22.277+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T11:34:22.278+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Duplicate User, phone=0987654321, role=VET)]
2025-12-25T11:34:22.280+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceAlreadyExists(ResourceAlreadyExistsException, HttpServletRequest)
2025-12-25T11:34:22.280+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:22.281+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:22.280956400, status=409, error=Conflict, message=Số điện t (truncated)...]
2025-12-25T11:34:22.281+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceAlreadyExistsException: Số điện thoại này đã được đăng ký tài khoản]
2025-12-25T11:34:22.290+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-25T11:34:22.294+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:22.297+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=d2208d83-6457-47b4-afb0-b0e96b559b82, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-25T11:34:22.311+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T11:34:22.311+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Fake Admin, phone=0912345678, role=ADMIN)]
2025-12-25T11:34:22.312+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T11:34:22.313+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/ea65e70b-a804-4b30-8360-d729059ef018/staff/quick-add: Không thể tạo tài khoản ADMIN qua chức năng này
2025-12-25T11:34:22.313+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:22.314+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:22.313731400, status=403, error=Forbidden, message=Không th (truncated)...]
2025-12-25T11:34:22.314+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Không thể tạo tài khoản ADMIN qua chức năng này]
2025-12-25T11:34:22.320+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T11:34:22.325+07:00 DEBUG 20792 --- [petties] [main] o.s.web.method.HandlerMethod             : Could not resolve parameter [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]
2025-12-25T11:34:22.325+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleHttpMessageNotReadable(HttpMessageNotReadableException, HttpServletRequest)
2025-12-25T11:34:22.325+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:22.325+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:22.325839900, status=400, error=Bad Request, message=Dữ liệ (truncated)...]
2025-12-25T11:34:22.327+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]]
2025-12-25T11:34:22.331+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-25T11:34:22.335+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-25T11:34:22.335+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-25T11:34:22.346+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T11:34:22.348+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Tester, phone=123, role=VET)]
2025-12-25T11:34:22.349+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T11:34:22.349+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:22.349+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:22.349158200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T11:34:22.349+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'phone': rejected value [123]; codes [Pattern.quickAddStaffRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@2ced7cf,^[0-9]{10,11}$]; default message [Số điện thoại không hợp lệ]] ]
2025-12-25T11:34:22.355+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-25T11:34:22.359+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-25T11:34:22.359+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-25T11:34:22.384+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-25T11:34:22.387+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-25T11:34:22.387+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:22.387+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:22.387326600, status=404, error=Not Found, message=User not (truncated)...]
2025-12-25T11:34:22.388+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: User not found]
2025-12-25T11:34:22.393+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T11:34:22.394+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-25T11:34:22.396+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-25T11:34:22.396+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-25T11:34:22.402+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignVet(UUID, String)
2025-12-25T11:34:22.403+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T11:34:22.403+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/4b13411a-5a5c-40c4-b72f-ad5b8e91a1ed/staff/vet/vet@test.com: Bạn không có quyền quản lý phòng khám này
2025-12-25T11:34:22.404+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:22.404+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:22.404240900, status=403, error=Forbidden, message=Bạn khôn (truncated)...]
2025-12-25T11:34:22.404+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Bạn không có quyền quản lý phòng khám này]
2025-12-25T11:34:22.411+07:00 DEBUG 20792 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T11:34:22.411+07:00 DEBUG 20792 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-25T11:34:22.412+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T11:34:22.412+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/75bd896e-ebb9-4104-afcd-6ba28f08c811/staff/quick-add: Quản lý phòng khám chỉ có quyền thêm Bác sĩ
2025-12-25T11:34:22.413+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T11:34:22.414+07:00 DEBUG 20792 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T11:34:22.413862900, status=403, error=Forbidden, message=Quản lý  (truncated)...]
2025-12-25T11:34:22.414+07:00 DEBUG 20792 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Quản lý phòng khám chỉ có quyền thêm Bác sĩ]
2025-12-25T11:34:22.578+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Access Denied to /api/v1/test: Access is denied
2025-12-25T11:34:22.647+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Access Denied to /api/v1/test: Access denied
2025-12-25T11:34:22.652+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Authentication failed at /api/v1/test: Full authentication required
2025-12-25T11:34:22.656+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Authentication failed at /api/v1/test: null
2025-12-25T11:34:22.660+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Bad credentials attempt at /api/v1/test
2025-12-25T11:34:22.662+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Bad credentials attempt at /api/v1/test
2025-12-25T11:34:22.682+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test: Forbidden
2025-12-25T11:34:22.686+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test: 
2025-12-25T11:34:22.688+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test: null
2025-12-25T11:34:22.692+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test:    
2025-12-25T11:34:22.694+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /api/v1/test: Ban khong co quyen xem tai nguyen nay
2025-12-25T11:34:22.699+07:00 ERROR 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unexpected error occurred at /api/v1/test: 

java.lang.RuntimeException: Some unexpected error
	at com.petties.petties.exception.GlobalExceptionHandlerTest$GenericExceptionTests.handleGenericException_ShouldReturn500Status(GlobalExceptionHandlerTest.java:125) ~[test-classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767) ~[junit-platform-commons-1.11.3.jar:1.11.3]
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:94) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:70) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:100) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:40) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:520) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:748) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:443) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:211) ~[.cp/:na]

2025-12-25T11:34:22.709+07:00 ERROR 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unexpected error occurred at /api/v1/test: 

java.lang.Exception: Unexpected error
	at com.petties.petties.exception.GlobalExceptionHandlerTest$GenericExceptionTests.handleGenericException_ShouldReturnVietnameseMessage(GlobalExceptionHandlerTest.java:108) ~[test-classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767) ~[junit-platform-commons-1.11.3.jar:1.11.3]
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.11.3.jar:5.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:94) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:52) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:70) ~[junit-platform-launcher-1.11.3.jar:1.11.3]
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:100) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:40) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:520) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:748) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:443) ~[.cp/:na]
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:211) ~[.cp/:na]

2025-12-25T11:34:22.917+07:00  WARN 20792 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Unauthorized access to /api/v1/test: Chua xac thuc
2025-12-25T11:34:23.121+07:00 DEBUG 20792 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@63429932, started on Thu Dec 25 11:34:12 ICT 2025
2025-12-25T11:34:23.127+07:00 DEBUG 20792 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@7e741d6b, started on Thu Dec 25 11:34:17 ICT 2025
2025-12-25T11:34:23.131+07:00 DEBUG 20792 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@27d44578, started on Thu Dec 25 11:34:19 ICT 2025
2025-12-25T11:34:23.133+07:00 DEBUG 20792 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@2ed9e59b, started on Thu Dec 25 11:34:21 ICT 2025
2025-12-25T11:34:23.135+07:00 DEBUG 20792 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@18e4bbec, started on Thu Dec 25 11:34:21 ICT 2025
2025-12-25T18:57:03.220+07:00  INFO 21104 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 21104 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-25T18:57:03.223+07:00 DEBUG 21104 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-25T18:57:03.224+07:00  INFO 21104 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-25T18:57:03.255+07:00 DEBUG 21104 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@332f25c8
2025-12-25T18:57:08.094+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 8 mappings in 'requestMappingHandlerMapping'
2025-12-25T18:57:08.386+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-25T18:57:08.707+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-25T18:57:08.825+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-25T18:57:09.020+07:00  WARN 21104 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-25T18:57:09.021+07:00 DEBUG 21104 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-25T18:57:09.254+07:00 DEBUG 21104 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-25T18:57:09.465+07:00  INFO 21104 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-25T18:57:09.467+07:00  INFO 21104 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-25T18:57:09.475+07:00  INFO 21104 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 8 ms
2025-12-25T18:57:09.548+07:00  INFO 21104 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 7.07 seconds (process running for 9.285)
2025-12-25T18:57:09.872+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T18:57:10.014+07:00 DEBUG 21104 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=, phone=0912345678, role=VET)]
2025-12-25T18:57:10.186+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T18:57:10.223+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T18:57:10.233+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T18:57:10.190088600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T18:57:10.253+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'fullName': rejected value []; codes [NotBlank.quickAddStaffRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-25T18:57:10.558+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T18:57:10.559+07:00 DEBUG 21104 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Duplicate User, phone=0987654321, role=VET)]
2025-12-25T18:57:10.572+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceAlreadyExists(ResourceAlreadyExistsException, HttpServletRequest)
2025-12-25T18:57:10.573+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T18:57:10.575+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T18:57:10.573371, status=409, error=Conflict, message=Số điện thoạ (truncated)...]
2025-12-25T18:57:10.576+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceAlreadyExistsException: Số điện thoại này đã được đăng ký tài khoản]
2025-12-25T18:57:10.630+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-25T18:57:10.647+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T18:57:10.652+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=48aa6c9b-1903-40af-80ef-f421778b3e84, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-25T18:57:10.698+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T18:57:10.700+07:00 DEBUG 21104 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Fake Admin, phone=0912345678, role=ADMIN)]
2025-12-25T18:57:10.704+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T18:57:10.704+07:00  WARN 21104 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/080f88c2-e883-409e-8466-519b3114f848/staff/quick-add: Không thể tạo tài khoản ADMIN qua chức năng này
2025-12-25T18:57:10.710+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T18:57:10.711+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T18:57:10.709403300, status=403, error=Forbidden, message=Không th (truncated)...]
2025-12-25T18:57:10.712+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Không thể tạo tài khoản ADMIN qua chức năng này]
2025-12-25T18:57:10.726+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T18:57:10.738+07:00 DEBUG 21104 --- [petties] [main] o.s.web.method.HandlerMethod             : Could not resolve parameter [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]
2025-12-25T18:57:10.739+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleHttpMessageNotReadable(HttpMessageNotReadableException, HttpServletRequest)
2025-12-25T18:57:10.740+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T18:57:10.740+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T18:57:10.739522600, status=400, error=Bad Request, message=Dữ liệ (truncated)...]
2025-12-25T18:57:10.741+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]]
2025-12-25T18:57:10.766+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-25T18:57:10.770+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-25T18:57:10.770+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-25T18:57:10.790+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T18:57:10.791+07:00 DEBUG 21104 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Tester, phone=123, role=VET)]
2025-12-25T18:57:10.800+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-25T18:57:10.801+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T18:57:10.802+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T18:57:10.801383500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-25T18:57:10.803+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'phone': rejected value [123]; codes [Pattern.quickAddStaffRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@54e680fe,^[0-9]{10,11}$]; default message [Số điện thoại không hợp lệ]] ]
2025-12-25T18:57:10.819+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-25T18:57:10.832+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-25T18:57:10.832+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-25T18:57:10.887+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-25T18:57:10.889+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-25T18:57:10.890+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T18:57:10.890+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T18:57:10.890650, status=404, error=Not Found, message=User not fo (truncated)...]
2025-12-25T18:57:10.892+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: User not found]
2025-12-25T18:57:10.909+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T18:57:10.911+07:00 DEBUG 21104 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-25T18:57:10.913+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-25T18:57:10.914+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-25T18:57:10.939+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignVet(UUID, String)
2025-12-25T18:57:10.943+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T18:57:10.944+07:00  WARN 21104 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/55657af4-e169-4b80-bfee-eb72795fc2d4/staff/vet/vet@test.com: Bạn không có quyền quản lý phòng khám này
2025-12-25T18:57:10.945+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T18:57:10.946+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T18:57:10.945359700, status=403, error=Forbidden, message=Bạn khôn (truncated)...]
2025-12-25T18:57:10.946+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Bạn không có quyền quản lý phòng khám này]
2025-12-25T18:57:10.966+07:00 DEBUG 21104 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-25T18:57:10.968+07:00 DEBUG 21104 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-25T18:57:10.970+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-25T18:57:10.971+07:00  WARN 21104 --- [petties] [main] c.p.p.exception.GlobalExceptionHandler   : Forbidden access to /clinics/8e50bd3a-cf0b-49ba-a9d1-bbd801a3c37c/staff/quick-add: Quản lý phòng khám chỉ có quyền thêm Bác sĩ
2025-12-25T18:57:10.971+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-25T18:57:10.971+07:00 DEBUG 21104 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-25T18:57:10.971064400, status=403, error=Forbidden, message=Quản lý  (truncated)...]
2025-12-25T18:57:10.972+07:00 DEBUG 21104 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Quản lý phòng khám chỉ có quyền thêm Bác sĩ]
2025-12-25T18:57:11.059+07:00 DEBUG 21104 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@332f25c8, started on Thu Dec 25 18:57:03 ICT 2025
