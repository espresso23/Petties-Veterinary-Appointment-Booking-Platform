2025-12-24T10:19:17.000+07:00  INFO 26764 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 26764 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T10:19:17.024+07:00 DEBUG 26764 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T10:19:17.025+07:00  INFO 26764 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-24T10:19:17.084+07:00 DEBUG 26764 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@4a1c0752
2025-12-24T10:19:21.151+07:00 DEBUG 26764 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 7 mappings in 'requestMappingHandlerMapping'
2025-12-24T10:19:21.488+07:00 DEBUG 26764 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T10:19:21.807+07:00 DEBUG 26764 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T10:19:21.916+07:00 DEBUG 26764 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T10:19:22.345+07:00  WARN 26764 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T10:19:22.346+07:00 DEBUG 26764 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T10:19:22.698+07:00 DEBUG 26764 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T10:19:22.848+07:00  INFO 26764 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T10:19:22.848+07:00  INFO 26764 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T10:19:22.850+07:00  INFO 26764 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 2 ms
2025-12-24T10:19:22.932+07:00  INFO 26764 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 7.46 seconds (process running for 8.953)
2025-12-24T10:19:23.155+07:00 DEBUG 26764 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-24T10:19:23.308+07:00 DEBUG 26764 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T10:19:23.314+07:00 DEBUG 26764 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=f48b27ec-78a2-4568-a2a4-a49ee8768275, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-24T10:19:23.518+07:00 DEBUG 26764 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-24T10:19:23.521+07:00 DEBUG 26764 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T10:19:23.522+07:00 DEBUG 26764 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-24T10:19:23.537+07:00 DEBUG 26764 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T10:19:23.550+07:00 DEBUG 26764 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T10:19:23.551+07:00 DEBUG 26764 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-24T10:19:23.604+07:00 DEBUG 26764 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T10:19:23.646+07:00 DEBUG 26764 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T10:19:23.773+07:00 DEBUG 26764 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T10:19:23.773+07:00 DEBUG 26764 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-24T10:19:24.226+07:00 DEBUG 26764 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@4a1c0752, started on Wed Dec 24 10:19:17 ICT 2025
2025-12-24T10:20:28.703+07:00  INFO 19660 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 19660 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T10:20:28.703+07:00 DEBUG 19660 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T10:20:28.705+07:00  INFO 19660 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-24T10:20:28.727+07:00 DEBUG 19660 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@3887cf88
2025-12-24T10:20:31.406+07:00 DEBUG 19660 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 7 mappings in 'requestMappingHandlerMapping'
2025-12-24T10:20:31.580+07:00 DEBUG 19660 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T10:20:31.738+07:00 DEBUG 19660 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T10:20:31.806+07:00 DEBUG 19660 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T10:20:31.921+07:00  WARN 19660 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T10:20:31.921+07:00 DEBUG 19660 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T10:20:32.071+07:00 DEBUG 19660 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T10:20:32.150+07:00  INFO 19660 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T10:20:32.151+07:00  INFO 19660 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T10:20:32.153+07:00  INFO 19660 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 2 ms
2025-12-24T10:20:32.196+07:00  INFO 19660 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 4.033 seconds (process running for 5.405)
2025-12-24T10:20:32.295+07:00 DEBUG 19660 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-24T10:20:32.366+07:00 DEBUG 19660 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T10:20:32.370+07:00 DEBUG 19660 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=864686c6-6e03-434f-b807-9006db1f95ac, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-24T10:20:32.480+07:00 DEBUG 19660 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-24T10:20:32.482+07:00 DEBUG 19660 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T10:20:32.484+07:00 DEBUG 19660 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-24T10:20:32.499+07:00 DEBUG 19660 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T10:20:32.506+07:00 DEBUG 19660 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T10:20:32.506+07:00 DEBUG 19660 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-24T10:20:32.551+07:00 DEBUG 19660 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T10:20:32.588+07:00 DEBUG 19660 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T10:20:32.668+07:00 DEBUG 19660 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T10:20:32.668+07:00 DEBUG 19660 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-24T10:20:32.689+07:00 DEBUG 19660 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@3887cf88, started on Wed Dec 24 10:20:28 ICT 2025
2025-12-24T11:00:41.955+07:00  INFO 24752 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 24752 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:00:41.959+07:00 DEBUG 24752 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:00:41.959+07:00  INFO 24752 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-24T11:00:41.988+07:00 DEBUG 24752 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@534ca02b
2025-12-24T11:00:45.018+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 7 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:00:45.235+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:00:45.427+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:00:45.499+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:00:45.620+07:00  WARN 24752 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:00:45.621+07:00 DEBUG 24752 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:00:45.785+07:00 DEBUG 24752 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:00:45.861+07:00  INFO 24752 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:00:45.863+07:00  INFO 24752 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:00:45.865+07:00  INFO 24752 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 2 ms
2025-12-24T11:00:45.921+07:00  INFO 24752 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 4.595 seconds (process running for 6.194)
2025-12-24T11:00:46.036+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-24T11:00:46.107+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:46.115+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=f4bbd25f-5a4c-4f38-9920-4694f3c0e9e6, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-24T11:00:46.239+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-24T11:00:46.243+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:00:46.244+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-24T11:00:46.263+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T11:00:46.277+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:00:46.279+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-24T11:00:46.333+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:00:46.375+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T11:00:46.490+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:00:46.490+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-24T11:00:46.520+07:00  INFO 24752 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.UserControllerUnitTest]: UserControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T11:00:46.553+07:00  INFO 24752 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.UserControllerUnitTest
2025-12-24T11:00:46.564+07:00  INFO 24752 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T11:00:46.625+07:00  INFO 24752 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Starting UserControllerUnitTest using Java 21.0.9 with PID 24752 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:00:46.626+07:00 DEBUG 24752 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:00:46.627+07:00  INFO 24752 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T11:00:46.631+07:00 DEBUG 24752 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@1fc8047f
2025-12-24T11:00:47.234+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:00:47.282+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:00:47.289+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:00:47.303+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:00:47.343+07:00  WARN 24752 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:00:47.343+07:00 DEBUG 24752 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:00:47.363+07:00 DEBUG 24752 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:00:47.376+07:00  INFO 24752 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:00:47.376+07:00  INFO 24752 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:00:47.377+07:00  INFO 24752 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-24T11:00:47.389+07:00  INFO 24752 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Started UserControllerUnitTest in 0.826 seconds (process running for 7.66)
2025-12-24T11:00:47.402+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:47.406+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=12345)]
2025-12-24T11:00:47.453+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:47.471+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.478+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.456390100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:47.486+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [12345]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@3c62c81f,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:00:47.509+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:00:47.513+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@47fbf95e]
2025-12-24T11:00:47.521+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:47.521+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.523+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.521919800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:47.525+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'phone': rejected value [not-a-number]; codes [Pattern.updateProfileRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@3c62c81f,^0\d{9,10}$]; default message [Số điện thoại không hợp lệ (10-11 số, bắt đầu bằng 0)]] ]
2025-12-24T11:00:47.539+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:00:47.541+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@6f9999f6]
2025-12-24T11:00:47.545+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:47.545+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.545+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.545838500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:47.548+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'fullName': rejected value []; codes [Size.updateProfileRequest.fullName,Size.fullName,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.fullName,fullName]; arguments []; default message [fullName],100,2]; default message [Họ tên phải từ 2-100 ký tự]] ]
2025-12-24T11:00:47.568+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T11:00:47.575+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.579+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@2604940]
2025-12-24T11:00:47.597+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T11:00:47.601+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.601+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@3458be63]
2025-12-24T11:00:47.657+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:00:47.658+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:47.661+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.661+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.660303600, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:00:47.662+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:00:47.671+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T11:00:47.672+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:47.673+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.674+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.673826900, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:00:47.675+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:00:47.728+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:00:47.733+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=)]
2025-12-24T11:00:47.739+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:47.739+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.740+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.739790400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:47.740+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-24T11:00:47.750+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:47.753+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=1234567)]
2025-12-24T11:00:47.754+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:47.755+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.755+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.754791400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:47.756+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [1234567]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@3c62c81f,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:00:47.801+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T11:00:47.804+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@1690929]
2025-12-24T11:00:47.813+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:47.814+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.815+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.814481200, status=400, error=Bad Request, message=Mật kh (truncated)...]
2025-12-24T11:00:47.815+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Mật khẩu hiện tại không chính xác]
2025-12-24T11:00:47.825+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:00:47.826+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=not-an-email)]
2025-12-24T11:00:47.827+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:47.828+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.828+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.827712400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:47.829+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@436d2bb9,.*]; default message [Email khong hop le]] ]
2025-12-24T11:00:47.840+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T11:00:47.840+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@11ec2b2f]
2025-12-24T11:00:47.846+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.847+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Doi mat khau thanh cong}]
2025-12-24T11:00:47.864+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-24T11:00:47.866+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.867+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@fd5c7f6]
2025-12-24T11:00:47.881+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:47.884+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=)]
2025-12-24T11:00:47.886+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:47.887+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.888+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.886099600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:47.892+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest) with 2 errors: [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@3c62c81f,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [NotBlank.emailChangeVerifyRequest.otp,NotBlank.otp,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp]]; default message [Ma OTP khong duoc de trong]] ]
2025-12-24T11:00:47.907+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T11:00:47.909+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:47.909+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.909+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.909177200, status=400, error=Bad Request, message=File i (truncated)...]
2025-12-24T11:00:47.910+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: File is empty]
2025-12-24T11:00:47.921+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:47.922+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=not-an-email, otp=123456)]
2025-12-24T11:00:47.923+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:47.923+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.925+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.923924400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:47.927+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeVerifyRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@436d2bb9,.*]; default message [Email khong hop le]] ]
2025-12-24T11:00:47.936+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:00:47.937+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@2d4f1ddd]
2025-12-24T11:00:47.939+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:47.939+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.940+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.939542800, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:00:47.941+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:00:47.950+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:00:47.951+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T11:00:47.954+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.954+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=OTP da duoc gui den email moi}]
2025-12-24T11:00:47.962+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T11:00:47.963+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:47.963+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.963+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.963916, status=401, error=Unauthorized, message=User not (truncated)...]
2025-12-24T11:00:47.966+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:00:47.977+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:00:47.978+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:47.979+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.980+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.979060700, status=400, error=Bad Request, message=Khong  (truncated)...]
2025-12-24T11:00:47.980+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Khong co yeu cau thay doi email. Vui long tao yeu cau moi.]
2025-12-24T11:00:47.991+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:00:47.991+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=test@example.com)]
2025-12-24T11:00:47.993+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:47.993+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:47.993+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:47.993173600, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:00:47.993+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi phai khac email hien tai]
2025-12-24T11:00:48.006+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:00:48.011+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T11:00:48.012+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:48.013+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.014+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.013514900, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:00:48.014+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:00:48.024+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:00:48.025+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@75f446df]
2025-12-24T11:00:48.027+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.027+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@3751baf6]
2025-12-24T11:00:48.038+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:00:48.040+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T11:00:48.042+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:48.043+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.044+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.043549200, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-24T11:00:48.045+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 45 giay truoc khi gui lai ma OTP]
2025-12-24T11:00:48.055+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:48.056+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T11:00:48.057+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:48.057+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.059+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.057782300, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-24T11:00:48.059+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong chinh xac hoac da het han]
2025-12-24T11:00:48.067+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:00:48.068+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.068+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Ma OTP moi da duoc gui den email moi}]
2025-12-24T11:00:48.077+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:48.078+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-24T11:00:48.079+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:48.079+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.081+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.079853100, status=400, error=Bad Request, message=Ban da (truncated)...]
2025-12-24T11:00:48.081+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ban da nhap sai ma OTP qua nhieu lan. Vui long yeu cau gui ma OTP moi.]
2025-12-24T11:00:48.089+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:48.089+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=, otp=123456)]
2025-12-24T11:00:48.090+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:48.091+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.092+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.091782100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:48.093+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeVerifyRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-24T11:00:48.102+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:48.103+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=different@example.com, otp=123456)]
2025-12-24T11:00:48.103+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:48.105+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.105+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.105027, status=400, error=Bad Request, message=Email moi (truncated)...]
2025-12-24T11:00:48.105+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi khong khop voi yeu cau truoc do]
2025-12-24T11:00:48.113+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:00:48.115+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=existing@example.com)]
2025-12-24T11:00:48.116+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:48.116+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.116+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.116727300, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:00:48.116+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-24T11:00:48.128+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:48.128+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T11:00:48.130+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.130+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@497c1d78]
2025-12-24T11:00:48.143+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:48.145+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-24T11:00:48.146+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:48.147+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.147+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.147353200, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-24T11:00:48.147+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong dung. Ban con 4 lan thu.]
2025-12-24T11:00:48.154+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-24T11:00:48.156+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:48.156+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.157+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.156637, status=401, error=Unauthorized, message=User not (truncated)...]
2025-12-24T11:00:48.157+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:00:48.167+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:00:48.169+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:48.169+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.169+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.169373100, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-24T11:00:48.170+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 30 giay truoc khi gui lai ma OTP]
2025-12-24T11:00:48.179+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:48.181+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=abc123)]
2025-12-24T11:00:48.182+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:48.184+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.184+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.184440800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:48.185+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [abc123]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@3c62c81f,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:00:48.214+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T11:00:48.215+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@6d77d269]
2025-12-24T11:00:48.221+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:48.223+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.226+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.222289, status=401, error=Unauthorized, message=User not (truncated)...]
2025-12-24T11:00:48.227+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:00:48.284+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T11:00:48.289+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:48.296+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.296+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.295782200, status=400, error=Bad Request, message=User n (truncated)...]
2025-12-24T11:00:48.296+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: User not found]
2025-12-24T11:00:48.324+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:00:48.331+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:48.333+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.337+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.333423800, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:00:48.339+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-24T11:00:48.351+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:00:48.351+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T11:00:48.357+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:48.358+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:48.358+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:48.358012600, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:00:48.359+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:00:48.378+07:00  INFO 24752 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.ClinicServiceControllerUnitTest]: ClinicServiceControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T11:00:48.407+07:00  INFO 24752 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.ClinicServiceControllerUnitTest
2025-12-24T11:00:48.414+07:00  INFO 24752 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T11:00:48.476+07:00  INFO 24752 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Starting ClinicServiceControllerUnitTest using Java 21.0.9 with PID 24752 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:00:48.476+07:00 DEBUG 24752 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:00:48.476+07:00  INFO 24752 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T11:00:48.482+07:00 DEBUG 24752 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@f9979cf
2025-12-24T11:00:48.957+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:00:48.995+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:00:49.003+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:00:49.010+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:00:49.036+07:00  WARN 24752 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:00:49.036+07:00 DEBUG 24752 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:00:49.051+07:00 DEBUG 24752 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:00:49.063+07:00  INFO 24752 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:00:49.064+07:00  INFO 24752 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:00:49.066+07:00  INFO 24752 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 2 ms
2025-12-24T11:00:49.078+07:00  INFO 24752 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Started ClinicServiceControllerUnitTest in 0.664 seconds (process running for 9.35)
2025-12-24T11:00:49.093+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updatePricePerKm(UUID, BigDecimal)
2025-12-24T11:00:49.101+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.102+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@10ab976b]
2025-12-24T11:00:49.119+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#deleteService(UUID)
2025-12-24T11:00:49.122+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.122+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-24T11:00:49.138+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-24T11:00:49.149+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@18bab95b]
2025-12-24T11:00:49.161+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.161+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@10acfe30]
2025-12-24T11:00:49.191+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-24T11:00:49.195+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@403f6c04]
2025-12-24T11:00:49.204+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.204+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@2b27d5d3]
2025-12-24T11:00:49.214+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-24T11:00:49.215+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:49.220+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.220+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:49.215065500, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T11:00:49.221+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid status transition]
2025-12-24T11:00:49.227+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateBulkPricePerKm(BigDecimal)
2025-12-24T11:00:49.228+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.228+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-24T11:00:49.236+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-24T11:00:49.237+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@76e4df53]
2025-12-24T11:00:49.240+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:49.241+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.241+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:49.240099500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:49.242+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.clinicService.ClinicServiceResponse> com.petties.petties.controller.ClinicServiceController.createService(com.petties.petties.dto.clinicService.ClinicServiceRequest) with 3 errors: [Field error in object 'clinicServiceRequest' on field 'slotsRequired': rejected value [null]; codes [NotNull.clinicServiceRequest.slotsRequired,NotNull.slotsRequired,NotNull.java.lang.Integer,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.slotsRequired,slotsRequired]; arguments []; default message [slotsRequired]]; default message [Số slot yêu cầu không được để trống]] [Field error in object 'clinicServiceRequest' on field 'name': rejected value [null]; codes [NotBlank.clinicServiceRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.name,name]; arguments []; default message [name]]; default message [Tên dịch vụ không được để trống]] [Field error in object 'clinicServiceRequest' on field 'basePrice': rejected value [null]; codes [NotNull.clinicServiceRequest.basePrice,NotNull.basePrice,NotNull.java.math.BigDecimal,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.basePrice,basePrice]; arguments []; default message [basePrice]]; default message [Giá cơ bản không được để trống]] ]
2025-12-24T11:00:49.256+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-24T11:00:49.257+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@145ce025]
2025-12-24T11:00:49.260+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T11:00:49.261+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.262+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:49.261463100, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-24T11:00:49.263+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-24T11:00:49.271+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-24T11:00:49.273+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.273+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@408a0e92]
2025-12-24T11:00:49.281+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-24T11:00:49.282+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T11:00:49.282+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.282+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:49.282941600, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-24T11:00:49.282+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-24T11:00:49.291+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getAllServices()
2025-12-24T11:00:49.296+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.296+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[com.petties.petties.dto.clinicService.ClinicServiceResponse@56a6aadb]]
2025-12-24T11:00:49.312+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-24T11:00:49.313+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:49.314+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@492e9e87]
2025-12-24T11:00:49.334+07:00  INFO 24752 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.AuthControllerUnitTest]: AuthControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T11:00:49.353+07:00  INFO 24752 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.AuthControllerUnitTest
2025-12-24T11:00:49.358+07:00  INFO 24752 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T11:00:49.397+07:00  INFO 24752 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Starting AuthControllerUnitTest using Java 21.0.9 with PID 24752 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:00:49.399+07:00 DEBUG 24752 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:00:49.401+07:00  INFO 24752 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T11:00:49.405+07:00 DEBUG 24752 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@6f404bc6
2025-12-24T11:00:50.018+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 14 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:00:50.061+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:00:50.073+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:00:50.078+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:00:50.098+07:00  WARN 24752 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:00:50.098+07:00 DEBUG 24752 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:00:50.109+07:00 DEBUG 24752 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:00:50.118+07:00  INFO 24752 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:00:50.118+07:00  INFO 24752 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:00:50.118+07:00  INFO 24752 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-12-24T11:00:50.125+07:00  INFO 24752 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Started AuthControllerUnitTest in 0.767 seconds (process running for 10.397)
2025-12-24T11:00:50.136+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.141+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@626edbe0]
2025-12-24T11:00:50.152+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.156+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.156+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.152292700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.158+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [NotBlank.sendOtpRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password]]; default message [Mật khẩu không được để trống]] ]
2025-12-24T11:00:50.168+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:00:50.171+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@670e6fa3]
2025-12-24T11:00:50.173+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.175+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.176+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.175099, status=400, error=Validation Failed, message=Mã  (truncated)...]
2025-12-24T11:00:50.177+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [1234567]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T11:00:50.185+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.188+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@2940eec0]
2025-12-24T11:00:50.193+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.195+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.195+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.193912200, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T11:00:50.195+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-24T11:00:50.203+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:00:50.206+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@40bac624]
2025-12-24T11:00:50.211+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.211+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@7720334e]
2025-12-24T11:00:50.221+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:00:50.223+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@77035caa]
2025-12-24T11:00:50.229+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.229+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@6789b471]
2025-12-24T11:00:50.235+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:00:50.236+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@316987c4]
2025-12-24T11:00:50.238+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.239+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.239+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.238528500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.240+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value [null]; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-24T11:00:50.246+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.247+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@63c07eaf]
2025-12-24T11:00:50.248+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.249+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.249+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.249824300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.251+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [NotBlank.resetPasswordRequest.newPassword,NotBlank.newPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword]]; default message [Mật khẩu mới không được để trống]] [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-24T11:00:50.256+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.257+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@4e7d77ec]
2025-12-24T11:00:50.259+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.259+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.259+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.259552600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.261+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [NotBlank.resetPasswordRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@3c62c81f,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-24T11:00:50.270+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:00:50.271+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@6d5b160]
2025-12-24T11:00:50.273+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.275+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.275+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.273273800, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-24T11:00:50.277+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-24T11:00:50.284+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T11:00:50.287+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.288+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@1d0b4b69]
2025-12-24T11:00:50.294+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T11:00:50.295+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.296+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.296+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.295058900, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-24T11:00:50.296+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-24T11:00:50.306+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.307+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@56a34c0e]
2025-12-24T11:00:50.309+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.309+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.MessageResponse@16750a5e]
2025-12-24T11:00:50.317+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:00:50.317+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@54b88247]
2025-12-24T11:00:50.318+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.319+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.319+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.318932200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.319+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value []; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-24T11:00:50.326+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.328+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@77b7a4b2]
2025-12-24T11:00:50.329+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.330+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.330+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.330166300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.331+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value []; codes [NotBlank.resetPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:00:50.336+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:00:50.336+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@5acc6ca1]
2025-12-24T11:00:50.338+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.338+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.338+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.338914400, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T11:00:50.339+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-24T11:00:50.347+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:00:50.349+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@327af731]
2025-12-24T11:00:50.350+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.350+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@2fb171f5]
2025-12-24T11:00:50.356+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.357+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@51c660c8]
2025-12-24T11:00:50.359+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.359+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.359+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.359165100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.360+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value [Pass1]; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-24T11:00:50.368+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.368+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@3a72b2c9]
2025-12-24T11:00:50.372+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.373+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.373+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.373349200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.373+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.resetPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@436d2bb9,.*]; default message [Email không đúng định dạng]] ]
2025-12-24T11:00:50.381+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.383+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@bc85538]
2025-12-24T11:00:50.385+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.386+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.386+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.386061700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.387+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value []; codes [NotBlank.sendOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:00:50.394+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.395+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@517f9ba3]
2025-12-24T11:00:50.396+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.397+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.398+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.396601100, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:00:50.398+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email already exists]
2025-12-24T11:00:50.403+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.405+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@2474331d]
2025-12-24T11:00:50.406+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.406+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@46977829]
2025-12-24T11:00:50.411+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T11:00:50.413+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.414+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.414+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.414098300, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-24T11:00:50.414+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending password reset found]
2025-12-24T11:00:50.420+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.420+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@3b25ce5e]
2025-12-24T11:00:50.421+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.421+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.421+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.421906900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.423+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'username': rejected value [ab]; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] ]
2025-12-24T11:00:50.428+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T11:00:50.428+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.430+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.430+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.430236100, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-24T11:00:50.430+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-24T11:00:50.436+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:00:50.436+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@55bf08a5]
2025-12-24T11:00:50.438+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:50.439+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.439+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.438661900, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-24T11:00:50.439+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid Google ID token]
2025-12-24T11:00:50.446+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:00:50.447+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@34e4a136]
2025-12-24T11:00:50.449+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.449+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.451+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.449956, status=400, error=Bad Request, message=Email not (truncated)...]
2025-12-24T11:00:50.451+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email not found]
2025-12-24T11:00:50.456+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:00:50.456+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@3f803fae]
2025-12-24T11:00:50.457+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.457+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.457+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.457632100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.457+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.forgotPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@436d2bb9,.*]; default message [Email không đúng định dạng]] ]
2025-12-24T11:00:50.464+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.465+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@21b96db]
2025-12-24T11:00:50.466+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.466+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.466+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.466427400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.468+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value [abc123]; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@3c62c81f,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-24T11:00:50.473+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:00:50.473+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@70ba01be]
2025-12-24T11:00:50.475+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.476+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.477+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.476355900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.478+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [12345]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T11:00:50.482+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.483+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@1f1b69bb]
2025-12-24T11:00:50.485+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.485+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.486+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.485110600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.486+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [NotBlank.sendOtpRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username]]; default message [Tên đăng nhập không được để trống]] ]
2025-12-24T11:00:50.495+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T11:00:50.496+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.497+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.497+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.497031400, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-24T11:00:50.497+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending registration found]
2025-12-24T11:00:50.503+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:00:50.503+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@187c8f96]
2025-12-24T11:00:50.504+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.505+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.505+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.504659600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.506+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value []; codes [NotBlank.verifyOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:00:50.512+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:00:50.513+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@610115e8]
2025-12-24T11:00:50.514+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.514+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.514+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.514177400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.515+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'idToken': rejected value []; codes [NotBlank.googleSignInRequest.idToken,NotBlank.idToken,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.idToken,idToken]; arguments []; default message [idToken]]; default message [ID token is required]] ]
2025-12-24T11:00:50.518+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.520+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@117e9a56]
2025-12-24T11:00:50.521+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.521+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.521+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.521879600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.521+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'confirmPassword': rejected value []; codes [NotBlank.resetPasswordRequest.confirmPassword,NotBlank.confirmPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.confirmPassword,confirmPassword]; arguments []; default message [confirmPassword]]; default message [Xác nhận mật khẩu không được để trống]] ]
2025-12-24T11:00:50.526+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.527+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@23938caa]
2025-12-24T11:00:50.527+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.527+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.528+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.527610100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.528+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'fullName': rejected value []; codes [NotBlank.sendOtpRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-24T11:00:50.533+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:00:50.534+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@495cac83]
2025-12-24T11:00:50.534+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.535+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@7225583d]
2025-12-24T11:00:50.542+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.543+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@71c1e70f]
2025-12-24T11:00:50.544+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.544+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.546+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.544831900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.546+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'password': rejected value [12345]; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] ]
2025-12-24T11:00:50.551+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:00:50.551+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@3ea95f79]
2025-12-24T11:00:50.553+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.553+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.553+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.553784, status=400, error=Validation Failed, message=Pas (truncated)...]
2025-12-24T11:00:50.553+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value [null]; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-24T11:00:50.559+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:00:50.561+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@3a02172a]
2025-12-24T11:00:50.562+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.562+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.562+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.562284800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.563+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest) with 2 errors: [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [NotBlank.verifyOtpRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T11:00:50.569+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:00:50.570+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@48149568]
2025-12-24T11:00:50.571+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.572+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@674b2703]
2025-12-24T11:00:50.577+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:00:50.578+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@7cbcd27e]
2025-12-24T11:00:50.578+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.578+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.580+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.578704100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.580+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value []; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-24T11:00:50.585+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:00:50.586+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@56ed9270]
2025-12-24T11:00:50.586+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.586+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@551fefe8]
2025-12-24T11:00:50.593+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:00:50.594+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@7294c9fe]
2025-12-24T11:00:50.595+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.595+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@65e639f2]
2025-12-24T11:00:50.601+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:00:50.603+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@7c48ea9e]
2025-12-24T11:00:50.603+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.603+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@25058759]
2025-12-24T11:00:50.609+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:00:50.609+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@3cdafb82]
2025-12-24T11:00:50.611+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.611+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.612+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.611350400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.614+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value []; codes [NotBlank.forgotPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:00:50.623+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:00:50.623+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@408573b1]
2025-12-24T11:00:50.626+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:00:50.627+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.627+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.626498100, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-24T11:00:50.627+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid username or password]
2025-12-24T11:00:50.631+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T11:00:50.632+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.632+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@2c4142f8]
2025-12-24T11:00:50.638+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:00:50.639+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@2cb95c6c]
2025-12-24T11:00:50.641+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.641+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.641+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.641941400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.643+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'platform': rejected value []; codes [NotBlank.googleSignInRequest.platform,NotBlank.platform,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.platform,platform]; arguments []; default message [platform]]; default message [Platform is required]] ]
2025-12-24T11:00:50.648+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.650+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@3edc999f]
2025-12-24T11:00:50.651+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.651+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.651+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.651707700, status=400, error=Bad Request, message=Passwo (truncated)...]
2025-12-24T11:00:50.652+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Passwords do not match]
2025-12-24T11:00:50.658+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.659+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@32ff3c98]
2025-12-24T11:00:50.661+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.661+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.661+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.661296600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.662+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'role': rejected value [null]; codes [NotNull.sendOtpRequest.role,NotNull.role,NotNull.com.petties.petties.model.enums.Role,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.role,role]; arguments []; default message [role]]; default message [Vai trò không được để trống]] ]
2025-12-24T11:00:50.669+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:00:50.671+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@1d7914a5]
2025-12-24T11:00:50.672+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.673+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.673+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.672227900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:00:50.673+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.sendOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@436d2bb9,.*]; default message [Email không hợp lệ]] ]
2025-12-24T11:00:50.678+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:00:50.680+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7d45e754]
2025-12-24T11:00:50.681+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:00:50.681+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.682+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.681426400, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-24T11:00:50.682+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-24T11:00:50.693+07:00 DEBUG 24752 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:00:50.694+07:00 DEBUG 24752 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@505e483f]
2025-12-24T11:00:50.695+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:00:50.695+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:00:50.695+07:00 DEBUG 24752 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:00:50.695822, status=400, error=Validation Failed, message=Ema (truncated)...]
2025-12-24T11:00:50.697+07:00 DEBUG 24752 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.verifyOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@436d2bb9,.*]; default message [Email không hợp lệ]] ]
2025-12-24T11:00:50.707+07:00 DEBUG 24752 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@534ca02b, started on Wed Dec 24 11:00:41 ICT 2025
2025-12-24T11:00:50.712+07:00 DEBUG 24752 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@1fc8047f, started on Wed Dec 24 11:00:46 ICT 2025
2025-12-24T11:00:50.713+07:00 DEBUG 24752 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@f9979cf, started on Wed Dec 24 11:00:48 ICT 2025
2025-12-24T11:00:50.716+07:00 DEBUG 24752 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@6f404bc6, started on Wed Dec 24 11:00:49 ICT 2025
2025-12-24T11:05:40.972+07:00  INFO 25256 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 25256 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:05:40.974+07:00 DEBUG 25256 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:05:40.975+07:00  INFO 25256 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-24T11:05:41.000+07:00 DEBUG 25256 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@591fd34d
2025-12-24T11:05:43.909+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 7 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:05:44.149+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:05:44.328+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:05:44.408+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:05:44.533+07:00  WARN 25256 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:05:44.533+07:00 DEBUG 25256 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:05:44.696+07:00 DEBUG 25256 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:05:44.793+07:00  INFO 25256 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:05:44.794+07:00  INFO 25256 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:05:44.796+07:00  INFO 25256 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 2 ms
2025-12-24T11:05:44.865+07:00  INFO 25256 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 4.432 seconds (process running for 5.969)
2025-12-24T11:05:45.076+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:05:45.178+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=, phone=0912345678, role=VET)]
2025-12-24T11:05:45.330+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:45.365+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:45.375+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:45.332111100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:45.401+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'fullName': rejected value []; codes [NotBlank.quickAddStaffRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-24T11:05:45.556+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:05:45.557+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Duplicate User, phone=0987654321, role=VET)]
2025-12-24T11:05:45.565+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceAlreadyExists(ResourceAlreadyExistsException, HttpServletRequest)
2025-12-24T11:05:45.566+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:45.566+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:45.565537300, status=409, error=Conflict, message=Số điện t (truncated)...]
2025-12-24T11:05:45.568+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceAlreadyExistsException: Số điện thoại này đã được đăng ký tài khoản]
2025-12-24T11:05:45.597+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-24T11:05:45.610+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:45.613+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=ee881a5d-bf5b-4a40-8cd3-4f79b2bf18f1, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-24T11:05:45.646+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:05:45.652+07:00 DEBUG 25256 --- [petties] [main] o.s.web.method.HandlerMethod             : Could not resolve parameter [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]
2025-12-24T11:05:45.653+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleGenericException(Exception, HttpServletRequest)
2025-12-24T11:05:45.663+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:45.664+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:45.655496900, status=500, error=Internal Server Error, mess (truncated)...]
2025-12-24T11:05:45.665+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]]
2025-12-24T11:05:45.708+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-24T11:05:45.714+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:05:45.715+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-24T11:05:45.735+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:05:45.735+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Tester, phone=123, role=VET)]
2025-12-24T11:05:45.738+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:45.739+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:45.739+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:45.738803600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:45.741+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'phone': rejected value [123]; codes [Pattern.quickAddStaffRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@78f4d15d,^[0-9]{10,11}$]; default message [Số điện thoại không hợp lệ]] ]
2025-12-24T11:05:45.755+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T11:05:45.768+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:05:45.768+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-24T11:05:45.802+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T11:05:45.803+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T11:05:45.805+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:45.805+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:45.805012, status=404, error=Not Found, message=User not fo (truncated)...]
2025-12-24T11:05:45.806+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: User not found]
2025-12-24T11:05:45.821+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:05:45.823+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T11:05:45.825+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:05:45.825+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-24T11:05:45.837+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignVet(UUID, String)
2025-12-24T11:05:45.839+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T11:05:45.839+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:45.839+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:45.839875800, status=403, error=Forbidden, message=Bạn khôn (truncated)...]
2025-12-24T11:05:45.839+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Bạn không có quyền quản lý phòng khám này]
2025-12-24T11:05:45.871+07:00  INFO 25256 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.UserControllerUnitTest]: UserControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T11:05:45.899+07:00  INFO 25256 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.UserControllerUnitTest
2025-12-24T11:05:45.909+07:00  INFO 25256 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T11:05:46.048+07:00  INFO 25256 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Starting UserControllerUnitTest using Java 21.0.9 with PID 25256 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:05:46.049+07:00 DEBUG 25256 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:05:46.051+07:00  INFO 25256 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T11:05:46.061+07:00 DEBUG 25256 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@278c67a7
2025-12-24T11:05:46.844+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:05:46.894+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:05:46.904+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:05:46.913+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:05:46.939+07:00  WARN 25256 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:05:46.939+07:00 DEBUG 25256 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:05:46.957+07:00 DEBUG 25256 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:05:46.971+07:00  INFO 25256 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:05:46.971+07:00  INFO 25256 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:05:46.972+07:00  INFO 25256 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-24T11:05:46.984+07:00  INFO 25256 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Started UserControllerUnitTest in 1.076 seconds (process running for 8.087)
2025-12-24T11:05:46.998+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.004+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=12345)]
2025-12-24T11:05:47.032+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.039+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.040+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.032612700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:47.040+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [12345]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@78f4d15d,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:05:47.062+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:05:47.063+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@7945986a]
2025-12-24T11:05:47.071+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.072+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.072+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.071499, status=400, error=Validation Failed, message=Số  (truncated)...]
2025-12-24T11:05:47.073+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'phone': rejected value [not-a-number]; codes [Pattern.updateProfileRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@78f4d15d,^0\d{9,10}$]; default message [Số điện thoại không hợp lệ (10-11 số, bắt đầu bằng 0)]] ]
2025-12-24T11:05:47.084+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:05:47.086+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@4560eb15]
2025-12-24T11:05:47.087+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.088+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.089+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.088828700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:47.089+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'fullName': rejected value []; codes [Size.updateProfileRequest.fullName,Size.fullName,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.fullName,fullName]; arguments []; default message [fullName],100,2]; default message [Họ tên phải từ 2-100 ký tự]] ]
2025-12-24T11:05:47.106+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T11:05:47.111+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.112+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@5b4880b3]
2025-12-24T11:05:47.132+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T11:05:47.135+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.136+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@1e4b9592]
2025-12-24T11:05:47.148+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:05:47.149+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:47.149+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.151+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.149882300, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:05:47.151+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:05:47.161+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T11:05:47.163+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:47.163+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.163+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.163730700, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:05:47.163+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:05:47.175+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:05:47.178+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=)]
2025-12-24T11:05:47.183+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.185+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.185+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.183657900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:47.186+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-24T11:05:47.195+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.197+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=1234567)]
2025-12-24T11:05:47.200+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.200+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.200+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.200083600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:47.201+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [1234567]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@78f4d15d,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:05:47.211+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T11:05:47.214+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@6af0407c]
2025-12-24T11:05:47.221+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.221+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.221+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.221892400, status=400, error=Bad Request, message=Mật kh (truncated)...]
2025-12-24T11:05:47.221+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Mật khẩu hiện tại không chính xác]
2025-12-24T11:05:47.232+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:05:47.232+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=not-an-email)]
2025-12-24T11:05:47.233+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.234+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.234+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.234695200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:47.236+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@3af6c672,.*]; default message [Email khong hop le]] ]
2025-12-24T11:05:47.247+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T11:05:47.248+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@71db6703]
2025-12-24T11:05:47.253+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.253+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Doi mat khau thanh cong}]
2025-12-24T11:05:47.263+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-24T11:05:47.264+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.266+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@397f925e]
2025-12-24T11:05:47.273+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.273+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=)]
2025-12-24T11:05:47.276+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.276+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.276+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.276148200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:47.277+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest) with 2 errors: [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [NotBlank.emailChangeVerifyRequest.otp,NotBlank.otp,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp]]; default message [Ma OTP khong duoc de trong]] [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@78f4d15d,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:05:47.285+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T11:05:47.288+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.288+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.288+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.288915100, status=400, error=Bad Request, message=File i (truncated)...]
2025-12-24T11:05:47.290+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: File is empty]
2025-12-24T11:05:47.298+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.299+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=not-an-email, otp=123456)]
2025-12-24T11:05:47.301+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.303+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.303+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.303276100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:47.304+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeVerifyRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@3af6c672,.*]; default message [Email khong hop le]] ]
2025-12-24T11:05:47.314+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:05:47.316+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@4afdb05e]
2025-12-24T11:05:47.318+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:47.318+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.319+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.318901800, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:05:47.320+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:05:47.329+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:05:47.331+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T11:05:47.332+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.332+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=OTP da duoc gui den email moi}]
2025-12-24T11:05:47.341+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T11:05:47.343+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:47.343+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.343+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.343631800, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:05:47.344+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:05:47.351+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:05:47.352+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.353+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.353+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.353613500, status=400, error=Bad Request, message=Khong  (truncated)...]
2025-12-24T11:05:47.353+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Khong co yeu cau thay doi email. Vui long tao yeu cau moi.]
2025-12-24T11:05:47.361+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:05:47.362+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=test@example.com)]
2025-12-24T11:05:47.363+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.364+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.364+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.363131600, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:05:47.365+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi phai khac email hien tai]
2025-12-24T11:05:47.370+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:05:47.371+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T11:05:47.373+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:47.373+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.373+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.373623600, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:05:47.374+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:05:47.381+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:05:47.382+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@63d14dbf]
2025-12-24T11:05:47.383+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.383+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@67521a79]
2025-12-24T11:05:47.393+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:05:47.394+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T11:05:47.395+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.395+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.396+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.395617200, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-24T11:05:47.398+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 45 giay truoc khi gui lai ma OTP]
2025-12-24T11:05:47.404+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.404+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T11:05:47.406+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.406+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.407+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.406889100, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-24T11:05:47.407+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong chinh xac hoac da het han]
2025-12-24T11:05:47.416+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:05:47.417+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.417+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Ma OTP moi da duoc gui den email moi}]
2025-12-24T11:05:47.424+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.425+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-24T11:05:47.428+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.429+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.429+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.429046700, status=400, error=Bad Request, message=Ban da (truncated)...]
2025-12-24T11:05:47.430+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ban da nhap sai ma OTP qua nhieu lan. Vui long yeu cau gui ma OTP moi.]
2025-12-24T11:05:47.437+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.438+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=, otp=123456)]
2025-12-24T11:05:47.439+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.439+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.440+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.439365300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:47.442+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeVerifyRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-24T11:05:47.451+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.451+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=different@example.com, otp=123456)]
2025-12-24T11:05:47.453+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.453+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.453+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.453708900, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:05:47.455+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi khong khop voi yeu cau truoc do]
2025-12-24T11:05:47.462+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:05:47.463+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=existing@example.com)]
2025-12-24T11:05:47.465+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.465+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.465+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.465178, status=400, error=Bad Request, message=Email da  (truncated)...]
2025-12-24T11:05:47.465+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-24T11:05:47.473+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.473+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T11:05:47.475+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.475+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@5478597]
2025-12-24T11:05:47.482+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.483+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-24T11:05:47.485+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.485+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.485+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.485212200, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-24T11:05:47.485+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong dung. Ban con 4 lan thu.]
2025-12-24T11:05:47.492+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-24T11:05:47.493+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:47.494+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.494+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.493123400, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:05:47.494+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:05:47.501+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:05:47.503+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.503+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.503+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.503829200, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-24T11:05:47.505+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 30 giay truoc khi gui lai ma OTP]
2025-12-24T11:05:47.514+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.517+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=abc123)]
2025-12-24T11:05:47.520+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:47.520+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.520+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.520265400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:47.521+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [abc123]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@78f4d15d,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:05:47.530+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T11:05:47.531+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@1b08d26f]
2025-12-24T11:05:47.532+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:47.532+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.532+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.532287600, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:05:47.533+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:05:47.541+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T11:05:47.542+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.542+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.542+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.542344800, status=400, error=Bad Request, message=User n (truncated)...]
2025-12-24T11:05:47.543+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: User not found]
2025-12-24T11:05:47.549+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:05:47.550+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:47.551+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.551+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.550497400, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:05:47.551+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-24T11:05:47.559+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:05:47.560+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T11:05:47.561+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:47.561+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:47.562+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:47.561208, status=401, error=Unauthorized, message=User not (truncated)...]
2025-12-24T11:05:47.562+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:05:47.581+07:00  INFO 25256 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.ClinicServiceControllerUnitTest]: ClinicServiceControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T11:05:47.605+07:00  INFO 25256 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.ClinicServiceControllerUnitTest
2025-12-24T11:05:47.611+07:00  INFO 25256 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T11:05:47.650+07:00  INFO 25256 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Starting ClinicServiceControllerUnitTest using Java 21.0.9 with PID 25256 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:05:47.650+07:00 DEBUG 25256 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:05:47.651+07:00  INFO 25256 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T11:05:47.653+07:00 DEBUG 25256 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@255b84a9
2025-12-24T11:05:48.159+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:05:48.196+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:05:48.202+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:05:48.208+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:05:48.229+07:00  WARN 25256 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:05:48.229+07:00 DEBUG 25256 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:05:48.241+07:00 DEBUG 25256 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:05:48.247+07:00  INFO 25256 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:05:48.247+07:00  INFO 25256 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:05:48.249+07:00  INFO 25256 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-12-24T11:05:48.257+07:00  INFO 25256 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Started ClinicServiceControllerUnitTest in 0.647 seconds (process running for 9.361)
2025-12-24T11:05:48.271+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updatePricePerKm(UUID, BigDecimal)
2025-12-24T11:05:48.282+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.283+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@3c89fdd8]
2025-12-24T11:05:48.296+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#deleteService(UUID)
2025-12-24T11:05:48.300+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.300+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-24T11:05:48.320+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-24T11:05:48.327+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@36995784]
2025-12-24T11:05:48.338+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.339+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@7fecc26f]
2025-12-24T11:05:48.361+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-24T11:05:48.368+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@56a6aadb]
2025-12-24T11:05:48.376+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.377+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@9bd477c]
2025-12-24T11:05:48.384+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-24T11:05:48.388+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:48.393+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.394+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:48.388518100, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T11:05:48.395+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid status transition]
2025-12-24T11:05:48.404+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateBulkPricePerKm(BigDecimal)
2025-12-24T11:05:48.406+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.407+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-24T11:05:48.414+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-24T11:05:48.415+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@43e6f05f]
2025-12-24T11:05:48.418+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:48.418+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.420+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:48.418236100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:48.421+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.clinicService.ClinicServiceResponse> com.petties.petties.controller.ClinicServiceController.createService(com.petties.petties.dto.clinicService.ClinicServiceRequest) with 3 errors: [Field error in object 'clinicServiceRequest' on field 'name': rejected value [null]; codes [NotBlank.clinicServiceRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.name,name]; arguments []; default message [name]]; default message [Tên dịch vụ không được để trống]] [Field error in object 'clinicServiceRequest' on field 'basePrice': rejected value [null]; codes [NotNull.clinicServiceRequest.basePrice,NotNull.basePrice,NotNull.java.math.BigDecimal,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.basePrice,basePrice]; arguments []; default message [basePrice]]; default message [Giá cơ bản không được để trống]] [Field error in object 'clinicServiceRequest' on field 'slotsRequired': rejected value [null]; codes [NotNull.clinicServiceRequest.slotsRequired,NotNull.slotsRequired,NotNull.java.lang.Integer,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.slotsRequired,slotsRequired]; arguments []; default message [slotsRequired]]; default message [Số slot yêu cầu không được để trống]] ]
2025-12-24T11:05:48.431+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-24T11:05:48.433+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@3a70acd5]
2025-12-24T11:05:48.436+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T11:05:48.436+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.436+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:48.436265200, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-24T11:05:48.437+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-24T11:05:48.445+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-24T11:05:48.446+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.447+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@1f031994]
2025-12-24T11:05:48.454+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-24T11:05:48.455+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T11:05:48.456+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.456+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:48.456122500, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-24T11:05:48.457+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-24T11:05:48.464+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getAllServices()
2025-12-24T11:05:48.468+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.468+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[com.petties.petties.dto.clinicService.ClinicServiceResponse@44f5259a]]
2025-12-24T11:05:48.484+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-24T11:05:48.485+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:48.485+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@599cf2cd]
2025-12-24T11:05:48.504+07:00  INFO 25256 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.AuthControllerUnitTest]: AuthControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T11:05:48.524+07:00  INFO 25256 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.AuthControllerUnitTest
2025-12-24T11:05:48.529+07:00  INFO 25256 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T11:05:48.577+07:00  INFO 25256 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Starting AuthControllerUnitTest using Java 21.0.9 with PID 25256 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:05:48.578+07:00 DEBUG 25256 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:05:48.578+07:00  INFO 25256 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T11:05:48.582+07:00 DEBUG 25256 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@27f43664
2025-12-24T11:05:48.995+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 14 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:05:49.042+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:05:49.048+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:05:49.054+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:05:49.077+07:00  WARN 25256 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:05:49.077+07:00 DEBUG 25256 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:05:49.089+07:00 DEBUG 25256 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:05:49.096+07:00  INFO 25256 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:05:49.097+07:00  INFO 25256 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:05:49.098+07:00  INFO 25256 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-24T11:05:49.106+07:00  INFO 25256 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Started AuthControllerUnitTest in 0.577 seconds (process running for 10.209)
2025-12-24T11:05:49.116+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.120+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@1d0b4b69]
2025-12-24T11:05:49.128+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.131+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.132+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.128123600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.133+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [NotBlank.sendOtpRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password]]; default message [Mật khẩu không được để trống]] [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] ]
2025-12-24T11:05:49.147+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:05:49.149+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@2474331d]
2025-12-24T11:05:49.153+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.155+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.156+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.155368300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.158+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [1234567]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T11:05:49.168+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.171+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@1b841396]
2025-12-24T11:05:49.176+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.177+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.177+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.176095100, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T11:05:49.178+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-24T11:05:49.187+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:05:49.189+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@57421e4e]
2025-12-24T11:05:49.194+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.194+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@34e4a136]
2025-12-24T11:05:49.201+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:05:49.203+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@5ea24702]
2025-12-24T11:05:49.207+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.208+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@3f803fae]
2025-12-24T11:05:49.216+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:05:49.216+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@23a0c7f3]
2025-12-24T11:05:49.217+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.218+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.219+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.218129500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.220+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value [null]; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-24T11:05:49.226+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.227+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@514f2b5c]
2025-12-24T11:05:49.228+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.229+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.230+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.229999200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.231+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [NotBlank.resetPasswordRequest.newPassword,NotBlank.newPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword]]; default message [Mật khẩu mới không được để trống]] [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-24T11:05:49.239+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.240+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@c730e65]
2025-12-24T11:05:49.242+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.242+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.243+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.242082600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.243+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@78f4d15d,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [NotBlank.resetPasswordRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] ]
2025-12-24T11:05:49.253+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:05:49.256+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@4620e669]
2025-12-24T11:05:49.257+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.257+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.257+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.257186400, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-24T11:05:49.258+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-24T11:05:49.268+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T11:05:49.270+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.271+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@1dfd39fe]
2025-12-24T11:05:49.276+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T11:05:49.279+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.279+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.279+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.279132, status=400, error=Bad Request, message=Please wa (truncated)...]
2025-12-24T11:05:49.280+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-24T11:05:49.288+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.289+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@117e9a56]
2025-12-24T11:05:49.291+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.291+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.MessageResponse@21acc86a]
2025-12-24T11:05:49.297+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:05:49.299+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@643bef2a]
2025-12-24T11:05:49.299+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.300+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.300+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.299286600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.301+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value []; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-24T11:05:49.308+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.309+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7225583d]
2025-12-24T11:05:49.311+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.311+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.311+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.311847, status=400, error=Validation Failed, message=Ema (truncated)...]
2025-12-24T11:05:49.313+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value []; codes [NotBlank.resetPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:05:49.320+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:05:49.320+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@71c1e70f]
2025-12-24T11:05:49.321+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.323+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.323+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.321566800, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T11:05:49.324+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-24T11:05:49.333+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:05:49.333+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@3ea95f79]
2025-12-24T11:05:49.335+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.335+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@bce93d3]
2025-12-24T11:05:49.341+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.342+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@452d4bb2]
2025-12-24T11:05:49.343+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.343+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.344+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.343837700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.344+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value [Pass1]; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-24T11:05:49.349+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.351+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@67441705]
2025-12-24T11:05:49.352+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.353+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.353+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.352905300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.353+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.resetPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@3af6c672,.*]; default message [Email không đúng định dạng]] ]
2025-12-24T11:05:49.359+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.360+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@2d7b117]
2025-12-24T11:05:49.361+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.363+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.363+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.361551600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.364+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value []; codes [NotBlank.sendOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:05:49.370+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.371+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@6affa355]
2025-12-24T11:05:49.373+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.373+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.375+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.373959700, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:05:49.376+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email already exists]
2025-12-24T11:05:49.381+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.382+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@54a1a6a8]
2025-12-24T11:05:49.383+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.383+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@7cba8293]
2025-12-24T11:05:49.389+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T11:05:49.390+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.391+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.391+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.390985900, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-24T11:05:49.391+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending password reset found]
2025-12-24T11:05:49.396+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.397+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@28f663de]
2025-12-24T11:05:49.398+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.400+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.400+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.398789500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.400+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'username': rejected value [ab]; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] ]
2025-12-24T11:05:49.406+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T11:05:49.406+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.407+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.407+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.407799800, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-24T11:05:49.407+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-24T11:05:49.415+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:05:49.415+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@7ef8cfbb]
2025-12-24T11:05:49.416+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:49.416+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.416+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.416872500, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-24T11:05:49.418+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid Google ID token]
2025-12-24T11:05:49.425+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:05:49.427+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@5860e4c3]
2025-12-24T11:05:49.429+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.430+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.430+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.429807900, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:05:49.431+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email not found]
2025-12-24T11:05:49.437+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:05:49.437+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@201f0e84]
2025-12-24T11:05:49.438+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.439+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.439+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.439129900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.439+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.forgotPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@3af6c672,.*]; default message [Email không đúng định dạng]] ]
2025-12-24T11:05:49.446+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.448+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@136c3a6]
2025-12-24T11:05:49.449+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.449+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.450+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.449061400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.451+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value [abc123]; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@78f4d15d,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-24T11:05:49.456+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:05:49.457+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@c358f32]
2025-12-24T11:05:49.458+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.458+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.458+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.458257400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.459+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [12345]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T11:05:49.464+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.465+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@34db5935]
2025-12-24T11:05:49.465+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.465+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.467+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.465418100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.467+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [NotBlank.sendOtpRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username]]; default message [Tên đăng nhập không được để trống]] ]
2025-12-24T11:05:49.473+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T11:05:49.474+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.474+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.474+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.474151300, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-24T11:05:49.474+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending registration found]
2025-12-24T11:05:49.479+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:05:49.480+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@6419726f]
2025-12-24T11:05:49.480+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.481+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.481+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.481284500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.481+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value []; codes [NotBlank.verifyOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:05:49.489+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:05:49.490+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@e36a4c1]
2025-12-24T11:05:49.490+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.491+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.491+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.490093500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.491+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'idToken': rejected value []; codes [NotBlank.googleSignInRequest.idToken,NotBlank.idToken,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.idToken,idToken]; arguments []; default message [idToken]]; default message [ID token is required]] ]
2025-12-24T11:05:49.496+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.498+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@2330c5c5]
2025-12-24T11:05:49.499+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.499+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.499+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.499684300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.501+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'confirmPassword': rejected value []; codes [NotBlank.resetPasswordRequest.confirmPassword,NotBlank.confirmPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.confirmPassword,confirmPassword]; arguments []; default message [confirmPassword]]; default message [Xác nhận mật khẩu không được để trống]] ]
2025-12-24T11:05:49.509+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.510+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@2cc3b0a7]
2025-12-24T11:05:49.511+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.513+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.513+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.513022900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.514+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'fullName': rejected value []; codes [NotBlank.sendOtpRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-24T11:05:49.520+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:05:49.520+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@36e7b91c]
2025-12-24T11:05:49.523+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.524+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@630a647c]
2025-12-24T11:05:49.532+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.532+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@2258228f]
2025-12-24T11:05:49.533+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.534+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.534+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.533956400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.534+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'password': rejected value [12345]; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] ]
2025-12-24T11:05:49.542+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:05:49.542+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@43ab4e83]
2025-12-24T11:05:49.543+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.544+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.544+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.543819700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.545+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value [null]; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-24T11:05:49.551+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:05:49.553+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@3695e4f2]
2025-12-24T11:05:49.554+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.555+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.556+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.555506800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.556+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest) with 2 errors: [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [NotBlank.verifyOtpRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] ]
2025-12-24T11:05:49.564+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:05:49.565+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@633328d3]
2025-12-24T11:05:49.566+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.566+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@45382749]
2025-12-24T11:05:49.572+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:05:49.572+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@3c88db1]
2025-12-24T11:05:49.573+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.573+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.573+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.573373600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.574+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value []; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-24T11:05:49.581+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:05:49.582+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@672710d5]
2025-12-24T11:05:49.583+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.583+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@55880c]
2025-12-24T11:05:49.590+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:05:49.591+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@698e2cba]
2025-12-24T11:05:49.591+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.591+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@6cf47d05]
2025-12-24T11:05:49.600+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:05:49.601+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@14d43f13]
2025-12-24T11:05:49.603+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.603+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@140449d9]
2025-12-24T11:05:49.612+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:05:49.614+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@17eb5661]
2025-12-24T11:05:49.614+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.615+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.615+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.615349400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.615+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value []; codes [NotBlank.forgotPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:05:49.621+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:05:49.622+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@578cd644]
2025-12-24T11:05:49.623+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:05:49.623+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.624+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.623637900, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-24T11:05:49.624+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid username or password]
2025-12-24T11:05:49.630+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T11:05:49.631+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.631+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@4104b6a6]
2025-12-24T11:05:49.636+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:05:49.636+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@ab5d5c8]
2025-12-24T11:05:49.638+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.639+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.639+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.639479600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.640+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'platform': rejected value []; codes [NotBlank.googleSignInRequest.platform,NotBlank.platform,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.platform,platform]; arguments []; default message [platform]]; default message [Platform is required]] ]
2025-12-24T11:05:49.647+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.647+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@354a1239]
2025-12-24T11:05:49.648+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.648+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.648+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.648674400, status=400, error=Bad Request, message=Passwo (truncated)...]
2025-12-24T11:05:49.649+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Passwords do not match]
2025-12-24T11:05:49.655+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.656+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@6cd31e5f]
2025-12-24T11:05:49.656+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.657+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.657+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.657431500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.657+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'role': rejected value [null]; codes [NotNull.sendOtpRequest.role,NotNull.role,NotNull.com.petties.petties.model.enums.Role,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.role,role]; arguments []; default message [role]]; default message [Vai trò không được để trống]] ]
2025-12-24T11:05:49.661+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:05:49.661+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@36d8ddc5]
2025-12-24T11:05:49.663+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.664+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.664+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.664525, status=400, error=Validation Failed, message=Ema (truncated)...]
2025-12-24T11:05:49.665+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.sendOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@3af6c672,.*]; default message [Email không hợp lệ]] ]
2025-12-24T11:05:49.670+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:05:49.671+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@34c3e307]
2025-12-24T11:05:49.673+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:05:49.673+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.673+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.673484600, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-24T11:05:49.673+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-24T11:05:49.679+07:00 DEBUG 25256 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:05:49.680+07:00 DEBUG 25256 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@554a4d18]
2025-12-24T11:05:49.682+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:05:49.682+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:05:49.682+07:00 DEBUG 25256 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:05:49.682512300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:05:49.684+07:00 DEBUG 25256 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.verifyOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@3af6c672,.*]; default message [Email không hợp lệ]] ]
2025-12-24T11:05:49.694+07:00 DEBUG 25256 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@591fd34d, started on Wed Dec 24 11:05:41 ICT 2025
2025-12-24T11:05:49.698+07:00 DEBUG 25256 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@278c67a7, started on Wed Dec 24 11:05:46 ICT 2025
2025-12-24T11:05:49.701+07:00 DEBUG 25256 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@255b84a9, started on Wed Dec 24 11:05:47 ICT 2025
2025-12-24T11:05:49.703+07:00 DEBUG 25256 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@27f43664, started on Wed Dec 24 11:05:48 ICT 2025
2025-12-24T11:17:00.547+07:00  INFO 22900 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 22900 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:17:00.548+07:00 DEBUG 22900 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:17:00.549+07:00  INFO 22900 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-24T11:17:00.578+07:00 DEBUG 22900 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@7c9b78e3
2025-12-24T11:17:03.590+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 7 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:17:03.842+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:17:04.027+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:17:04.099+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:17:04.244+07:00  WARN 22900 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:17:04.244+07:00 DEBUG 22900 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:17:04.470+07:00 DEBUG 22900 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:17:04.596+07:00  INFO 22900 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:17:04.596+07:00  INFO 22900 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:17:04.599+07:00  INFO 22900 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-24T11:17:04.667+07:00  INFO 22900 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 4.698 seconds (process running for 6.231)
2025-12-24T11:17:05.012+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:05.147+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=, phone=0912345678, role=VET)]
2025-12-24T11:17:05.334+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:05.368+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:05.376+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:05.337065700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:05.394+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'fullName': rejected value []; codes [NotBlank.quickAddStaffRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-24T11:17:05.544+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:05.547+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Duplicate User, phone=0987654321, role=VET)]
2025-12-24T11:17:05.573+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceAlreadyExists(ResourceAlreadyExistsException, HttpServletRequest)
2025-12-24T11:17:05.574+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:05.574+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:05.574556800, status=409, error=Conflict, message=Số điện t (truncated)...]
2025-12-24T11:17:05.576+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceAlreadyExistsException: Số điện thoại này đã được đăng ký tài khoản]
2025-12-24T11:17:05.606+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-24T11:17:05.621+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:05.623+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=4159e224-92df-4175-9920-7a4566fa3191, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-24T11:17:05.666+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:05.667+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Fake Admin, phone=0912345678, role=ADMIN)]
2025-12-24T11:17:05.669+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T11:17:05.670+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:05.671+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:05.670426400, status=403, error=Forbidden, message=Không th (truncated)...]
2025-12-24T11:17:05.672+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Không thể tạo tài khoản ADMIN qua chức năng này]
2025-12-24T11:17:05.696+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:05.702+07:00 DEBUG 22900 --- [petties] [main] o.s.web.method.HandlerMethod             : Could not resolve parameter [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]
2025-12-24T11:17:05.704+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleHttpMessageNotReadable(HttpMessageNotReadableException, HttpServletRequest)
2025-12-24T11:17:05.704+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:05.705+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:05.704837400, status=400, error=Bad Request, message=Dữ liệ (truncated)...]
2025-12-24T11:17:05.706+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]]
2025-12-24T11:17:05.722+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-24T11:17:05.726+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:17:05.726+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-24T11:17:05.748+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:05.749+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Tester, phone=123, role=VET)]
2025-12-24T11:17:05.753+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:05.754+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:05.755+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:05.754005400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:05.756+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'phone': rejected value [123]; codes [Pattern.quickAddStaffRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^[0-9]{10,11}$]; default message [Số điện thoại không hợp lệ]] ]
2025-12-24T11:17:05.774+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T11:17:05.789+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:17:05.789+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-24T11:17:05.842+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T11:17:05.846+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T11:17:05.848+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:05.848+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:05.846861500, status=404, error=Not Found, message=User not (truncated)...]
2025-12-24T11:17:05.849+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: User not found]
2025-12-24T11:17:05.864+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:05.865+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T11:17:05.867+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:17:05.868+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-24T11:17:05.883+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignVet(UUID, String)
2025-12-24T11:17:05.885+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T11:17:05.886+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:05.887+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:05.886504300, status=403, error=Forbidden, message=Bạn khôn (truncated)...]
2025-12-24T11:17:05.888+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Bạn không có quyền quản lý phòng khám này]
2025-12-24T11:17:05.899+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:05.901+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T11:17:05.903+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T11:17:05.904+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:05.904+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:05.903197800, status=403, error=Forbidden, message=Quản lý  (truncated)...]
2025-12-24T11:17:05.905+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Quản lý phòng khám chỉ có quyền thêm Bác sĩ]
2025-12-24T11:17:05.937+07:00  INFO 22900 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.UserControllerUnitTest]: UserControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T11:17:05.993+07:00  INFO 22900 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.UserControllerUnitTest
2025-12-24T11:17:06.009+07:00  INFO 22900 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T11:17:06.114+07:00  INFO 22900 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Starting UserControllerUnitTest using Java 21.0.9 with PID 22900 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:17:06.114+07:00 DEBUG 22900 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:17:06.114+07:00  INFO 22900 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T11:17:06.119+07:00 DEBUG 22900 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@28ceb25e
2025-12-24T11:17:06.930+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:17:06.998+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:17:07.010+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:17:07.041+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:17:07.081+07:00  WARN 22900 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:17:07.081+07:00 DEBUG 22900 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:17:07.097+07:00 DEBUG 22900 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:17:07.118+07:00  INFO 22900 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:17:07.119+07:00  INFO 22900 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:17:07.123+07:00  INFO 22900 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 4 ms
2025-12-24T11:17:07.141+07:00  INFO 22900 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Started UserControllerUnitTest in 1.136 seconds (process running for 8.705)
2025-12-24T11:17:07.161+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:07.165+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=12345)]
2025-12-24T11:17:07.205+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:07.226+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.227+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.206967200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:07.233+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [12345]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:17:07.282+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:17:07.285+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@11ec2b2f]
2025-12-24T11:17:07.305+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:07.306+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.309+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.305784200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:07.312+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'phone': rejected value [not-a-number]; codes [Pattern.updateProfileRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^0\d{9,10}$]; default message [Số điện thoại không hợp lệ (10-11 số, bắt đầu bằng 0)]] ]
2025-12-24T11:17:07.326+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:17:07.328+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@62158618]
2025-12-24T11:17:07.330+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:07.330+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.330+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.330577900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:07.332+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'fullName': rejected value []; codes [Size.updateProfileRequest.fullName,Size.fullName,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.fullName,fullName]; arguments []; default message [fullName],100,2]; default message [Họ tên phải từ 2-100 ký tự]] ]
2025-12-24T11:17:07.355+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T11:17:07.363+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.363+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@5f596a1a]
2025-12-24T11:17:07.392+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T11:17:07.394+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.394+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@c8ed958]
2025-12-24T11:17:07.409+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:17:07.411+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:07.411+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.412+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.411381700, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:17:07.412+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:17:07.424+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T11:17:07.428+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:07.430+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.431+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.428152300, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:17:07.433+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:17:07.450+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:17:07.455+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=)]
2025-12-24T11:17:07.462+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:07.463+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.463+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.462392900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:07.463+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-24T11:17:07.473+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:07.474+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=1234567)]
2025-12-24T11:17:07.477+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:07.477+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.477+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.477827800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:07.478+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [1234567]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:17:07.503+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T11:17:07.510+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@757f47f0]
2025-12-24T11:17:07.520+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:07.520+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.520+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.520033700, status=400, error=Bad Request, message=Mật kh (truncated)...]
2025-12-24T11:17:07.522+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Mật khẩu hiện tại không chính xác]
2025-12-24T11:17:07.538+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:17:07.539+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=not-an-email)]
2025-12-24T11:17:07.540+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:07.541+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.543+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.541427600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:07.545+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email khong hop le]] ]
2025-12-24T11:17:07.562+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T11:17:07.563+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@1acfc058]
2025-12-24T11:17:07.575+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.575+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Doi mat khau thanh cong}]
2025-12-24T11:17:07.586+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-24T11:17:07.588+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.589+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@7d836c4a]
2025-12-24T11:17:07.599+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:07.608+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=)]
2025-12-24T11:17:07.609+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:07.610+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.611+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.610210800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:07.612+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest) with 2 errors: [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [NotBlank.emailChangeVerifyRequest.otp,NotBlank.otp,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp]]; default message [Ma OTP khong duoc de trong]] [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:17:07.635+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T11:17:07.638+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:07.638+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.639+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.638778700, status=400, error=Bad Request, message=File i (truncated)...]
2025-12-24T11:17:07.641+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: File is empty]
2025-12-24T11:17:07.651+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:07.652+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=not-an-email, otp=123456)]
2025-12-24T11:17:07.654+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:07.655+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.656+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.655350500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:07.656+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeVerifyRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email khong hop le]] ]
2025-12-24T11:17:07.668+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:17:07.669+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@9771c71]
2025-12-24T11:17:07.670+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:07.671+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.671+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.671604900, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:17:07.672+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:17:07.686+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:17:07.692+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T11:17:07.694+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.699+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=OTP da duoc gui den email moi}]
2025-12-24T11:17:07.720+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T11:17:07.726+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:07.728+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.728+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.727851700, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:17:07.729+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:17:07.760+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:17:07.768+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:07.770+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.773+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.769817700, status=400, error=Bad Request, message=Khong  (truncated)...]
2025-12-24T11:17:07.776+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Khong co yeu cau thay doi email. Vui long tao yeu cau moi.]
2025-12-24T11:17:07.802+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:17:07.804+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=test@example.com)]
2025-12-24T11:17:07.805+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:07.806+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.807+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.806639600, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:17:07.809+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi phai khac email hien tai]
2025-12-24T11:17:07.821+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:17:07.825+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T11:17:07.829+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:07.831+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.831+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.831190600, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:17:07.837+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:17:07.887+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T11:17:07.890+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@64745270]
2025-12-24T11:17:07.893+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.894+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@596d17f4]
2025-12-24T11:17:07.950+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:17:07.950+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T11:17:07.963+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:07.988+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:07.990+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:07.987195500, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-24T11:17:07.994+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 45 giay truoc khi gui lai ma OTP]
2025-12-24T11:17:08.062+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:08.063+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T11:17:08.069+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:08.074+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.075+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.073702900, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-24T11:17:08.076+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong chinh xac hoac da het han]
2025-12-24T11:17:08.093+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:17:08.097+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.097+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Ma OTP moi da duoc gui den email moi}]
2025-12-24T11:17:08.116+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:08.117+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-24T11:17:08.120+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:08.120+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.121+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.120582500, status=400, error=Bad Request, message=Ban da (truncated)...]
2025-12-24T11:17:08.122+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ban da nhap sai ma OTP qua nhieu lan. Vui long yeu cau gui ma OTP moi.]
2025-12-24T11:17:08.131+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:08.132+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=, otp=123456)]
2025-12-24T11:17:08.135+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:08.135+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.137+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.135299700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:08.138+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeVerifyRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-24T11:17:08.147+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:08.150+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=different@example.com, otp=123456)]
2025-12-24T11:17:08.153+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:08.153+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.154+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.153442100, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:17:08.155+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi khong khop voi yeu cau truoc do]
2025-12-24T11:17:08.165+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T11:17:08.166+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=existing@example.com)]
2025-12-24T11:17:08.168+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:08.169+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.170+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.169525700, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:17:08.171+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-24T11:17:08.188+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:08.191+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T11:17:08.195+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.200+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@64836643]
2025-12-24T11:17:08.218+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:08.220+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-24T11:17:08.222+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:08.228+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.228+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.228246400, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-24T11:17:08.231+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong dung. Ban con 4 lan thu.]
2025-12-24T11:17:08.242+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-24T11:17:08.243+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:08.245+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.247+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.243788500, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:17:08.248+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:17:08.260+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:17:08.262+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:08.262+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.263+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.262310400, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-24T11:17:08.266+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 30 giay truoc khi gui lai ma OTP]
2025-12-24T11:17:08.280+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:08.281+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=abc123)]
2025-12-24T11:17:08.282+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:08.282+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.284+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.282299600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:08.284+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [abc123]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T11:17:08.294+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T11:17:08.295+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@4d359c69]
2025-12-24T11:17:08.297+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:08.297+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.298+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.297745200, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:17:08.298+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:17:08.309+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T11:17:08.312+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:08.313+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.313+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.313290500, status=400, error=Bad Request, message=User n (truncated)...]
2025-12-24T11:17:08.315+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: User not found]
2025-12-24T11:17:08.327+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T11:17:08.328+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:08.330+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.330+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.329825, status=400, error=Bad Request, message=Email da  (truncated)...]
2025-12-24T11:17:08.331+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-24T11:17:08.341+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T11:17:08.342+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T11:17:08.345+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:08.346+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:08.346+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:08.345627200, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T11:17:08.348+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T11:17:08.374+07:00  INFO 22900 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.ClinicServiceControllerUnitTest]: ClinicServiceControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T11:17:08.404+07:00  INFO 22900 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.ClinicServiceControllerUnitTest
2025-12-24T11:17:08.427+07:00  INFO 22900 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T11:17:08.528+07:00  INFO 22900 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Starting ClinicServiceControllerUnitTest using Java 21.0.9 with PID 22900 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:17:08.528+07:00 DEBUG 22900 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:17:08.528+07:00  INFO 22900 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T11:17:08.535+07:00 DEBUG 22900 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@5bfeb9ba
2025-12-24T11:17:09.376+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:17:09.446+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:17:09.454+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:17:09.460+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:17:09.488+07:00  WARN 22900 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:17:09.489+07:00 DEBUG 22900 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:17:09.506+07:00 DEBUG 22900 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:17:09.518+07:00  INFO 22900 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:17:09.518+07:00  INFO 22900 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:17:09.520+07:00  INFO 22900 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 2 ms
2025-12-24T11:17:09.532+07:00  INFO 22900 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Started ClinicServiceControllerUnitTest in 1.106 seconds (process running for 11.096)
2025-12-24T11:17:09.552+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updatePricePerKm(UUID, BigDecimal)
2025-12-24T11:17:09.562+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.564+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@285b63eb]
2025-12-24T11:17:09.585+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#deleteService(UUID)
2025-12-24T11:17:09.588+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.588+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-24T11:17:09.604+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-24T11:17:09.615+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@33319df0]
2025-12-24T11:17:09.632+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.632+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@16448827]
2025-12-24T11:17:09.665+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-24T11:17:09.671+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@240fa4ad]
2025-12-24T11:17:09.679+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.679+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@8d5b303]
2025-12-24T11:17:09.691+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-24T11:17:09.693+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:09.698+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.698+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:09.693333700, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T11:17:09.700+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid status transition]
2025-12-24T11:17:09.709+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateBulkPricePerKm(BigDecimal)
2025-12-24T11:17:09.713+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.714+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-24T11:17:09.722+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-24T11:17:09.724+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@6ebf5f26]
2025-12-24T11:17:09.727+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:09.727+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.727+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:09.727979500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:09.731+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.clinicService.ClinicServiceResponse> com.petties.petties.controller.ClinicServiceController.createService(com.petties.petties.dto.clinicService.ClinicServiceRequest) with 3 errors: [Field error in object 'clinicServiceRequest' on field 'name': rejected value [null]; codes [NotBlank.clinicServiceRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.name,name]; arguments []; default message [name]]; default message [Tên dịch vụ không được để trống]] [Field error in object 'clinicServiceRequest' on field 'slotsRequired': rejected value [null]; codes [NotNull.clinicServiceRequest.slotsRequired,NotNull.slotsRequired,NotNull.java.lang.Integer,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.slotsRequired,slotsRequired]; arguments []; default message [slotsRequired]]; default message [Số slot yêu cầu không được để trống]] [Field error in object 'clinicServiceRequest' on field 'basePrice': rejected value [null]; codes [NotNull.clinicServiceRequest.basePrice,NotNull.basePrice,NotNull.java.math.BigDecimal,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.basePrice,basePrice]; arguments []; default message [basePrice]]; default message [Giá cơ bản không được để trống]] ]
2025-12-24T11:17:09.740+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-24T11:17:09.741+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@26edfa34]
2025-12-24T11:17:09.743+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T11:17:09.744+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.744+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:09.744175100, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-24T11:17:09.746+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-24T11:17:09.754+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-24T11:17:09.756+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.757+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@64c1a76e]
2025-12-24T11:17:09.765+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-24T11:17:09.766+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T11:17:09.766+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.766+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:09.766979400, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-24T11:17:09.768+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-24T11:17:09.777+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getAllServices()
2025-12-24T11:17:09.783+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.784+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[com.petties.petties.dto.clinicService.ClinicServiceResponse@951053f]]
2025-12-24T11:17:09.797+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-24T11:17:09.800+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:09.801+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@e74300b]
2025-12-24T11:17:09.831+07:00  INFO 22900 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.AuthControllerUnitTest]: AuthControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T11:17:09.873+07:00  INFO 22900 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.AuthControllerUnitTest
2025-12-24T11:17:09.880+07:00  INFO 22900 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T11:17:09.927+07:00  INFO 22900 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Starting AuthControllerUnitTest using Java 21.0.9 with PID 22900 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:17:09.927+07:00 DEBUG 22900 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:17:09.927+07:00  INFO 22900 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T11:17:09.934+07:00 DEBUG 22900 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@33490054
2025-12-24T11:17:10.522+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 14 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:17:10.605+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:17:10.612+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:17:10.638+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:17:10.695+07:00  WARN 22900 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:17:10.695+07:00 DEBUG 22900 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:17:10.717+07:00 DEBUG 22900 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:17:10.738+07:00  INFO 22900 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:17:10.739+07:00  INFO 22900 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:17:10.740+07:00  INFO 22900 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-24T11:17:10.760+07:00  INFO 22900 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Started AuthControllerUnitTest in 0.88 seconds (process running for 12.324)
2025-12-24T11:17:10.777+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:10.780+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@4434eb51]
2025-12-24T11:17:10.791+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:10.800+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.804+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:10.791159600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:10.815+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [NotBlank.sendOtpRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password]]; default message [Mật khẩu không được để trống]] ]
2025-12-24T11:17:10.828+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:17:10.833+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@5beda06e]
2025-12-24T11:17:10.838+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:10.841+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.841+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:10.841034, status=400, error=Validation Failed, message=Mã  (truncated)...]
2025-12-24T11:17:10.842+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [1234567]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T11:17:10.859+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:10.862+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7b99e726]
2025-12-24T11:17:10.875+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:10.876+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.876+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:10.875910600, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T11:17:10.876+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-24T11:17:10.889+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:17:10.890+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@623cd12e]
2025-12-24T11:17:10.896+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.896+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@73136174]
2025-12-24T11:17:10.904+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:17:10.907+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@4fdea2de]
2025-12-24T11:17:10.917+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.918+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@7356ec91]
2025-12-24T11:17:10.925+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:17:10.926+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@1d63f6be]
2025-12-24T11:17:10.927+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:10.927+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.928+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:10.927583300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:10.928+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value [null]; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-24T11:17:10.936+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:10.938+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7475f57e]
2025-12-24T11:17:10.943+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:10.945+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.945+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:10.944131400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:10.946+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [NotBlank.resetPasswordRequest.newPassword,NotBlank.newPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword]]; default message [Mật khẩu mới không được để trống]] [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-24T11:17:10.953+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:10.955+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@1f1b69bb]
2025-12-24T11:17:10.956+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:10.957+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.957+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:10.956394300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:10.958+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [NotBlank.resetPasswordRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-24T11:17:10.964+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:17:10.965+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@52b4da7c]
2025-12-24T11:17:10.967+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:10.967+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.967+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:10.967031800, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-24T11:17:10.968+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-24T11:17:10.981+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T11:17:10.986+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:10.987+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@f7a8a7b]
2025-12-24T11:17:11.002+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T11:17:11.005+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:11.006+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.006+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.006137700, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-24T11:17:11.007+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-24T11:17:11.017+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:11.018+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@6efd83ac]
2025-12-24T11:17:11.021+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.021+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.MessageResponse@117e9a56]
2025-12-24T11:17:11.027+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:17:11.029+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@23938caa]
2025-12-24T11:17:11.031+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.033+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.033+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.032519400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.034+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value []; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-24T11:17:11.048+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:11.050+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@495cac83]
2025-12-24T11:17:11.052+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.052+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.053+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.052267800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.054+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value []; codes [NotBlank.resetPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:17:11.060+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:17:11.062+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@297db6ad]
2025-12-24T11:17:11.063+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:11.063+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.064+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.063067900, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T11:17:11.064+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-24T11:17:11.074+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:17:11.075+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@6296c184]
2025-12-24T11:17:11.077+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.077+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@3ea95f79]
2025-12-24T11:17:11.099+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:11.110+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@3a02172a]
2025-12-24T11:17:11.112+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.119+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.122+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.113520300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.125+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value [Pass1]; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-24T11:17:11.140+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:11.143+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@674b2703]
2025-12-24T11:17:11.145+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.146+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.147+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.146305800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.150+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.resetPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email không đúng định dạng]] ]
2025-12-24T11:17:11.162+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:11.165+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@3b870ed3]
2025-12-24T11:17:11.171+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.171+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.172+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.171723700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.173+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value []; codes [NotBlank.sendOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:17:11.194+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:11.196+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@551fefe8]
2025-12-24T11:17:11.198+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:11.199+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.200+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.198341700, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:17:11.202+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email already exists]
2025-12-24T11:17:11.212+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:11.213+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@65e639f2]
2025-12-24T11:17:11.213+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.215+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@54a1a6a8]
2025-12-24T11:17:11.232+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T11:17:11.236+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:11.236+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.236+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.236241900, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-24T11:17:11.237+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending password reset found]
2025-12-24T11:17:11.249+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:11.251+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@3cdafb82]
2025-12-24T11:17:11.252+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.254+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.254+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.253341300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.254+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'username': rejected value [ab]; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] ]
2025-12-24T11:17:11.264+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T11:17:11.265+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:11.266+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.266+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.266100100, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-24T11:17:11.268+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-24T11:17:11.277+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:17:11.278+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@2c4142f8]
2025-12-24T11:17:11.279+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:11.279+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.279+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.279453100, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-24T11:17:11.281+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid Google ID token]
2025-12-24T11:17:11.292+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:17:11.293+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@1e250539]
2025-12-24T11:17:11.298+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:11.298+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.299+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.298739500, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T11:17:11.299+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email not found]
2025-12-24T11:17:11.307+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:17:11.308+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@5f804b36]
2025-12-24T11:17:11.310+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.311+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.311+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.310733500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.312+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.forgotPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email không đúng định dạng]] ]
2025-12-24T11:17:11.319+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:11.319+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@18ce7872]
2025-12-24T11:17:11.323+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.323+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.324+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.323711700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.324+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value [abc123]; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-24T11:17:11.330+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:17:11.331+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@213fc7e7]
2025-12-24T11:17:11.335+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.335+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.335+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.335199400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.336+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [12345]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T11:17:11.347+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:11.348+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@2fedfff1]
2025-12-24T11:17:11.351+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.352+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.352+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.351851800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.353+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [NotBlank.sendOtpRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username]]; default message [Tên đăng nhập không được để trống]] [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] ]
2025-12-24T11:17:11.410+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T11:17:11.473+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:11.477+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.478+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.473189800, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-24T11:17:11.484+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending registration found]
2025-12-24T11:17:11.582+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:17:11.585+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@485dfac9]
2025-12-24T11:17:11.588+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.590+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.590+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.589820200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.591+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value []; codes [NotBlank.verifyOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:17:11.659+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:17:11.660+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@21132086]
2025-12-24T11:17:11.661+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.665+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.666+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.661886800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.666+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'idToken': rejected value []; codes [NotBlank.googleSignInRequest.idToken,NotBlank.idToken,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.idToken,idToken]; arguments []; default message [idToken]]; default message [ID token is required]] ]
2025-12-24T11:17:11.677+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:11.679+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7e383712]
2025-12-24T11:17:11.681+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.682+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.682+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.681172100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.683+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'confirmPassword': rejected value []; codes [NotBlank.resetPasswordRequest.confirmPassword,NotBlank.confirmPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.confirmPassword,confirmPassword]; arguments []; default message [confirmPassword]]; default message [Xác nhận mật khẩu không được để trống]] ]
2025-12-24T11:17:11.729+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:11.729+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@97842a0]
2025-12-24T11:17:11.731+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.742+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.743+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.731719700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.744+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'fullName': rejected value []; codes [NotBlank.sendOtpRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-24T11:17:11.765+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:17:11.766+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@71077d1]
2025-12-24T11:17:11.767+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.768+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@36e7b91c]
2025-12-24T11:17:11.775+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:11.778+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@12418d3f]
2025-12-24T11:17:11.781+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.781+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.782+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.781287600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.783+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'password': rejected value [12345]; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] ]
2025-12-24T11:17:11.790+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:17:11.791+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@9a932a4]
2025-12-24T11:17:11.792+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.792+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.792+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.792562700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.793+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value [null]; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-24T11:17:11.804+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:17:11.804+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@2f5378cd]
2025-12-24T11:17:11.806+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.806+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.806+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.806301100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.807+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest) with 2 errors: [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [NotBlank.verifyOtpRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T11:17:11.816+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:17:11.817+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@7a98f106]
2025-12-24T11:17:11.826+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.826+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@633328d3]
2025-12-24T11:17:11.839+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:17:11.840+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@74ee07e]
2025-12-24T11:17:11.841+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.841+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.841+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.841875900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.843+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value []; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-24T11:17:11.851+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:17:11.852+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@2045a469]
2025-12-24T11:17:11.853+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.853+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@672710d5]
2025-12-24T11:17:11.861+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:17:11.865+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@4537c9f8]
2025-12-24T11:17:11.867+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.867+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@698e2cba]
2025-12-24T11:17:11.878+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:17:11.881+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@5b076d23]
2025-12-24T11:17:11.882+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.882+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@14d43f13]
2025-12-24T11:17:11.906+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T11:17:11.908+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@2197990b]
2025-12-24T11:17:11.909+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.911+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.912+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.910154400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.913+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value []; codes [NotBlank.forgotPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T11:17:11.923+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T11:17:11.925+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@1a99d328]
2025-12-24T11:17:11.927+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T11:17:11.928+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.930+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.927331, status=401, error=Unauthorized, message=Invalid  (truncated)...]
2025-12-24T11:17:11.931+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid username or password]
2025-12-24T11:17:11.940+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T11:17:11.943+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.943+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@99ace98]
2025-12-24T11:17:11.957+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T11:17:11.958+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@6ee0ef34]
2025-12-24T11:17:11.959+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:11.961+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.962+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.960723500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:11.964+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'platform': rejected value []; codes [NotBlank.googleSignInRequest.platform,NotBlank.platform,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.platform,platform]; arguments []; default message [platform]]; default message [Platform is required]] ]
2025-12-24T11:17:11.972+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:11.973+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@11759e4a]
2025-12-24T11:17:11.976+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:11.977+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:11.978+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.976333200, status=400, error=Bad Request, message=Passwo (truncated)...]
2025-12-24T11:17:11.978+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Passwords do not match]
2025-12-24T11:17:11.988+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:11.989+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@7296675e]
2025-12-24T11:17:11.998+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:12.000+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:12.002+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:11.999921200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:12.007+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'role': rejected value [null]; codes [NotNull.sendOtpRequest.role,NotNull.role,NotNull.com.petties.petties.model.enums.Role,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.role,role]; arguments []; default message [role]]; default message [Vai trò không được để trống]] ]
2025-12-24T11:17:12.029+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T11:17:12.031+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@420d123d]
2025-12-24T11:17:12.032+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:12.033+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:12.034+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:12.033589200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:12.034+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.sendOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email không hợp lệ]] ]
2025-12-24T11:17:12.049+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T11:17:12.051+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@4973fb7d]
2025-12-24T11:17:12.055+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T11:17:12.055+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:12.056+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:12.055710900, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-24T11:17:12.058+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-24T11:17:12.072+07:00 DEBUG 22900 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T11:17:12.077+07:00 DEBUG 22900 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@50479c2b]
2025-12-24T11:17:12.079+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:12.084+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:12.084+07:00 DEBUG 22900 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:12.083029700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:12.092+07:00 DEBUG 22900 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.verifyOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email không hợp lệ]] ]
2025-12-24T11:17:12.105+07:00 DEBUG 22900 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@7c9b78e3, started on Wed Dec 24 11:17:00 ICT 2025
2025-12-24T11:17:12.113+07:00 DEBUG 22900 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@28ceb25e, started on Wed Dec 24 11:17:06 ICT 2025
2025-12-24T11:17:12.116+07:00 DEBUG 22900 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@5bfeb9ba, started on Wed Dec 24 11:17:08 ICT 2025
2025-12-24T11:17:12.122+07:00 DEBUG 22900 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@33490054, started on Wed Dec 24 11:17:09 ICT 2025
2025-12-24T11:17:20.186+07:00  INFO 4220 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 4220 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T11:17:20.189+07:00 DEBUG 4220 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T11:17:20.190+07:00  INFO 4220 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-24T11:17:20.220+07:00 DEBUG 4220 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@61d01788
2025-12-24T11:17:24.381+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 7 mappings in 'requestMappingHandlerMapping'
2025-12-24T11:17:24.606+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T11:17:24.801+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T11:17:24.882+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T11:17:25.009+07:00  WARN 4220 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T11:17:25.010+07:00 DEBUG 4220 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T11:17:25.220+07:00 DEBUG 4220 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T11:17:25.350+07:00  INFO 4220 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T11:17:25.351+07:00  INFO 4220 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T11:17:25.353+07:00  INFO 4220 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-24T11:17:25.428+07:00  INFO 4220 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 6.065 seconds (process running for 7.944)
2025-12-24T11:17:25.648+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:25.722+07:00 DEBUG 4220 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=, phone=0912345678, role=VET)]
2025-12-24T11:17:25.840+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:25.879+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:25.895+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:25.846305800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:25.918+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'fullName': rejected value []; codes [NotBlank.quickAddStaffRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-24T11:17:26.088+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:26.090+07:00 DEBUG 4220 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Duplicate User, phone=0987654321, role=VET)]
2025-12-24T11:17:26.106+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceAlreadyExists(ResourceAlreadyExistsException, HttpServletRequest)
2025-12-24T11:17:26.109+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:26.109+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:26.108269500, status=409, error=Conflict, message=Số điện t (truncated)...]
2025-12-24T11:17:26.109+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceAlreadyExistsException: Số điện thoại này đã được đăng ký tài khoản]
2025-12-24T11:17:26.150+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-24T11:17:26.174+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:26.178+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=aa2e9ef1-4607-4d2a-af09-9b15f2b6ffde, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-24T11:17:26.220+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:26.222+07:00 DEBUG 4220 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Fake Admin, phone=0912345678, role=ADMIN)]
2025-12-24T11:17:26.223+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T11:17:26.225+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:26.227+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:26.224996300, status=403, error=Forbidden, message=Không th (truncated)...]
2025-12-24T11:17:26.229+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Không thể tạo tài khoản ADMIN qua chức năng này]
2025-12-24T11:17:26.276+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:26.293+07:00 DEBUG 4220 --- [petties] [main] o.s.web.method.HandlerMethod             : Could not resolve parameter [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]
2025-12-24T11:17:26.293+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleHttpMessageNotReadable(HttpMessageNotReadableException, HttpServletRequest)
2025-12-24T11:17:26.294+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:26.295+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:26.294368800, status=400, error=Bad Request, message=Dữ liệ (truncated)...]
2025-12-24T11:17:26.296+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]]
2025-12-24T11:17:26.316+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-24T11:17:26.321+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:17:26.322+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-24T11:17:26.350+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:26.355+07:00 DEBUG 4220 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Tester, phone=123, role=VET)]
2025-12-24T11:17:26.359+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T11:17:26.360+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:26.360+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:26.359740900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T11:17:26.363+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'phone': rejected value [123]; codes [Pattern.quickAddStaffRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@6636448b,^[0-9]{10,11}$]; default message [Số điện thoại không hợp lệ]] ]
2025-12-24T11:17:26.402+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T11:17:26.418+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:17:26.418+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-24T11:17:26.469+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T11:17:26.470+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T11:17:26.473+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:26.473+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:26.472119900, status=404, error=Not Found, message=User not (truncated)...]
2025-12-24T11:17:26.476+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: User not found]
2025-12-24T11:17:26.505+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:26.508+07:00 DEBUG 4220 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T11:17:26.510+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T11:17:26.512+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-24T11:17:26.525+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignVet(UUID, String)
2025-12-24T11:17:26.527+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T11:17:26.528+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:26.528+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:26.528060700, status=403, error=Forbidden, message=Bạn khôn (truncated)...]
2025-12-24T11:17:26.529+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Bạn không có quyền quản lý phòng khám này]
2025-12-24T11:17:26.544+07:00 DEBUG 4220 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T11:17:26.546+07:00 DEBUG 4220 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T11:17:26.548+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T11:17:26.548+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T11:17:26.549+07:00 DEBUG 4220 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T11:17:26.548416300, status=403, error=Forbidden, message=Quản lý  (truncated)...]
2025-12-24T11:17:26.549+07:00 DEBUG 4220 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Quản lý phòng khám chỉ có quyền thêm Bác sĩ]
2025-12-24T11:17:26.632+07:00 DEBUG 4220 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@61d01788, started on Wed Dec 24 11:17:20 ICT 2025
2025-12-24T13:42:11.573+07:00  INFO 29296 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Starting ClinicStaffControllerUnitTest using Java 21.0.9 with PID 29296 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T13:42:11.575+07:00 DEBUG 29296 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T13:42:11.576+07:00  INFO 29296 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : The following 1 profile is active: "dev"
2025-12-24T13:42:11.605+07:00 DEBUG 29296 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@7c9b78e3
2025-12-24T13:42:14.711+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 7 mappings in 'requestMappingHandlerMapping'
2025-12-24T13:42:14.951+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T13:42:15.182+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T13:42:15.256+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T13:42:15.446+07:00  WARN 29296 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T13:42:15.446+07:00 DEBUG 29296 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T13:42:15.668+07:00 DEBUG 29296 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T13:42:15.761+07:00  INFO 29296 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T13:42:15.762+07:00  INFO 29296 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T13:42:15.766+07:00  INFO 29296 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 3 ms
2025-12-24T13:42:15.859+07:00  INFO 29296 --- [petties] [main] c.p.p.c.ClinicStaffControllerUnitTest    : Started ClinicStaffControllerUnitTest in 4.826 seconds (process running for 6.703)
2025-12-24T13:42:16.089+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T13:42:16.149+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=, phone=0912345678, role=VET)]
2025-12-24T13:42:16.297+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:16.328+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:16.341+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:16.301150500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:16.355+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'fullName': rejected value []; codes [NotBlank.quickAddStaffRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-24T13:42:16.506+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T13:42:16.507+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Duplicate User, phone=0987654321, role=VET)]
2025-12-24T13:42:16.515+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceAlreadyExists(ResourceAlreadyExistsException, HttpServletRequest)
2025-12-24T13:42:16.516+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:16.516+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:16.515271900, status=409, error=Conflict, message=Số điện t (truncated)...]
2025-12-24T13:42:16.518+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceAlreadyExistsException: Số điện thoại này đã được đăng ký tài khoản]
2025-12-24T13:42:16.540+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#getStaff(UUID)
2025-12-24T13:42:16.553+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:16.557+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[StaffResponse(userId=ee25d4e5-0953-43f8-9410-25cec7d5cd6d, fullName=Vet A, username=null, email=nul (truncated)...]
2025-12-24T13:42:16.579+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T13:42:16.580+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Fake Admin, phone=0912345678, role=ADMIN)]
2025-12-24T13:42:16.582+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T13:42:16.583+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:16.584+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:16.583061100, status=403, error=Forbidden, message=Không th (truncated)...]
2025-12-24T13:42:16.585+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Không thể tạo tài khoản ADMIN qua chức năng này]
2025-12-24T13:42:16.595+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T13:42:16.602+07:00 DEBUG 29296 --- [petties] [main] o.s.web.method.HandlerMethod             : Could not resolve parameter [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]
2025-12-24T13:42:16.603+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleHttpMessageNotReadable(HttpMessageNotReadableException, HttpServletRequest)
2025-12-24T13:42:16.603+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:16.604+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:16.603353900, status=400, error=Bad Request, message=Dữ liệ (truncated)...]
2025-12-24T13:42:16.605+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot deserialize value of type `com.petties.petties.model.enums.Role` from String "INVALID": not one of the values accepted for Enum class: [PET_OWNER, CLINIC_OWNER, VET, CLINIC_MANAGER, ADMIN]]
2025-12-24T13:42:16.618+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#removeStaff(UUID, UUID)
2025-12-24T13:42:16.621+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T13:42:16.621+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff removed successfully"]
2025-12-24T13:42:16.633+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T13:42:16.635+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=Tester, phone=123, role=VET)]
2025-12-24T13:42:16.638+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:16.639+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:16.639+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:16.638607100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:16.640+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<java.lang.String> com.petties.petties.controller.ClinicStaffController.quickAddStaff(java.util.UUID,com.petties.petties.dto.clinic.QuickAddStaffRequest): [Field error in object 'quickAddStaffRequest' on field 'phone': rejected value [123]; codes [Pattern.quickAddStaffRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [quickAddStaffRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^[0-9]{10,11}$]; default message [Số điện thoại không hợp lệ]] ]
2025-12-24T13:42:16.652+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T13:42:16.660+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T13:42:16.660+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Clinic Manager assigned successfully"]
2025-12-24T13:42:16.696+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignManager(UUID, String)
2025-12-24T13:42:16.699+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T13:42:16.700+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:16.702+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:16.700606700, status=404, error=Not Found, message=User not (truncated)...]
2025-12-24T13:42:16.703+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: User not found]
2025-12-24T13:42:16.717+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T13:42:16.718+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T13:42:16.718+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-12-24T13:42:16.720+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Staff account created and assigned successfully"]
2025-12-24T13:42:16.728+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#assignVet(UUID, String)
2025-12-24T13:42:16.734+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T13:42:16.735+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:16.735+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:16.734542800, status=403, error=Forbidden, message=Bạn khôn (truncated)...]
2025-12-24T13:42:16.738+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Bạn không có quyền quản lý phòng khám này]
2025-12-24T13:42:16.750+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicStaffController#quickAddStaff(UUID, QuickAddStaffRequest)
2025-12-24T13:42:16.751+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [QuickAddStaffRequest(fullName=New Manager, phone=0912345678, role=CLINIC_MANAGER)]
2025-12-24T13:42:16.753+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleForbidden(ForbiddenException, HttpServletRequest)
2025-12-24T13:42:16.754+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:16.754+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:16.753462, status=403, error=Forbidden, message=Quản lý phò (truncated)...]
2025-12-24T13:42:16.755+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ForbiddenException: Quản lý phòng khám chỉ có quyền thêm Bác sĩ]
2025-12-24T13:42:16.778+07:00  INFO 29296 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.UserControllerUnitTest]: UserControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T13:42:16.811+07:00  INFO 29296 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.UserControllerUnitTest
2025-12-24T13:42:16.821+07:00  INFO 29296 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T13:42:16.881+07:00  INFO 29296 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Starting UserControllerUnitTest using Java 21.0.9 with PID 29296 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T13:42:16.882+07:00 DEBUG 29296 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T13:42:16.882+07:00  INFO 29296 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T13:42:16.886+07:00 DEBUG 29296 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@28ceb25e
2025-12-24T13:42:17.530+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-24T13:42:17.576+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T13:42:17.585+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T13:42:17.593+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T13:42:17.618+07:00  WARN 29296 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T13:42:17.653+07:00 DEBUG 29296 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T13:42:17.668+07:00 DEBUG 29296 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T13:42:17.682+07:00  INFO 29296 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T13:42:17.684+07:00  INFO 29296 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T13:42:17.685+07:00  INFO 29296 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-24T13:42:17.694+07:00  INFO 29296 --- [petties] [main] c.p.p.controller.UserControllerUnitTest  : Started UserControllerUnitTest in 0.874 seconds (process running for 8.538)
2025-12-24T13:42:17.712+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:17.717+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=12345)]
2025-12-24T13:42:17.786+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:17.791+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.791+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:17.786657600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:17.793+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [12345]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T13:42:17.814+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T13:42:17.816+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@11ec2b2f]
2025-12-24T13:42:17.823+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:17.824+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.824+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:17.823513700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:17.825+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'phone': rejected value [not-a-number]; codes [Pattern.updateProfileRequest.phone,Pattern.phone,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.phone,phone]; arguments []; default message [phone],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^0\d{9,10}$]; default message [Số điện thoại không hợp lệ (10-11 số, bắt đầu bằng 0)]] ]
2025-12-24T13:42:17.835+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T13:42:17.837+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@62158618]
2025-12-24T13:42:17.838+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:17.839+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.839+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:17.838183800, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:17.840+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.updateProfile(com.petties.petties.dto.user.UpdateProfileRequest): [Field error in object 'updateProfileRequest' on field 'fullName': rejected value []; codes [Size.updateProfileRequest.fullName,Size.fullName,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [updateProfileRequest.fullName,fullName]; arguments []; default message [fullName],100,2]; default message [Họ tên phải từ 2-100 ký tự]] ]
2025-12-24T13:42:17.857+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T13:42:17.863+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.864+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@5f596a1a]
2025-12-24T13:42:17.884+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T13:42:17.887+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.887+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@c8ed958]
2025-12-24T13:42:17.899+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T13:42:17.900+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:17.902+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.903+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:17.902172100, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T13:42:17.903+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T13:42:17.912+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T13:42:17.915+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:17.916+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.916+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:17.916573700, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T13:42:17.918+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T13:42:17.931+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T13:42:17.933+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=)]
2025-12-24T13:42:17.938+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:17.939+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.939+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:17.938755600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:17.939+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-24T13:42:17.950+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:17.950+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=1234567)]
2025-12-24T13:42:17.951+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:17.952+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.953+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:17.951971400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:17.954+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [1234567]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T13:42:17.970+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T13:42:17.972+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@757f47f0]
2025-12-24T13:42:17.982+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:17.983+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.984+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:17.983186700, status=400, error=Bad Request, message=Mật kh (truncated)...]
2025-12-24T13:42:17.984+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Mật khẩu hiện tại không chính xác]
2025-12-24T13:42:17.991+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T13:42:17.991+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=not-an-email)]
2025-12-24T13:42:17.993+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:17.993+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:17.994+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:17.993301, status=400, error=Validation Failed, message=Ema (truncated)...]
2025-12-24T13:42:17.996+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.String>> com.petties.petties.controller.UserController.requestEmailChange(com.petties.petties.dto.user.EmailChangeRequest): [Field error in object 'emailChangeRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email khong hop le]] ]
2025-12-24T13:42:18.006+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T13:42:18.006+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@1acfc058]
2025-12-24T13:42:18.050+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.050+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Doi mat khau thanh cong}]
2025-12-24T13:42:18.060+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-24T13:42:18.062+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.063+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@7d836c4a]
2025-12-24T13:42:18.076+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.077+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=)]
2025-12-24T13:42:18.079+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:18.079+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.079+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.079052700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:18.080+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest) with 2 errors: [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [NotBlank.emailChangeVerifyRequest.otp,NotBlank.otp,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp]]; default message [Ma OTP khong duoc de trong]] [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value []; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T13:42:18.089+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T13:42:18.090+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.092+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.092+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.090603900, status=400, error=Bad Request, message=File i (truncated)...]
2025-12-24T13:42:18.095+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: File is empty]
2025-12-24T13:42:18.104+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.105+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=not-an-email, otp=123456)]
2025-12-24T13:42:18.106+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:18.106+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.107+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.106948500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:18.107+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value [not-an-email]; codes [Email.emailChangeVerifyRequest.newEmail,Email.newEmail,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email khong hop le]] ]
2025-12-24T13:42:18.117+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T13:42:18.118+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@9771c71]
2025-12-24T13:42:18.119+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:18.119+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.119+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.119398300, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T13:42:18.120+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T13:42:18.129+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T13:42:18.130+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T13:42:18.132+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.132+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=OTP da duoc gui den email moi}]
2025-12-24T13:42:18.139+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#uploadAvatar(MultipartFile)
2025-12-24T13:42:18.140+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:18.141+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.141+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.141885400, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T13:42:18.143+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T13:42:18.148+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T13:42:18.151+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.152+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.153+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.151531800, status=400, error=Bad Request, message=Khong  (truncated)...]
2025-12-24T13:42:18.153+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Khong co yeu cau thay doi email. Vui long tao yeu cau moi.]
2025-12-24T13:42:18.162+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T13:42:18.163+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=test@example.com)]
2025-12-24T13:42:18.165+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.166+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.166+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.166243400, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T13:42:18.167+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi phai khac email hien tai]
2025-12-24T13:42:18.174+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T13:42:18.176+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T13:42:18.177+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:18.177+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.178+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.177790, status=401, error=Unauthorized, message=User not (truncated)...]
2025-12-24T13:42:18.178+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T13:42:18.185+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#updateProfile(UpdateProfileRequest)
2025-12-24T13:42:18.185+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.UpdateProfileRequest@64745270]
2025-12-24T13:42:18.186+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.186+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@596d17f4]
2025-12-24T13:42:18.196+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T13:42:18.197+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=newemail@example.com)]
2025-12-24T13:42:18.200+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.200+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.200+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.200052900, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-24T13:42:18.201+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 45 giay truoc khi gui lai ma OTP]
2025-12-24T13:42:18.209+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.209+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T13:42:18.210+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.211+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.211+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.211912600, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-24T13:42:18.211+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong chinh xac hoac da het han]
2025-12-24T13:42:18.218+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T13:42:18.219+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.219+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{message=Ma OTP moi da duoc gui den email moi}]
2025-12-24T13:42:18.227+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.227+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-24T13:42:18.230+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.230+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.230+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.230624, status=400, error=Bad Request, message=Ban da nh (truncated)...]
2025-12-24T13:42:18.231+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ban da nhap sai ma OTP qua nhieu lan. Vui long yeu cau gui ma OTP moi.]
2025-12-24T13:42:18.238+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.238+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=, otp=123456)]
2025-12-24T13:42:18.240+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:18.240+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.241+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.240032700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:18.241+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'newEmail': rejected value []; codes [NotBlank.emailChangeVerifyRequest.newEmail,NotBlank.newEmail,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.newEmail,newEmail]; arguments []; default message [newEmail]]; default message [Email moi khong duoc de trong]] ]
2025-12-24T13:42:18.249+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.249+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=different@example.com, otp=123456)]
2025-12-24T13:42:18.290+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.290+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.290+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.290148300, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T13:42:18.291+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email moi khong khop voi yeu cau truoc do]
2025-12-24T13:42:18.297+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#requestEmailChange(EmailChangeRequest)
2025-12-24T13:42:18.297+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeRequest(newEmail=existing@example.com)]
2025-12-24T13:42:18.298+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.299+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.299+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.298939400, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T13:42:18.299+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-24T13:42:18.305+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.306+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T13:42:18.308+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.309+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.UserResponse@64836643]
2025-12-24T13:42:18.316+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.316+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=999999)]
2025-12-24T13:42:18.318+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.318+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.318+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.318856200, status=400, error=Bad Request, message=Ma OTP (truncated)...]
2025-12-24T13:42:18.320+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Ma OTP khong dung. Ban con 4 lan thu.]
2025-12-24T13:42:18.326+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#deleteAvatar()
2025-12-24T13:42:18.327+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:18.328+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.328+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.328460, status=401, error=Unauthorized, message=User not (truncated)...]
2025-12-24T13:42:18.328+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T13:42:18.334+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T13:42:18.335+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.335+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.335+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.335331400, status=400, error=Bad Request, message=Vui lo (truncated)...]
2025-12-24T13:42:18.336+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Vui long doi 30 giay truoc khi gui lai ma OTP]
2025-12-24T13:42:18.343+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.344+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=abc123)]
2025-12-24T13:42:18.345+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:18.345+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.345+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.345189700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:18.346+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.UserResponse> com.petties.petties.controller.UserController.verifyEmailChange(com.petties.petties.dto.user.EmailChangeVerifyRequest): [Field error in object 'emailChangeVerifyRequest' on field 'otp': rejected value [abc123]; codes [Pattern.emailChangeVerifyRequest.otp,Pattern.otp,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [emailChangeVerifyRequest.otp,otp]; arguments []; default message [otp],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Ma OTP phai co dung 6 chu so]] ]
2025-12-24T13:42:18.351+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#changePassword(ChangePasswordRequest)
2025-12-24T13:42:18.352+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.user.ChangePasswordRequest@4d359c69]
2025-12-24T13:42:18.353+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:18.353+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.353+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.353485, status=401, error=Unauthorized, message=User not (truncated)...]
2025-12-24T13:42:18.355+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T13:42:18.360+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#getProfile()
2025-12-24T13:42:18.362+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.362+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.363+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.362251300, status=400, error=Bad Request, message=User n (truncated)...]
2025-12-24T13:42:18.363+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: User not found]
2025-12-24T13:42:18.375+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#resendEmailChangeOtp()
2025-12-24T13:42:18.376+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:18.376+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.377+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.376680400, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T13:42:18.377+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email da duoc su dung boi tai khoan khac]
2025-12-24T13:42:18.382+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.UserController#verifyEmailChange(EmailChangeVerifyRequest)
2025-12-24T13:42:18.382+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [EmailChangeVerifyRequest(newEmail=newemail@example.com, otp=123456)]
2025-12-24T13:42:18.384+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:18.384+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:18.384+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:18.384288400, status=401, error=Unauthorized, message=User  (truncated)...]
2025-12-24T13:42:18.385+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: User not authenticated]
2025-12-24T13:42:18.398+07:00  INFO 29296 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.ClinicServiceControllerUnitTest]: ClinicServiceControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T13:42:18.418+07:00  INFO 29296 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.ClinicServiceControllerUnitTest
2025-12-24T13:42:18.426+07:00  INFO 29296 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T13:42:18.464+07:00  INFO 29296 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Starting ClinicServiceControllerUnitTest using Java 21.0.9 with PID 29296 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T13:42:18.465+07:00 DEBUG 29296 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T13:42:18.465+07:00  INFO 29296 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T13:42:18.491+07:00 DEBUG 29296 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@5bfeb9ba
2025-12-24T13:42:18.930+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 11 mappings in 'requestMappingHandlerMapping'
2025-12-24T13:42:18.971+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T13:42:18.977+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T13:42:19.018+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T13:42:19.040+07:00  WARN 29296 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T13:42:19.040+07:00 DEBUG 29296 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T13:42:19.051+07:00 DEBUG 29296 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T13:42:19.058+07:00  INFO 29296 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T13:42:19.059+07:00  INFO 29296 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T13:42:19.059+07:00  INFO 29296 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-12-24T13:42:19.068+07:00  INFO 29296 --- [petties] [main] c.p.p.c.ClinicServiceControllerUnitTest  : Started ClinicServiceControllerUnitTest in 0.642 seconds (process running for 9.911)
2025-12-24T13:42:19.117+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updatePricePerKm(UUID, BigDecimal)
2025-12-24T13:42:19.123+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.124+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@285b63eb]
2025-12-24T13:42:19.139+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#deleteService(UUID)
2025-12-24T13:42:19.140+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.140+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-24T13:42:19.156+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-24T13:42:19.173+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@33319df0]
2025-12-24T13:42:19.186+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.186+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@16448827]
2025-12-24T13:42:19.233+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-24T13:42:19.236+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@240fa4ad]
2025-12-24T13:42:19.242+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.243+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@8d5b303]
2025-12-24T13:42:19.249+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-24T13:42:19.251+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:19.257+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.257+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.251595200, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T13:42:19.258+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid status transition]
2025-12-24T13:42:19.265+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateBulkPricePerKm(BigDecimal)
2025-12-24T13:42:19.268+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.268+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Nothing to write: null body
2025-12-24T13:42:19.274+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#createService(ClinicServiceRequest)
2025-12-24T13:42:19.275+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceRequest@6ebf5f26]
2025-12-24T13:42:19.277+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.277+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.277+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.277353400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:19.278+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.clinicService.ClinicServiceResponse> com.petties.petties.controller.ClinicServiceController.createService(com.petties.petties.dto.clinicService.ClinicServiceRequest) with 3 errors: [Field error in object 'clinicServiceRequest' on field 'name': rejected value [null]; codes [NotBlank.clinicServiceRequest.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.name,name]; arguments []; default message [name]]; default message [Tên dịch vụ không được để trống]] [Field error in object 'clinicServiceRequest' on field 'slotsRequired': rejected value [null]; codes [NotNull.clinicServiceRequest.slotsRequired,NotNull.slotsRequired,NotNull.java.lang.Integer,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.slotsRequired,slotsRequired]; arguments []; default message [slotsRequired]]; default message [Số slot yêu cầu không được để trống]] [Field error in object 'clinicServiceRequest' on field 'basePrice': rejected value [null]; codes [NotNull.clinicServiceRequest.basePrice,NotNull.basePrice,NotNull.java.math.BigDecimal,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [clinicServiceRequest.basePrice,basePrice]; arguments []; default message [basePrice]]; default message [Giá cơ bản không được để trống]] ]
2025-12-24T13:42:19.284+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateService(UUID, ClinicServiceUpdateRequest)
2025-12-24T13:42:19.286+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.clinicService.ClinicServiceUpdateRequest@26edfa34]
2025-12-24T13:42:19.287+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T13:42:19.287+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.288+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.287824600, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-24T13:42:19.288+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-24T13:42:19.294+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-24T13:42:19.295+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.295+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@64c1a76e]
2025-12-24T13:42:19.302+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getServiceById(UUID)
2025-12-24T13:42:19.303+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleResourceNotFound(ResourceNotFoundException, HttpServletRequest)
2025-12-24T13:42:19.303+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.303+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.303818700, status=404, error=Not Found, message=Service  (truncated)...]
2025-12-24T13:42:19.304+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.ResourceNotFoundException: Service not found]
2025-12-24T13:42:19.310+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#getAllServices()
2025-12-24T13:42:19.314+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.314+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [[com.petties.petties.dto.clinicService.ClinicServiceResponse@951053f]]
2025-12-24T13:42:19.328+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.ClinicServiceController#updateServiceStatus(UUID, Boolean)
2025-12-24T13:42:19.329+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.330+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.clinicService.ClinicServiceResponse@e74300b]
2025-12-24T13:42:19.344+07:00  INFO 29296 --- [petties] [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.petties.petties.controller.AuthControllerUnitTest]: AuthControllerUnitTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-24T13:42:19.361+07:00  INFO 29296 --- [petties] [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.petties.petties.PettiesApplication for test class com.petties.petties.controller.AuthControllerUnitTest
2025-12-24T13:42:19.366+07:00  INFO 29296 --- [petties] [main] o.s.b.d.r.RestartApplicationListener     : Restart disabled due to context in which it is running
2025-12-24T13:42:19.393+07:00  INFO 29296 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Starting AuthControllerUnitTest using Java 21.0.9 with PID 29296 (started by TAN in D:\SEP490\petties\backend-spring\petties)
2025-12-24T13:42:19.393+07:00 DEBUG 29296 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Running with Spring Boot v3.4.0, Spring v6.2.0
2025-12-24T13:42:19.393+07:00  INFO 29296 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : The following 1 profile is active: "dev"
2025-12-24T13:42:19.397+07:00 DEBUG 29296 --- [petties] [main] o.s.w.c.s.GenericWebApplicationContext   : Refreshing org.springframework.web.context.support.GenericWebApplicationContext@33490054
2025-12-24T13:42:19.691+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 14 mappings in 'requestMappingHandlerMapping'
2025-12-24T13:42:19.723+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-24T13:42:19.727+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-24T13:42:19.732+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-24T13:42:19.751+07:00  WARN 29296 --- [petties] [main] r$InitializeUserDetailsManagerConfigurer : Found 2 UserDetailsService beans, with names [inMemoryUserDetailsManager, com.petties.petties.config.UserDetailsServiceImpl#0]. Global Authentication Manager will not use a UserDetailsService for username/password login. Consider publishing a single UserDetailsService bean.
2025-12-24T13:42:19.751+07:00 DEBUG 29296 --- [petties] [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-12-24T13:42:19.763+07:00 DEBUG 29296 --- [petties] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CsrfFilter, LogoutFilter, UsernamePasswordAuthenticationFilter, DefaultResourcesFilter, DefaultLoginPageGeneratingFilter, DefaultLogoutPageGeneratingFilter, BasicAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-12-24T13:42:19.773+07:00  INFO 29296 --- [petties] [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-12-24T13:42:19.773+07:00  INFO 29296 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-12-24T13:42:19.774+07:00  INFO 29296 --- [petties] [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-12-24T13:42:19.780+07:00  INFO 29296 --- [petties] [main] c.p.p.controller.AuthControllerUnitTest  : Started AuthControllerUnitTest in 0.414 seconds (process running for 10.624)
2025-12-24T13:42:19.789+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:19.791+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@4434eb51]
2025-12-24T13:42:19.797+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.803+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.804+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.798880500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:19.805+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] [Field error in object 'sendOtpRequest' on field 'password': rejected value []; codes [NotBlank.sendOtpRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password]]; default message [Mật khẩu không được để trống]] ]
2025-12-24T13:42:19.814+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T13:42:19.815+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@5beda06e]
2025-12-24T13:42:19.820+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.820+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.820+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.820461400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:19.821+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [1234567]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T13:42:19.828+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:19.830+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7b99e726]
2025-12-24T13:42:19.837+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:19.837+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.838+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.837462300, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T13:42:19.838+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-24T13:42:19.845+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T13:42:19.846+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@623cd12e]
2025-12-24T13:42:19.851+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.851+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@73136174]
2025-12-24T13:42:19.859+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T13:42:19.860+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@4fdea2de]
2025-12-24T13:42:19.863+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.863+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@7356ec91]
2025-12-24T13:42:19.871+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T13:42:19.871+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@1d63f6be]
2025-12-24T13:42:19.873+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.873+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.873+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.873913400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:19.873+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value [null]; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-24T13:42:19.880+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:19.882+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7475f57e]
2025-12-24T13:42:19.885+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.885+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.885+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.885785500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:19.887+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [NotBlank.resetPasswordRequest.newPassword,NotBlank.newPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword]]; default message [Mật khẩu mới không được để trống]] [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value []; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-24T13:42:19.892+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:19.893+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@1f1b69bb]
2025-12-24T13:42:19.894+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.894+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.894+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.894837900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:19.895+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest) with 2 errors: [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [NotBlank.resetPasswordRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value []; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-24T13:42:19.902+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T13:42:19.903+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@52b4da7c]
2025-12-24T13:42:19.904+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:19.904+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.904+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.904260400, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-24T13:42:19.905+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-24T13:42:19.910+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T13:42:19.913+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.913+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@f7a8a7b]
2025-12-24T13:42:19.921+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T13:42:19.923+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:19.923+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.923+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.923021400, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-24T13:42:19.923+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-24T13:42:19.930+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:19.930+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@6efd83ac]
2025-12-24T13:42:19.933+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.933+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.MessageResponse@117e9a56]
2025-12-24T13:42:19.940+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T13:42:19.940+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@23938caa]
2025-12-24T13:42:19.941+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.941+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.942+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.941682, status=400, error=Validation Failed, message=Use (truncated)...]
2025-12-24T13:42:19.943+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'username': rejected value []; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-12-24T13:42:19.947+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:19.950+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@495cac83]
2025-12-24T13:42:19.951+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.951+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.951+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.951888200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:19.953+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value []; codes [NotBlank.resetPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T13:42:19.959+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T13:42:19.960+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@297db6ad]
2025-12-24T13:42:19.961+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:19.961+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.961+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.961095800, status=400, error=Bad Request, message=Invali (truncated)...]
2025-12-24T13:42:19.962+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Invalid OTP code]
2025-12-24T13:42:19.973+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T13:42:19.974+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@6296c184]
2025-12-24T13:42:19.975+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.975+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@3ea95f79]
2025-12-24T13:42:19.982+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:19.983+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@3a02172a]
2025-12-24T13:42:19.984+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.986+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.987+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.986034100, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:19.988+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'newPassword': rejected value [Pass1]; codes [Size.resetPasswordRequest.newPassword,Size.newPassword,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.newPassword,newPassword]; arguments []; default message [newPassword],2147483647,8]; default message [Mật khẩu mới phải có ít nhất 8 ký tự]] ]
2025-12-24T13:42:19.994+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:19.994+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@674b2703]
2025-12-24T13:42:19.995+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:19.995+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:19.997+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:19.995969400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:19.998+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.resetPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email không đúng định dạng]] ]
2025-12-24T13:42:20.003+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:20.003+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@3b870ed3]
2025-12-24T13:42:20.005+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.006+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.006+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.006479900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.006+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value []; codes [NotBlank.sendOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T13:42:20.013+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:20.014+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@551fefe8]
2025-12-24T13:42:20.016+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:20.016+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.016+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.016230300, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T13:42:20.017+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email already exists]
2025-12-24T13:42:20.021+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:20.021+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@65e639f2]
2025-12-24T13:42:20.024+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.024+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@54a1a6a8]
2025-12-24T13:42:20.029+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T13:42:20.031+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:20.033+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.033+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.032991200, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-24T13:42:20.033+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending password reset found]
2025-12-24T13:42:20.039+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:20.041+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@3cdafb82]
2025-12-24T13:42:20.041+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.041+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.043+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.041540400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.043+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'username': rejected value [ab]; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] ]
2025-12-24T13:42:20.049+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T13:42:20.051+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:20.052+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.052+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.051340800, status=400, error=Bad Request, message=Please (truncated)...]
2025-12-24T13:42:20.053+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Please wait before resending OTP]
2025-12-24T13:42:20.057+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T13:42:20.058+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@2c4142f8]
2025-12-24T13:42:20.061+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:20.063+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.063+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.062133100, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-24T13:42:20.063+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid Google ID token]
2025-12-24T13:42:20.071+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T13:42:20.073+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@1e250539]
2025-12-24T13:42:20.075+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:20.075+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.076+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.075371100, status=400, error=Bad Request, message=Email  (truncated)...]
2025-12-24T13:42:20.076+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Email not found]
2025-12-24T13:42:20.081+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T13:42:20.082+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@5f804b36]
2025-12-24T13:42:20.082+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.083+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.083+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.083769300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.083+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value [not-an-email]; codes [Email.forgotPasswordRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email không đúng định dạng]] ]
2025-12-24T13:42:20.089+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:20.089+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@18ce7872]
2025-12-24T13:42:20.090+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.090+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.090+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.090766900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.091+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'otpCode': rejected value [abc123]; codes [Pattern.resetPasswordRequest.otpCode,Pattern.otpCode,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.otpCode,otpCode]; arguments []; default message [otpCode],[Ljakarta.validation.constraints.Pattern$Flag;@2e1e7bc6,^\d{6}$]; default message [Mã OTP phải là 6 chữ số]] ]
2025-12-24T13:42:20.098+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T13:42:20.139+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@213fc7e7]
2025-12-24T13:42:20.140+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.140+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.140+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.140528600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.141+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value [12345]; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T13:42:20.146+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:20.147+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@2fedfff1]
2025-12-24T13:42:20.148+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.149+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.149+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.148901900, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.150+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest) with 2 errors: [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [NotBlank.sendOtpRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username]]; default message [Tên đăng nhập không được để trống]] [Field error in object 'sendOtpRequest' on field 'username': rejected value []; codes [Size.sendOtpRequest.username,Size.username,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.username,username]; arguments []; default message [username],50,3]; default message [Tên đăng nhập phải từ 3 đến 50 ký tự]] ]
2025-12-24T13:42:20.155+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendOtp(String)
2025-12-24T13:42:20.156+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:20.156+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.157+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.156812500, status=400, error=Bad Request, message=No pen (truncated)...]
2025-12-24T13:42:20.157+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: No pending registration found]
2025-12-24T13:42:20.163+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T13:42:20.165+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@485dfac9]
2025-12-24T13:42:20.166+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.167+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.167+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.167665300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.168+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value []; codes [NotBlank.verifyOtpRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T13:42:20.173+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T13:42:20.174+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@21132086]
2025-12-24T13:42:20.177+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.179+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.179+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.179237300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.180+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'idToken': rejected value []; codes [NotBlank.googleSignInRequest.idToken,NotBlank.idToken,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.idToken,idToken]; arguments []; default message [idToken]]; default message [ID token is required]] ]
2025-12-24T13:42:20.187+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:20.188+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@7e383712]
2025-12-24T13:42:20.189+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.189+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.190+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.189631200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.190+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.MessageResponse> com.petties.petties.controller.AuthController.resetPassword(com.petties.petties.dto.auth.ResetPasswordRequest): [Field error in object 'resetPasswordRequest' on field 'confirmPassword': rejected value []; codes [NotBlank.resetPasswordRequest.confirmPassword,NotBlank.confirmPassword,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [resetPasswordRequest.confirmPassword,confirmPassword]; arguments []; default message [confirmPassword]]; default message [Xác nhận mật khẩu không được để trống]] ]
2025-12-24T13:42:20.197+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:20.197+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@97842a0]
2025-12-24T13:42:20.199+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.199+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.200+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.199568600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.200+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'fullName': rejected value []; codes [NotBlank.sendOtpRequest.fullName,NotBlank.fullName,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.fullName,fullName]; arguments []; default message [fullName]]; default message [Họ tên không được để trống]] ]
2025-12-24T13:42:20.206+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T13:42:20.206+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@71077d1]
2025-12-24T13:42:20.209+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.209+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@36e7b91c]
2025-12-24T13:42:20.223+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:20.228+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@12418d3f]
2025-12-24T13:42:20.235+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.236+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.244+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.236111, status=400, error=Validation Failed, message=Mật (truncated)...]
2025-12-24T13:42:20.250+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'password': rejected value [12345]; codes [Size.sendOtpRequest.password,Size.password,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.password,password]; arguments []; default message [password],2147483647,6]; default message [Mật khẩu phải có ít nhất 6 ký tự]] ]
2025-12-24T13:42:20.256+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T13:42:20.257+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@9a932a4]
2025-12-24T13:42:20.259+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.259+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.265+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.259695700, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.267+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value [null]; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-24T13:42:20.280+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T13:42:20.281+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@2f5378cd]
2025-12-24T13:42:20.282+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.282+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.282+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.282796600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.284+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest) with 2 errors: [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [NotBlank.verifyOtpRequest.otpCode,NotBlank.otpCode,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode]]; default message [Mã OTP không được để trống]] [Field error in object 'verifyOtpRequest' on field 'otpCode': rejected value []; codes [Size.verifyOtpRequest.otpCode,Size.otpCode,Size.java.lang.String,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.otpCode,otpCode]; arguments []; default message [otpCode],6,6]; default message [Mã OTP phải có đúng 6 chữ số]] ]
2025-12-24T13:42:20.291+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T13:42:20.294+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@7a98f106]
2025-12-24T13:42:20.295+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.295+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@633328d3]
2025-12-24T13:42:20.302+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T13:42:20.303+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@74ee07e]
2025-12-24T13:42:20.305+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.305+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.305+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.305078600, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.306+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.login(com.petties.petties.dto.auth.LoginRequest): [Field error in object 'loginRequest' on field 'password': rejected value []; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-12-24T13:42:20.313+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T13:42:20.314+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@2045a469]
2025-12-24T13:42:20.316+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.316+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@672710d5]
2025-12-24T13:42:20.322+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T13:42:20.323+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@4537c9f8]
2025-12-24T13:42:20.325+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.326+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@698e2cba]
2025-12-24T13:42:20.332+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T13:42:20.376+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@5b076d23]
2025-12-24T13:42:20.376+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.377+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.AuthResponse@14d43f13]
2025-12-24T13:42:20.384+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#forgotPassword(ForgotPasswordRequest)
2025-12-24T13:42:20.385+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ForgotPasswordRequest@2197990b]
2025-12-24T13:42:20.386+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.386+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.387+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.386568, status=400, error=Validation Failed, message=Ema (truncated)...]
2025-12-24T13:42:20.387+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.forgotPassword(com.petties.petties.dto.auth.ForgotPasswordRequest): [Field error in object 'forgotPasswordRequest' on field 'email': rejected value []; codes [NotBlank.forgotPasswordRequest.email,NotBlank.email,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [forgotPasswordRequest.email,email]; arguments []; default message [email]]; default message [Email không được để trống]] ]
2025-12-24T13:42:20.396+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#login(LoginRequest)
2025-12-24T13:42:20.397+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.LoginRequest@1a99d328]
2025-12-24T13:42:20.398+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleUnauthorized(UnauthorizedException, HttpServletRequest)
2025-12-24T13:42:20.398+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.399+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.398431800, status=401, error=Unauthorized, message=Inval (truncated)...]
2025-12-24T13:42:20.399+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.UnauthorizedException: Invalid username or password]
2025-12-24T13:42:20.405+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resendPasswordResetOtp(String)
2025-12-24T13:42:20.407+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.409+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [com.petties.petties.dto.auth.SendOtpResponse@99ace98]
2025-12-24T13:42:20.418+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#googleSignIn(GoogleSignInRequest)
2025-12-24T13:42:20.419+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.GoogleSignInRequest@6ee0ef34]
2025-12-24T13:42:20.420+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.423+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.433+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.420606200, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.434+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.googleSignIn(com.petties.petties.dto.auth.GoogleSignInRequest): [Field error in object 'googleSignInRequest' on field 'platform': rejected value []; codes [NotBlank.googleSignInRequest.platform,NotBlank.platform,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [googleSignInRequest.platform,platform]; arguments []; default message [platform]]; default message [Platform is required]] ]
2025-12-24T13:42:20.445+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:20.454+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@11759e4a]
2025-12-24T13:42:20.459+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:20.460+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.460+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.459792500, status=400, error=Bad Request, message=Passwo (truncated)...]
2025-12-24T13:42:20.460+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: Passwords do not match]
2025-12-24T13:42:20.466+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:20.466+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@7296675e]
2025-12-24T13:42:20.468+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.468+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.468+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.468773500, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.469+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'role': rejected value [null]; codes [NotNull.sendOtpRequest.role,NotNull.role,NotNull.com.petties.petties.model.enums.Role,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.role,role]; arguments []; default message [role]]; default message [Vai trò không được để trống]] ]
2025-12-24T13:42:20.476+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#sendRegistrationOtp(SendOtpRequest)
2025-12-24T13:42:20.477+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.SendOtpRequest@420d123d]
2025-12-24T13:42:20.479+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.479+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.479+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.479960400, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.481+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.SendOtpResponse> com.petties.petties.controller.AuthController.sendRegistrationOtp(com.petties.petties.dto.auth.SendOtpRequest): [Field error in object 'sendOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.sendOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email không hợp lệ]] ]
2025-12-24T13:42:20.497+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#resetPassword(ResetPasswordRequest)
2025-12-24T13:42:20.498+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.ResetPasswordRequest@4973fb7d]
2025-12-24T13:42:20.500+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleBadRequest(BadRequestException, HttpServletRequest)
2025-12-24T13:42:20.500+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.501+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.500955700, status=400, error=Bad Request, message=OTP ha (truncated)...]
2025-12-24T13:42:20.514+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [com.petties.petties.exception.BadRequestException: OTP has expired]
2025-12-24T13:42:20.525+07:00 DEBUG 29296 --- [petties] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.petties.petties.controller.AuthController#verifyOtpAndRegister(VerifyOtpRequest)
2025-12-24T13:42:20.532+07:00 DEBUG 29296 --- [petties] [main] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json" to [com.petties.petties.dto.auth.VerifyOtpRequest@50479c2b]
2025-12-24T13:42:20.533+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.petties.petties.exception.GlobalExceptionHandler#handleValidationExceptions(MethodArgumentNotValidException, HttpServletRequest)
2025-12-24T13:42:20.534+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-24T13:42:20.534+07:00 DEBUG 29296 --- [petties] [main] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [ErrorResponse(timestamp=2025-12-24T13:42:20.533296300, status=400, error=Validation Failed, message= (truncated)...]
2025-12-24T13:42:20.534+07:00 DEBUG 29296 --- [petties] [main] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.petties.petties.dto.auth.AuthResponse> com.petties.petties.controller.AuthController.verifyOtpAndRegister(com.petties.petties.dto.auth.VerifyOtpRequest): [Field error in object 'verifyOtpRequest' on field 'email': rejected value [not-an-email]; codes [Email.verifyOtpRequest.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [verifyOtpRequest.email,email]; arguments []; default message [email],[Ljakarta.validation.constraints.Pattern$Flag;@619b7436,.*]; default message [Email không hợp lệ]] ]
2025-12-24T13:42:20.585+07:00 DEBUG 29296 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@7c9b78e3, started on Wed Dec 24 13:42:11 ICT 2025
2025-12-24T13:42:20.596+07:00 DEBUG 29296 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@28ceb25e, started on Wed Dec 24 13:42:16 ICT 2025
2025-12-24T13:42:20.598+07:00 DEBUG 29296 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@5bfeb9ba, started on Wed Dec 24 13:42:18 ICT 2025
2025-12-24T13:42:20.600+07:00 DEBUG 29296 --- [petties] [SpringApplicationShutdownHook] o.s.w.c.s.GenericWebApplicationContext   : Closing org.springframework.web.context.support.GenericWebApplicationContext@33490054, started on Wed Dec 24 13:42:19 ICT 2025
